function Region(a){this.chromosome=null,this.start=null,this.end=null,_.isObject(a)?this.load(a):_.isString(a)&&this.parse(a)}function FeatureBinarySearchTree(){this._root=null}function InfoWidget(a,b,c){switch(this.id="InfoWidget_"+Math.round(1e7*Math.random()),this.targetId=null,this.species=b,this.title=null,this.featureId=null,this.width=800,this.height=460,this.feature=null,this.query=null,this.adapter=null,null!=a&&(this.targetId=a),null!=c&&(null!=c.title&&(this.title=c.title),null!=c.width&&(this.width=c.width),null!=c.height&&(this.height=c.height)),Utils.getSpeciesCode(b.text)){case"hsapiens":this.ensemblSpecie="Homo_sapiens",this.reactomeSpecie="48887",this.wikipathwaysSpecie="Homo+sapiens",this.omimSpecie="",this.uniprotSpecie="",this.intactSpecie="",this.dbsnpSpecie="",this.haphapSpecie="";break;case"mmusculus":this.ensemblSpecies="Mus_musculus",this.reactomeSpecies="48892",this.wikipathwaysSpecie="Mus+musculus",this.omimSpecie="",this.uniprotSpecie="",this.intactSpecie="",this.dbsnpSpecie="",this.haphapSpecie="";break;case"drerio":this.ensemblSpecie="Danio_rerio",this.reactomeSpecie="68323",this.wikipathwaysSpecie="Danio+rerio",this.omimSpecie="",this.uniprotSpecie="",this.intactSpecie="",this.dbsnpSpecie="",this.haphapSpecie=""}this.notFoundPanel=Ext.create("Ext.panel.Panel",{id:this.id+"notFoundPanel",cls:"ocb-border-left-lightgrey",border:!1,flex:3,bodyPadding:"40",html:"No results found"})}function GeneInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Gene Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function GeneOrangeInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Gene Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function MirnaInfoWidget(a,b,c){null==c&&(c=new Object),c.title="miRNA Information",InfoWidget.prototype.constructor.call(this,a,b,c)}function ProteinInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Protein Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function SnpInfoWidget(a,b,c){null==c&&(c=new Object),c.title="SNP Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function TFInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Transcription Factor Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function TranscriptInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Transcript",InfoWidget.prototype.constructor.call(this,a,b,c)}function TranscriptOrangeInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Transcript",InfoWidget.prototype.constructor.call(this,a,b,c)}function VCFVariantInfoWidget(a,b,c){null==c&&(c=new Object),c.title="VCF variant Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function NavigationBar(a){_.extend(this,Backbone.Events),this.id=Utils.genId("NavigationBar"),this.species="Homo sapiens",this.increment=3,_.extend(this,a),this.region=new Region(this.region),this.currentChromosomeList=[],this.on(this.handlers),this.zoomChanging=!1,this.rendered=!1,this.autoRender&&this.render()}function ChromosomePanel(a){_.extend(this,Backbone.Events),this.id=Utils.genId("ChromosomePanel"),this.pixelBase,this.species="hsapiens",this.width=600,this.height=75,this.collapsed=!1,this.collapsible=!1,_.extend(this,a),this.region=new Region(this.region),this.lastChromosome="",this.data,this.on(this.handlers),this.rendered=!1,this.autoRender&&this.render()}function KaryotypePanel(a){_.extend(this,Backbone.Events),this.id=Utils.genId("KaryotypePanel"),this.pixelBase,this.species,this.width=600,this.height=75,this.collapsed=!1,this.collapsible=!0,_.extend(this,a),this.region=new Region(this.region),this.lastSpecies=this.species,this.chromosomeList,this.data2,this.on(this.handlers),this.rendered=!1,this.autoRender&&this.render()}function StatusBar(a){_.extend(this,Backbone.Events),this.id=Utils.genId("StatusBar"),_.extend(this,a),this.region=new Region(this.region),this.rendered=!1,this.autoRender&&this.render()}function DataSource(){}function FileDataSource(a){DataSource.prototype.constructor.call(this),_.extend(this,Backbone.Events),this.file=a,this.maxSize=524288e3}function StringDataSource(a){DataSource.prototype.constructor.call(this),_.extend(this,Backbone.Events),this.str=a}function UrlDataSource(a,b){DataSource.prototype.constructor.call(this),this.url=a,this.proxy=CELLBASE_HOST+"/latest/utils/proxy?url=",null!=b&&null!=b.proxy&&("boolean"==typeof b.proxy?0==b.proxy?this.proxy=!1:this.url=this.proxy+a:"string"==typeof b.proxy&&(this.url=b.proxy+a)),this.success=new Event,this.error=new Event}function CellBaseAdapter(a){_.extend(this,Backbone.Events),_.extend(this,a),this.on(this.handlers),this.cache={}}function SequenceAdapter(a){_.extend(this,Backbone.Events),this.id=Utils.genId("TrackListPanel"),this.host,this.gzip=!0,_.extend(this,a),this.sequence={},this.start={},this.end={},this.on(this.handlers)}function BamAdapter(a){if(_.extend(this,Backbone.Events),"undefined"!=typeof a){this.host=a.host||this.host,this.category=a.category||this.category,this.resource=a.resource||this.resource,this.params=a.params||this.params,this.filters=a.filters||this.filters,this.options=a.options||this.options,this.species=a.species||this.species;var b=a.featureCache||{}}if(null!=a&&null!=a.featureConfig&&(null!=a.featureConfig.filters&&(this.filtersConfig=a.featureConfig.filters),null!=a.featureConfig.options)){this.optionsConfig=a.featureConfig.options;for(var c=0;c<this.optionsConfig.length;c++)1==this.optionsConfig[c].checked&&(this.options[this.optionsConfig[c].name]=!0,this.params[this.optionsConfig[c].name]=!0)}this.featureCache=new BamCache(b)}function OpencgaAdapter(a){_.extend(this,Backbone.Events),_.extend(this,a),this.on(this.handlers),this.cache={}}function FeatureDataAdapter(a,b){_.extend(this,Backbone.Events),this.dataSource=a,this.gzip=!0,this.params={},null!=b&&(null!=b.gzip&&(this.gzip=b.gzip),null!=b.species&&(this.species=b.species),null!=b.params&&(this.params=b.params)),this.featureCache=new FeatureCache({chunkSize:1e4,gzip:this.gzip}),this.chromosomesLoaded={}}function BEDDataAdapter(a,b){FeatureDataAdapter.prototype.constructor.call(this,a,b),this.async=!0,this.featuresCount=0,this.featuresByChromosome={},null!=b&&null!=b.async&&(this.async=b.async)}function GFF2DataAdapter(a,b){FeatureDataAdapter.prototype.constructor.call(this,a,b),this.async=!0,this.featuresCount=0,this.featuresByChromosome={},null!=b&&null!=b.async&&(this.async=b.async)}function GFF3DataAdapter(a,b){FeatureDataAdapter.prototype.constructor.call(this,a,b),this.async=!0,this.featuresCount=0,this.featuresByChromosome={},null!=b&&null!=b.async&&(this.async=b.async)}function GTFDataAdapter(a,b){FeatureDataAdapter.prototype.constructor.call(this,a,b),this.async=!0,this.featuresCount=0,this.featuresByChromosome={},null!=b&&null!=b.async&&(this.async=b.async)}function VCFDataAdapter(a,b){FeatureDataAdapter.prototype.constructor.call(this,a,b),this.async=!0,this.featuresCount=0,this.featuresByChromosome={},this.header="",this.samples=[],null!=b&&null!=b.async&&(this.async=b.async)}function MemoryStore(a){_.extend(this,Backbone.Events),_.extend(this,a),this.size=0,this.store={}}function FeatureChunkCache(a){_.extend(this,Backbone.Events),this.id=Utils.genId("FeatureChunkCache"),this.chunkSize=5e4,this.limit,_.extend(this,a),this.store=new MemoryStore({}),this.verbose=!1}function FeatureCache(a){this.args=a,this.id=Math.round(1e7*Math.random()),this.chunkSize=5e4,this.gzip=!0,this.maxSize=10485760,this.size=0,null!=a&&(null!=a.chunkSize&&(this.chunkSize=a.chunkSize),null!=a.gzip&&(this.gzip=a.gzip)),this.cache={},this.chunksDisplayed={},this.maxFeaturesInterval=0,this.gzip=!1}function BamCache(a){this.args=a,this.id=Math.round(1e7*Math.random()),this.chunkSize=5e4,this.gzip=!0,this.maxSize=10485760,this.size=0,null!=a&&(null!=a.chunkSize&&(this.chunkSize=a.chunkSize),null!=a.gzip&&(this.gzip=a.gzip)),this.cache={},this.maxFeaturesInterval=0,this.gzip=!1}function TrackListPanel(a){_.extend(this,Backbone.Events),this.id=Utils.genId("TrackListPanel"),this.collapsed=!1,this.collapsible=!1,this.fontClass="ocb-font-sourcesanspro ocb-font-size-14",this.trackSvgList=[],this.swapHash={},this.parentLayout,this.mousePosition,this.windowSize,this.zoomMultiplier=1,this.showRegionOverviewBox=!1,this.height=0,_.extend(this,a),this.region=new Region(this.region),this.width-=18,this.status,this.visualRegion=new Region(this.region),this._setPixelBase(),this.on(this.handlers),this.rendered=!1,this.autoRender&&this.render()}function Track(a){if(this.width=200,this.height=200,this.dataAdapter,this.renderer,this.resizable=!0,this.autoHeight=!1,this.targetId,this.id,this.title,this.minHistogramRegionSize=3e8,this.maxLabelRegionSize=3e8,this.height=100,this.visibleRegionSize,this.fontClass="ocb-font-sourcesanspro ocb-font-size-14",_.extend(this,a),this.pixelBase,this.svgCanvasWidth=5e5,this.pixelPosition=this.svgCanvasWidth/2,this.svgCanvasOffset,this.svgCanvasFeatures,this.status,this.histogram,this.histogramLogarithm,this.histogramMax,this.interval,this.svgCanvasLeftLimit,this.svgCanvasRightLimit,this.invalidZoomText,this.renderedArea={},this.chunksDisplayed={},"handlers"in this)for(eventName in this.handlers)this.on(eventName,this.handlers[eventName]);this.rendered=!1,this.autoRender&&this.render()}function BamTrack(a){Track.call(this,a),_.extend(this,Backbone.Events),this.defaultRenderer=this.renderer,this.histogramRenderer=new HistogramRenderer,this.chunksDisplayed={},_.extend(this,a),this.dataType="features"}function FeatureTrack(a){Track.call(this,a),_.extend(this,Backbone.Events),this.defaultRenderer=this.renderer,this.histogramRenderer=new HistogramRenderer(a),_.extend(this,a),this.resource=this.dataAdapter.resource,this.species=this.dataAdapter.species,this.dataType="features"}function GeneTrack(a){Track.call(this,a),_.extend(this,Backbone.Events),this.minTranscriptRegionSize,this.defaultRenderer=this.renderer,this.histogramRenderer=new HistogramRenderer(a),_.extend(this,a),this.exclude}function SequenceTrack(a){a.resizable=!1,Track.call(this,a),_.extend(this,Backbone.Events),_.extend(this,a)}function Renderer(){}function BamRenderer(a){if(Renderer.call(this,a),_.extend(this,Backbone.Events),this.fontClass="ocb-font-sourcesanspro ocb-font-size-12",this.toolTipfontClass="ocb-font-default",_.isString(a)){var b=this.getDefaultConfig(a);_.extend(this,b)}else _.isObject(a)&&_.extend(this,a);this.on(this.handlers)}function ConservedRenderer(a){Renderer.call(this,a),_.extend(this,Backbone.Events),_.extend(this,a)}function FeatureClusterRenderer(a){Renderer.call(this,a),_.extend(this,Backbone.Events),this.histogramHeight=75,this.multiplier=7,this.fontClass="ocb-font-sourcesanspro ocb-font-size-12",this.toolTipfontClass="ocb-font-default",_.extend(this,a)}function FeatureRenderer(a){if(Renderer.call(this,a),_.extend(this,Backbone.Events),this.fontClass="ocb-font-sourcesanspro ocb-font-size-12",this.toolTipfontClass="ocb-font-default",_.isString(a)){var b=this.getDefaultConfig(a);_.extend(this,b)}else _.isObject(a)&&_.extend(this,a);this.on(this.handlers)}function GeneRenderer(a){Renderer.call(this,a),_.extend(this,Backbone.Events),this.fontClass="ocb-font-sourcesanspro ocb-font-size-12",this.toolTipfontClass="ocb-font-default",_.isString(a)?_.extend(this,this.getDefaultConfig(a)):_.isObject(a)&&_.extend(this,a),this.on(this.handlers)}function HistogramRenderer(a){Renderer.call(this,a),_.extend(this,Backbone.Events),this.histogramHeight=75,this.maxValue=10,null!=a&&(null!=a.height&&(this.histogramHeight=.95*a.height),null!=a.histogramMaxFreqValue&&(this.maxValue=a.histogramMaxFreqValue)),this.multiplier=this.histogramHeight/this.maxValue,_.extend(this,a)}function SequenceRenderer(a){Renderer.call(this,a),_.extend(this,Backbone.Events),this.fontClass="ocb-font-ubuntumono ocb-font-size-16",this.toolTipfontClass="ocb-font-default",_.extend(this,a)}function VcfMultisampleRenderer(a){if(Renderer.call(this,a),_.extend(this,Backbone.Events),this.fontClass="ocb-font-sourcesanspro ocb-font-size-12",this.toolTipfontClass="ocb-font-default",_.isString(a)){var b=this.getDefaultConfig(a);_.extend(this,b)}else _.isObject(a)&&_.extend(this,a);this.on(this.handlers)}function LegendPanel(a){this.width=200,this.height=250,null!=a&&(null!=a.title&&(this.title=a.title),null!=a.targetId&&(this.targetId=a.targetId),null!=a.width&&(this.width=a.width),null!=a.height&&(this.height=a.height))}function LegendWidget(a){this.width=300,this.height=300,this.title="Legend",null!=a&&(null!=a.title&&(this.title=a.title),null!=a.targetId&&(this.targetId=a.targetId),null!=a.width&&(this.width=a.width),null!=a.height&&(this.height=a.height)),this.legendPanel=new LegendPanel}function UrlWidget(a){_.extend(this,Backbone.Events),this.id=Utils.genId("UrlWidget"),this.targetId=null,this.title="Custom url",this.width=500,this.height=400,_.extend(this,a),this.on(this.handlers)}function FileWidget(a){_.extend(this,Backbone.Events),this.id=Utils.genId("FileWidget"),this.targetId,this.wum=!0,this.tags=[],this.viewer,this.title,this.dataAdapter,this.args=a,_.extend(this,a),this.on(this.handlers)}function BEDFileWidget(a){null==a&&(a=new Object),a.title="BED",a.tags=["bed"],FileWidget.prototype.constructor.call(this,a)}function GFFFileWidget(a){null==a&&(a={}),this.version="2",null!=a.version&&(this.version=a.version),a.title="GFF"+this.version,a.tags=["gff"],FileWidget.prototype.constructor.call(this,a)}function GTFFileWidget(a){null==a&&(a=new Object),a.title="GTF",a.tags=["gtf"],FileWidget.prototype.constructor.call(this,a)}function VCFFileWidget(a){null==a&&(a=new Object),a.title="VCF",a.tags=["vcf"],FileWidget.prototype.constructor.call(this,a)}function GenomeViewer(a){_.extend(this,Backbone.Events),this.id=Utils.genId("GenomeViewer"),this.version="Genome Viewer",this.targetId,this.quickSearchResultFn,this.quickSearchDisplayKey,this.drawNavigationBar=!0,this.drawKaryotypePanel=!0,this.drawChromosomePanel=!0,this.drawRegionOverviewPanel=!0,this.karyotypePanelConfig={collapsed:!1,collapsible:!0},this.chromosomePanelConfig={collapsed:!1,collapsible:!0},this.RegionPanelConfig={collapsed:!1,collapsible:!0},this.drawStatusBar=!0,this.border=!0,this.resizable=!0,this.sidePanel=!0,this.trackListTitle="Detailed information",this.trackPanelScrollWidth=18,this.availableSpecies={text:"Species",items:[{text:"Vertebrates",items:[{text:"Homo sapiens",assembly:"GRCh37.p10",region:{chromosome:"13",start:32889611,end:32889611},chromosomes:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","X","Y","MT"],url:"ftp://ftp.ensembl.org/pub/release-71/"},{text:"Mus musculus",assembly:"GRCm38.p1",region:{chromosome:"1",start:18422009,end:18422009},chromosomes:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","X","Y","MT"],url:"ftp://ftp.ensembl.org/pub/release-71/"}]}]},this.species=this.availableSpecies.items[0].items[0],this.zoom,this.chromosomes,this.chromosomeList,_.extend(this,a),this.defaultRegion=new Region(this.region),this.width,this.height,this.sidePanelWidth=this.sidePanel?25:0,this.on(this.handlers),this.fullscreen=!1,this.resizing=!1,this.rendered=!1,this.autoRender&&this.render()}var Utils={characters:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",formatNumber:function(a){return a.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},formatText:function(a,b){return a=a.replace(new RegExp(b,"gi")," "),a=a.charAt(0).toUpperCase()+a.slice(1)},isFunction:function(a){return"function"==typeof a||a instanceof Function},parseDate:function(a){return a.substring(0,4)+" "+a.substring(4,6)+" "+a.substring(6,8)+", "+a.substring(8,10)+":"+a.substring(10,12)+":"+a.substring(12,14)},genId:function(a){return a=a||"",a=0==a.length?a:a+"-",a+this.randomString()},randomString:function(a){a=a||10;for(var b="",c=0;a>c;c++)b+=this.characters.charAt(this.getRandomInt(0,this.characters.length-1));return b},getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},endsWithIgnoreCase:function(a,b){var c=new RegExp("^.*\\.("+b+")$","i");return c.test(a)},endsWith:function(a,b){var c=new RegExp("^.*\\.("+b+")$");return c.test(a)},addQueryParamtersToUrl:function(a,b){var c="?";-1!=b.indexOf("?")&&(c="&");var d="";for(var e in a)null!=a[e]&&(d+=e+"="+a[e].toString()+"&");return""!=d&&(d=c+d.substring(0,d.length-1)),b+d},randomColor:function(){for(var a="",b=0;6>b;b++)a+=[0,1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f"][Math.floor(16*Math.random())];return"#"+a},colorLuminance:function(a,b){a=String(a).replace(/[^0-9a-f]/gi,""),a=String(a).replace(/#/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),b=b||0;var c,d,e="#";for(d=0;3>d;d++)c=parseInt(a.substr(2*d,2),16),c=Math.round(Math.min(Math.max(0,c+c*b),255)).toString(16),e+=("00"+c).substr(c.length);return e},getSpeciesFromAvailable:function(a,b){for(var c=0;c<a.items.length;c++)for(var d=a.items[c].items,e=0;e<d.length;e++){var f=d[e];if(this.getSpeciesCode(f.text)==b)return f}},getSpeciesCode:function(a){var b,c=a.split(" ");return b=c.length<3?(c[0].charAt(0)+c[1]).toLowerCase():(c[0].charAt(0)+c[1]+c[c.length-1].replace(/[/_().\-]/g,"")).toLowerCase()},test:function(){return this},cancelFullscreen:function(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},launchFullScreen:function(a){a.requestFullScreen?a.requestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen&&a.webkitRequestFullScreen()},parseJobCommand:function(a){var b={},c=a.commandLine.split(/ -{1,2}/g),d='<table cellspacing="0" style="max-width:400px;border-collapse: collapse;border:1px solid #ccc;"><tbody>';d+='<tr style="border-collapse: collapse;border:1px solid #ccc;font-weight:bold;">',d+='<td style="min-width:50px;border-collapse: collapse;border:1px solid #ccc;padding: 5px;background-color: whiteSmoke;">Parameter</td>',d+='<td style="border-collapse: collapse;border:1px solid #ccc;padding: 5px;background-color: whiteSmoke;">Value</td>',d+="</tr>";for(var e=1;e<c.length;e++){var f=c[e],g=f.split(/ {1}/g),h="",i="";g.length<2?(h=g[0],i="<span color:darkgray;font-weight:bold;>This paramenter is a flag</span>"):(h=g[0],i=g[1]),b[h]=i,i=i.replace(/\/httpd\/bioinfo\/opencga\/analysis\/.+\/examples\//,""),i=i.replace("/httpd/bioinfo/opencga/accounts/",""),i=i.replace(/,/g,", "),d+='<tr style="border-collapse: collapse;border:1px solid #ccc;">',d+='<td style="border-collapse: collapse;border:1px solid #ccc;padding: 5px;background-color: whiteSmoke;color:steelblue;font-weight:bold;white-space: nowrap;">'+h+"</td>",d+='<td style="border-collapse: collapse;border:1px solid #ccc;padding: 5px;background-color: whiteSmoke;">'+i+"</td>",d+="</tr>"}return d+="</tbody></table>",{html:d,data:b}}};Utils.images={add:"data:image/gif;base64,R0lGODlhEAAQAIcAAD2GNUKNNkOPOESMO0WNPEmPP0iNQUmPQlOVTFWWTVCZQVeeRV6cVmGeWGSgVWSgV2aiWGejW2WrVWirU2uqWGqsW2yqWm61WG+1WG+1WXS3W3S3XHC4WXK5W3O6XHG+X3asZ3iuaHe8YHi0ZH+yany6ZH28Zn2+Z3m9bn25an25a3+5bUD/QHDBY3nBZHrGa3zDa37BaX7Hb4K1boO1boa3cYi4d4y7doq5eYm+eI2+e5O/f4HMdYbJeobJfIXNeYrCeY/CfYnIf4rPfZW/gozLgY7MhI7Sg5LFgJXAgpfHhZfMhZPNiJjLhpjMh5jMipvBl5vBmJTTipbTiZXUipbUi5fVi5nRi53YkqTOlKbPlqbQlqDZlaDZlqXbm6rUnavUnKbIoKfJoa/fpa/fprPZpbTZpbTaprLbqLPdqbXbqLfaqrTdqrXfrLbdrLjVr7jdr7vcr7rWsbfgr77itr3ktsTcuMXducXowMvmw87pydTrz9fu0tzx2ODy3P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAACwALAAAAAAQABAAAAi/AFkIHEiwoME7SWrMwCHH4MAdWfLs0QNnRQiHN+L4qeOlyxg8QCAU3LGmDxYmRqpQOTJHRYSBdpTw4SJFyJ8/P2DIaLNAjEAibsgU8YHiZgURHq4gaSCQBh0rPW5K/cMhxpcCAkmkGcJj6k0OJ8AMEGjjyZQXLSR85dBhiY4EAt9MYOPig4ivFzacEQBlIIgUaJByyIBBQxkLBwo6GKHGiYkSTcxQAODwgYIgW7TkCGDAocAwDAoQQBDFs2mCAQEAOw==",del:"data:image/gif;base64,R0lGODlhEAAQAIcAAED/QLpSNL9TOr5WOb5cQL9cQMFNM8RQNMBVPcBZP8xSPNBPPttWS9ddUcJnTMRkTMdrVM1gUc5iVMxmVclrVs1oWNZgVNZuZNtpZdxraN5ratxuadRxZd14c955dOZWTOZYTOZZTulZTelbT+ZWUOZaUuddWepcUOxfVOBlXO5mUuljW+pmXO5qXvBkVvNzXeNrYeNuY+FvcOJwZuJ7deR4ceJ5eeN4eeJ/feN/fOl7cOh6del/ePJ3Y/N5Y+qDfe6Efe+Gfu6KdfaCaPaEbPCFcPCDe/CMd/GOeviGcPiMdvCRf/eRfveTfvmSfvqTf/iUf9ymltynl+6Mge2Tju6Sj/SOgfqah/qdi/GclvGdluGpnvSgnvSinvWjn/qjkfupnPqrneGroOqwrOuzr/Ono/WmoferofarovWsofWvpfKtqvivpPS0qvi2qPm5r/q6rvC1tfC2tvjDvvzHuvnLxPnTzPzUzf3b1P3c2P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAAALAAAAAAQABAAAAi6AAEIHEiwoEE5ODRk8EDG4EAbVObYqdNmxgWHMtbkgfMFCxg6OiQUvFEGz5UlSKA4UeImRoWBcX7cwdJECJGbRHywWSBGYA41YY6gGEq0hxUeFARuePOkiJ6nUEW00IJAIIYzSYZAjcoiywCBHaYweSGirNkRRmg8EDiGARoXKsyKAFHCy4EoAznASIPihIgQH0h0sVCgYIQUZoKsMAGES4MADico2FGlSg0DBBwK3AIhgQAHUjSLJhgQADs=",enable:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAKfSURBVDjLpZPrS1NhHMf9O3bOdmwDCWREIYKEUHsVJBI7mg3FvCxL09290jZj2EyLMnJexkgpLbPUanNOberU5taUMnHZUULMvelCtWF0sW/n7MVMEiN64AsPD8/n83uucQDi/id/DBT4Dolypw/qsz0pTMbj/WHpiDgsdSUyUmeiPt2+V7SrIM+bSss8ySGdR4abQQv6lrui6VxsRonrGCS9VEjSQ9E7CtiqdOZ4UuTqnBHO1X7YXl6Daa4yGq7vWO1D40wVDtj4kWQbn94myPGkCDPdSesczE2sCZShwl8CzcwZ6NiUs6n2nYX99T1cnKqA2EKui6+TwphA5k4yqMayopU5mANV3lNQTBdCMVUA9VQh3GuDMHiVcLCS3J4jSLhCGmKCjBEx0xlshjXYhApfMZRP5CyYD+UkG08+xt+4wLVQZA1tzxthm2tEfD3JxARH7QkbD1ZuozaggdZbxK5kAIsf5qGaKMTY2lAU/rH5HW3PLsEwUYy+YCcERmIjJpDcpzb6l7th9KtQ69fi09ePUej9l7cx2DJbD7UrG3r3afQHOyCo+V3QQzE35pvQvnAZukk5zL5qRL59jsKbPzdheXoBZc4saFhBS6AO7V4zqCpiawuptwQG+UAa7Ct3UT0hh9p9EnXT5Vh6t4C22QaUDh6HwnECOmcO7K+6kW49DKqS2DrEZCtfuI+9GrNHg4fMHVSO5kE7nAPVkAxKBxcOzsajpS4Yh4ohUPPWKTUh3PaQEptIOr6BiJjcZXCwktaAGfrRIpwblqOV3YKdhfXOIvBLeREWpnd8ynsaSJoyESFphwTtfjN6X1jRO2+FxWtCWksqBApeiFIR9K6fiTpPiigDoadqCEag5YUFKl6Yrciw0VOlhOivv/Ff8wtn0KzlebrUYwAAAABJRU5ErkJggg==",warning:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAIsSURBVDjLpVNLSJQBEP7+h6uu62vLVAJDW1KQTMrINQ1vPQzq1GOpa9EppGOHLh0kCEKL7JBEhVCHihAsESyJiE4FWShGRmauu7KYiv6Pma+DGoFrBQ7MzGFmPr5vmDFIYj1mr1WYfrHPovA9VVOqbC7e/1rS9ZlrAVDYHig5WB0oPtBI0TNrUiC5yhP9jeF4X8NPcWfopoY48XT39PjjXeF0vWkZqOjd7LJYrmGasHPCCJbHwhS9/F8M4s8baid764Xi0Ilfp5voorpJfn2wwx/r3l77TwZUvR+qajXVn8PnvocYfXYH6k2ioOaCpaIdf11ivDcayyiMVudsOYqFb60gARJYHG9DbqQFmSVNjaO3K2NpAeK90ZCqtgcrjkP9aUCXp0moetDFEeRXnYCKXhm+uTW0CkBFu4JlxzZkFlbASz4CQGQVBFeEwZm8geyiMuRVntzsL3oXV+YMkvjRsydC1U+lhwZsWXgHb+oWVAEzIwvzyVlk5igsi7DymmHlHsFQR50rjl+981Jy1Fw6Gu0ObTtnU+cgs28AKgDiy+Awpj5OACBAhZ/qh2HOo6i+NeA73jUAML4/qWux8mt6NjW1w599CS9xb0mSEqQBEDAtwqALUmBaG5FV3oYPnTHMjAwetlWksyByaukxQg2wQ9FlccaK/OXA3/uAEUDp3rNIDQ1ctSk6kHh1/jRFoaL4M4snEMeD73gQx4M4PsT1IZ5AfYH68tZY7zv/ApRMY9mnuVMvAAAAAElFTkSuQmCC",edit:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB80lEQVR42o2T30tTURzArb8ioiAI6kHoZeF7CGE/IISCUDNCqAeL3rIWPfSwByskYUEJIhSChBhJFAiNqMVYPqRuc4tcW3NLt3C7u3d3d3c/+nS+0GRK0134cC6c8/ncc+7ltgFt6jqgcCg6duGQYq84deoBR6lU0iqVSq1arfI/1Dxut3u0Htke6BC5UChgmuYm+XyeXC5HOp1GIsnQNJHJi3x/7WJh/CSLT9r7Rd4jAVlgWRa2bSOjYBgGmqaRyWQwkq9Y8wyhLb0BI0VuaRrfo671xoDIwmakWCyi6zrr36bILt/HXp1l7cNDioEZqnEvgYmr1paAOgYy1u/l3NrqHNngPWpFL8XodTa+3CD8YoCvz/o078i5o1sC29FT78kG7lCzfJgrl7ESvejLThLPuxk8fbhP3KaBVFCdeX7on9yP9bOHfPAu0bEzmKkg4jQNpEKzhOduqW1/xIoNUEpcQlM7WXl6Cj39Q9Y0D4Q/TRJ662Tx3WOS/guYsV42Fm4THe/G/B2T97Jz4OVwJ+hxImPn8Tj381k91TfShfErIvLuAde1Y9g+N7Z/FL/rBDODR8gmgpTL5To7B3o69zF8pR3Pg7PMT90kn47LJ22kaeCPghapidP4Lxy3bduUiVZktdaQH7AxcFAiUm0Rhzji/gUhbp0s2Zf2xwAAAABJRU5ErkJggg==",info:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJ1SURBVHjafJJdSJNhFMd/z3QzLWdZrnQmSA2DPqRCK4KuhIq66kLoAy/qoqCguqqL6JsgLwoKKhCMSIy6CDKKRFZZYYQRVhJl02nWmG5uc19u7/vuPV0lW7QOnIsHnt+P8z/Pg4gw26aZ0263uzEUCn2IxWJjXq/3JqBETLIZ8gkePLhfKyKy/Z5HHJf7xe0Jic/n65mejizPK0inUiSTKUSE0dHRhxf6JoSDb4Rjr4QDz0REJBgMtmczFrJKKYVSCjCYnPR/W1FuAwQSGjbHXAA0LRXKZnIm0NJpgAKvd/hSOBz2iIj0eiPS2vtDYsmUPH/uPg9YshklIrOyCb+/eUG5ve3au5C99W2AqGbgKivk8R4X1lSkv2pJZaNmmBQVWWeZnAiGoa+3KovdyBjsW2kn/SvK4Jcgtaf7cDqrGkQMUDkBcgXVS2tOHjp8dG2jOXT1yo5lYOpgFTB0wKTAOqdQMlqOoDD7EE8kREwGXr/oWTg4HjxONAklBayuKSUeT/hFTxrwnwlAMa8I1qyrP3H95RiQgUiC/RsWM+wZ6jIME0M38wtSM0mmojM4nc6mzr5xKDQgnWb/pmoedT29EU3pTMUS+QVKKerq6kqnI3EVHwmAplO8qBh7WTFnzpz9bOg6FovlfxGEixfOrfT6YxCOQ1rDUaIAG4EJ38+PAwNb/95Bzj8ITAZwLHbMT0yHw3N33YVwEnQDqss41VzPkaalX6Iz+m6Xy/Xp34JAAICR7187nLWuvbe6h9C0DA2uRTTVV9J++87OlpaWJxUVFf9+xj+1cfOWls6OO93Nq1zblMVm9flG3pcvXNPm90+E/777ewB+UIqdqtYXHAAAAABJRU5ErkJggg==",bucket:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QkQDC8RTstxRAAAAGBJREFUOMtjYBgswIWBgeE/idiFgYGBgRFqwH8GBoYGEi1tYGBgYGRBE9QjUvMlGANmgCsDA8NuElzRANXDwAQV2ENGuO1BNoBsMGoAlQ3wJTIdNEDVYgU+ROQBH6rmQgAWgB19xco60wAAAABJRU5ErkJggg==",dir:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QkQDBgWQKhE0wAAADRJREFUOMtjYBhowMjAwPCfCDU4AQuUNsQhf54aLmAgxgW9ZOovZqI0EEcNGBYGUJwSKQYAJoEFGqo9ooAAAAAASUVORK5CYII=",r:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90CDRIvNbHTpbwAAADjSURBVDjLpZFBbsIwEEUfVRZYahcVK3qKXoauMFK5C91nkyUB+xC5BqeAA7SKq1B5ugl2EiC04UkjayzN17NnROTRWvvJFbTWL8CBHqbGWOlSlqVkWSbGWAGm3aGHZiMiAByPP6FOd1rP2W7NvhvSCvDe10E+VJPFQpPnm1ZIcsmgPgJVVZGmaejX63y/XL4/AV/JJYPTCeDcN7PZWyuwKAqA8wARqSsGKDVGqXGjV8H07AnRQPq21TK8+YSBAQMN4hb6Df7wB/5eA+4zmEyehxk451itPrhFksSxUeP+lf+z+wXwdayJk/mqtgAAAABJRU5ErkJggg==",box:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wMHAwRAVvTmTAAAAK/SURBVDjLpZM9bFxFGEXPNzPvZ+39sb2xHceREjDQBwlDCqqIiiotokAghYKEjvSkQkKJkEiB0lOkoAHaBAokFCQKUATIIOLIMbHWrHfX+7zvvZk3MzQODUgU3PJK5+g2F/5n5N/Kb66/1NNK3hAxr4HcFqVuvfju18V/Cu58sPmMVnJZ4K32Qr+t8za+KnCz4kCUuiGibm5euTv5h+CL958/nxj1XivVF+e6C9TVhPmFdbROgEhwNU1d4m09UaJuInLjhct3DgDUh5ee7j14PLxulLvYP/0seadPkub88Wib0eB3bDkmxgbRoFPpxeCuKvjsyQIzOyqImT7/y8Mh++NveW7jLFmrx6m1NlWxz6PHA7otQ7tloAmYJE9isOeeCJRtIrULLLUTjsqG7+//xs72z7jZgCTNONlVJKEiuobW0jqSaoiet19dFQATJcc2FSFEciNoLYwOHcPDASvdjM5cQntxlbR9gqacoFSK84VsnOrkH11Zdmp0FFXjobSeCFgXSDS0Eo11ge7yGXSaU092UUlCaEpC8FK4tDcu4rzZ2a/S+bWI94HSAgFigDQD24Cvp4gIOp0juBJvC2L07B1Uc/Mtg9k7sHMbywZrA3lLECV4AtaCpAp79CcmzXHlhOBrAJrGyNbOVBY7qTO1C9r5EKyPSttAiJEs01SuQStFkrdp6gKd5AzHjixVxCDxp+1paZRUxoc4Kp36bndYbS53U5WlCq0CMYIPMY7GI0mNpiqmGK0oK4jIveGkPgRqfTBt3A8Pqtvrq52HtglnGh9XIaKUkCQ6nj6RyWBsmdXCtFI/bu2Fq5c+3roGzIAgWokCDNACOhfOLb781Ip+vd+RC2dXWibROkxKvvp1z376yZe7d4HpMdz8/YVjiQYyoA30Ti6la2++0n/n83vTW/e3ix1gcgzXgPchBoC/AFu/UBF5InryAAAAAElFTkSuQmCC",bluebox:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wMHAwTE5pcivoAAALsSURBVDjLXZPPaxxlGMc/77wz+3N2k822tWsTIrQFe/BWEKxKCV5UohdFhJ60p6rgUfpP6C0K4kHx0ENEkV7aElHwUikhFVosRGoTm83+3pnZnXfed2beHtItIQ98+Z6+H57nga8AsNYKDkYcEofcHvKZEEJYcSTszPzqL3fmf3+w/+a51tytby9d6D0N5UecGeBZ8MPv/jh9fy/6dKzMpVPHmvWdbl/XCvKn5Wbl6+ufrNwGssMgYa2VgFj58sZr7VB/LqX3zlKrydJzTTzXxdqcx90hO+0Bk2l8Z74i1z6+cOba5VfOqGeAb3579M/NR53T40xwrDGHFALPEUjn4LoMi0ktwWTKXqCIqAVrbyycvHj2hHYBR+bO8Q/Ov0imEzZ2xrRDRalQwC9LLBalUgaJQy+tU6gvIBJbv3j2RA4IFxDdICFa9ulMCrz/UgOs5kEwpeh57I4Nt/dzsmLOYlEThgFjUePp33IHoD9SJAbuTVyudRweixJvnVtg3/i00wpLPiwQ0hkO6YYKawWj0UjONqAfKHwDkxTqqeW/RHA3hO2+Zqk05e5wTD9KmOqMKDEUqoLNzU0PyF2AQaBoaIhiw0h6TIwgUDCODb5NiWJNlKREyhAozXwOW1tbFSmlcAHbD2KaytCdGgyWglfEs4LeNKeaa4axYRgpwlgTTTXVDDqdTslaewAYh4kNlKUbZsTGonOwCYwm1vq5Ft1AMYgU08SQR5o0gziOcRxHuoCNtdl6uPHX6/Vmi3Yyh9I5IoEgMdkgT9x+qJhEGrdQo77cJMuy+4DJskwLa60DOCtf3HhZpfZKtVx+L3x+sfCv8CFxTINd72HfodQ4aQp5fP24/v/Hd4Nf/5RSJmma6lkXZn1wPvvq5qndsbhS9esf/Zy/UEtzxnURfn8+/fuHV7m353mecV1XSym1lDI72kaxvr5e3N7eruyP0tpG/e3LK/rW2mLNUb7vm3K5nFarVdNqtbJer2dXV1fzJ6cDpboAZRAGAAAAAElFTkSuQmCC",refresh:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAK8AAACvABQqw0mAAAAAd0SU1FB90CFA8bKScXIjIAAAJ1SURBVDjLlVJdSJNRGH7es+/7NlduWFLTKAskwjJqZYiBglJhLKguqou6EFkFIkLQH9IPBFI3BsouzMJupGYRajcqmeBFhWBU5oUgpZikrSnzZ9v3nW/ndKEbziXUAwfOOe/7Puc9z/MCq1DwMmB1NX/rzfCNnsc/gK08lPgnnT8Cs33BULg0HI4YKdkHX9DqKwKArXXv1bTMTFcoyruC89E8MxaDw659t6rKhIUwRBLdP2t2v/5bBwQA+5pH8ibnIj3BucgWIQRASw8RERTGYFUtsGmWYUXKmqmr7t4UAnal54GQ8lq8MBlyOU0CEnA67MiwqfvHbhZ+Smgg6o9eV2L8Nhk6wI2lZeggrpvE+TTjxgxxQ4IbmJsJYSa00JQiotnguacJ8zIZOmDosAnzTpowt8tGj0s0ejZqprnDKmPHSNebjHDkUPatt4cTTbZ+LsmO79XK52dZxTNp9/ovAEDnaM62lo8HHrd9SVfiOelVryrSq9vrEx0s8sW2tuEzDgDgT875bcIsjy6owwAwHhjnYT5bGTL29PiHyuwAMO873aL/Ct5PiPjwXe5vq7KJW2hdJxENMFInGCkhIblLj80WRoyxGxZmh1XJGlSIlV8s6A8kuVDXn+MF6JHC7GBkBSNlOSRgiihMsQhAgJGGNNU1atc2HPG6O8YSBABwt2/nGyFlGSCSB4UIBMuyoQKMFNiUjIApRH5t8YfpFOOrO/JrhZBVUiJLxq2ipIkY8Z36uivpC6txqb3YbhqhIingFlLmxmLSKyXAGAaYqh13aFjfcHJwfE2ClSitK9psc85PMVC3M999orX4Kcf/wuPb27VW7A+O2QVVA1M1CQAAAABJRU5ErkJggg==",newitem:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAtxJREFUeNqM0llIVHEUBvDv3vlfZ8ac6zZtWpmamtliUUHRDlFJWlEYLdBLtG/QBlFJQUTSU089RZRlG4EvkS9NlqkpldHyYLk1OurcOzp30vHO/y6nBwsSIvzgvBw+fpyHA8MwwDmHbdsjQwSbCACkYDBYp6pqU3Fxcfyf/Z+eYRjQOQf+Bnw+30IiIsMwhizL4n3lV6mn7BzZtm1yzn8SETU0NKz+J2ARobe3t85/+SI1506j9hOHqTEO9FYEtR/ZTx/n5FDH6eOkquoni2g00NjUtEzTtBYioneLCulVHKg2yUkNmelUn5VOtUlueu0SqDE/m4iIIpFI64fm5vU65xAMIlicR9rOn/UEKytgmQbYuARAEDAqRLCiQxBFhtTNWzDzxk1LcjgkFhuKIhLR2qJKcN5Al/q7reF/cXUHoA0MtA9Gh4klJIxz6ro+PZiVC0uOw1jimJEDWZbTDhw8lCi0+/3PtUeV696ePIPUnIwxAf3fOjG/7AK8e/e9ZH2K0uWdPRdivANm3NguED1OJBYWQunvDwgAXIqifO54+CC7/tSxMQELL11B/r6D3cnJybniQDis25Ikfn1wD2GdQLIMISkF5JFhudwgjwySkyCkpILkRER0wpf7d2FJkqSoapQRRPCYjoLDR+EY70VXbS2YxCC4nAARbAAQBJBlwTIMZJRsQN7W7eA6t9O8XkE0jRhWLV2y+Gdm9q0dT6rMhLw8dPn7EAoEMBSLIcpjCPUEEPD3gU1Kw+6qZ6TPKrizq3TbAjUUIkFRVYAIkkfG99bWp4P1b7Z0vq5BXtFGPN6zE6Zuo7SiAh01PkycV4jJRRt96VOmrOHhMESHiBEAgMkNlGwqmXC78mG1DXtQdruTgx/eF5g6x9Tly1pCmtYjMSnxatnFTeXXyn8wxiCMAgxz5EmcTjCXCynxblf1C9910eFwrl254nh/dDhqcQ5zeBgAwBiDIAr4NQAWJarVjshqqgAAAABJRU5ErkJggg=="},Utils.genBamVariants=function(a,b,c,d){for(var e=a.length,f=b/6,g="",h=0;e>h;h++){switch(a.charAt(h)){case"A":g+="M"+(2.5*f+c)+","+d+"l-"+2.5*f+","+6*f+"l"+f+",0"+"l"+.875*f+",-"+2*f+"l"+2.25*f+",0"+"l"+.875*f+","+2*f+"l"+f+",0"+"l-"+2.5*f+",-"+6*f+"l-"+.5*f+",0"+"l0,"+f+"l"+.75*f+","+2*f+"l-"+1.5*f+",0"+"l"+.75*f+",-"+2*f+"l0,-"+f+" ";
break;case"T":g+="M"+(.5*f+c)+","+d+"l0,"+f+"l"+2*f+",0"+"l0,"+5*f+"l"+f+",0"+"l0,-"+5*f+"l"+2*f+",0"+"l0,-"+f+" ";break;case"C":g+="M"+(5*f+c)+","+(0*f+d)+"l-"+2*f+",0"+"l-"+1.5*f+","+.5*f+"l-"+.5*f+","+1.5*f+"l0,"+2*f+"l"+.5*f+","+1.5*f+"l"+1.5*f+","+.5*f+"l"+2*f+",0"+"l0,-"+f+"l-"+2*f+",0"+"l-"+.75*f+",-"+.25*f+"l-"+.25*f+",-"+.75*f+"l0,-"+2*f+"l"+.25*f+",-"+.75*f+"l"+.75*f+",-"+.25*f+"l"+2*f+",0"+" ";break;case"G":g+="M"+(5*f+c)+","+(0*f+d)+"l-"+2*f+",0"+"l-"+1.5*f+","+.5*f+"l-"+.5*f+","+1.5*f+"l0,"+2*f+"l"+.5*f+","+1.5*f+"l"+1.5*f+","+.5*f+"l"+2*f+",0"+"l0,-"+3*f+"l-"+f+",0"+"l0,"+2*f+"l-"+f+",0"+"l-"+.75*f+",-"+.25*f+"l-"+.25*f+",-"+.75*f+"l0,-"+2*f+"l"+.25*f+",-"+.75*f+"l"+.75*f+",-"+.25*f+"l"+2*f+",0"+" ";break;case"N":g+="M"+(.5*f+c)+","+(0*f+d)+"l0,"+6*f+"l"+f+",0"+"l0,-"+4.5*f+"l"+3*f+","+4.5*f+"l"+f+",0"+"l0,-"+6*f+"l-"+f+",0"+"l0,"+4.5*f+"l-"+3*f+",-"+4.5*f+" ";break;case"d":g+="M"+(0*f+c)+","+(2.5*f+d)+"l"+6*f+",0"+"l0,"+f+"l-"+6*f+",0"+"l0,-"+f+" ";break;default:g+="M0,0"}c+=b}return g};var SVG={create:function(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a);for(var d in b)c.setAttribute(d,b[d]);return c},addChild:function(a,b,c,d){var e=document.createElementNS("http://www.w3.org/2000/svg",b);for(var f in c)e.setAttribute(f,c[f]);return this._insert(a,e,d)},addChildImage:function(a,b,c){var d=document.createElementNS("http://www.w3.org/2000/svg","image");for(var e in b)"xlink:href"==e&&d.setAttributeNS("http://www.w3.org/1999/xlink","href",b[e]),d.setAttribute(e,b[e]);return this._insert(a,d,c)},_insert:function(a,b,c){if(null==c)a.appendChild(b);else{var d=c+1;0==c&&(d=0);var e=a.childNodes[d];e?a.insertBefore(b,e):a.appendChild(b)}return b},init:function(a,b){return this.addChild(a,"svg",b)},_polarToCartesian:function(a,b,c,d){var e=(d-90)*Math.PI/180;return{x:a+c*Math.cos(e),y:b+c*Math.sin(e)}},describeArc:function(a,b,c,d,e){var f=this._polarToCartesian(a,b,c,e),g=this._polarToCartesian(a,b,c,d),h=180>=e-d?"0":"1",i=["M",f.x,f.y,"A",c,c,0,h,0,g.x,g.y].join(" ");return i}};Region.prototype={load:function(a){return _.isString(a)?this.parse(a):(this.chromosome=a.chromosome||this.chromosome,this.chromosome=this.chromosome,this.start=_.isUndefined(a.start)?parseInt(this.start):parseInt(a.start),this.end=_.isUndefined(a.end)?parseInt(this.end):parseInt(a.end),void 0)},parse:function(a){_.isObject(a)&&this.load(obj);var b=/^([a-zA-Z0-9_])+\:([0-9])+\-([0-9])+$/,c=/^([a-zA-Z0-9_])+\:([0-9])+$/;if(b.test(a)||c.test(a)){var d=a.split(":");if(2==d.length){var e=d[1].split("-");this.chromosome=d[0],this.start=parseInt(e[0]),this.end=2==e.length?parseInt(e[1]):this.start}return!0}return!1},center:function(){return this.start+Math.floor(this.length()/2)},length:function(){return this.end-this.start+1},toString:function(a){var b;return b=1==a?this.chromosome+":"+Utils.formatNumber(this.start)+"-"+Utils.formatNumber(this.end):this.chromosome+":"+this.start+"-"+this.end}},FeatureBinarySearchTree.prototype={constructor:FeatureBinarySearchTree,add:function(a){var b,c={value:a,left:null,right:null};if(null===this._root)return this._root=c,!0;for(b=this._root;;)if(c.value.end<b.value.start){if(null===b.left)return b.left=c,!0;b=b.left}else{if(!(c.value.start>b.value.end))return!1;if(null===b.right)return b.right=c,!0;b=b.right}},contains:function(a){for(var b={value:a,left:null,right:null},c=!1,d=this._root;!c&&d;)b.value.end<d.value.start?d=d.left:b.value.start>d.value.end?d=d.right:c=!0;return c}};var CellBaseManager={get:function(a){var b=a.success,c=a.error,d=_.isUndefined(a.async)||_.isNull(a.async)?!0:a.async,e=_.omit(a,["success","error","async"]),f=CellBaseManager.url(e);if("undefined"!=typeof f){console.log(f);var g;return $.ajax({type:"GET",url:f,dataType:"json",async:d,success:function(a){$.isPlainObject(a)||$.isArray(a)?(_.isFunction(b)&&b(a),g=a):(console.log("Cellbase returned a non json object or list, please check the url."),console.log(f),console.log(a))},error:function(a,b,d){console.log("CellBaseManager: Ajax call returned : "+d+"	"+b+"	"+a.statusText+" END"),_.isFunction(c)&&c(a,b,d)}}),g}},url:function(a){$.isPlainObject(a)||(a={}),$.isPlainObject(a.params)||(a.params={});var b="latest";"undefined"!=typeof CELLBASE_VERSION&&(b=CELLBASE_VERSION),"undefined"!=typeof a.version&&null!=a.version&&(b=a.version);var c;if("undefined"!=typeof CELLBASE_HOST&&(c=CELLBASE_HOST),"undefined"!=typeof a.host&&null!=a.version&&(c=a.host),"undefined"==typeof c)return console.log("CELLBASE_HOST is not configured"),void 0;delete a.host,delete a.version;var d={host:c,version:b},e={of:"json"};_.extend(d,a),_.extend(d.params,e);var f="";"undefined"!=typeof d.query&&null!=d.query&&($.isArray(d.query)&&(d.query=d.query.toString()),f="/"+d.query),$.isPlainObject(d.species)&&(d.species=Utils.getSpeciesCode(d.species.text));var g=d.host+"/"+d.version+"/"+d.species+"/"+d.category+"/"+d.subCategory+f+"/"+d.resource;return g=Utils.addQueryParamtersToUrl(d.params,g)}};InfoWidget.prototype.draw=function(a){console.log(a),this.query=a.query,this.feature=a.feature,this.adapter=a.adapter,this.panel=Ext.getCmp(this.title+" "+this.query),null==this.panel?(this.render(),this.panel.show(),this.getData()):this.panel.show()},InfoWidget.prototype.render=function(){this.panel=Ext.create("Ext.window.Window",{title:this.title+" "+this.query,id:this.title+" "+this.query,minimizable:!0,constrain:!0,closable:!0,height:this.height,width:this.width,layout:{type:"hbox",align:"stretch"},items:[this.getTreePanel()],buttonAlign:"right",listeners:{scope:this,minimize:function(){this.panel.hide()},destroy:function(){delete this.panel}}})},InfoWidget.prototype.getTreePanel=function(){var a=this.getdataTypes();this.checkDataTypes(a);var b=Ext.create("Ext.data.TreeStore",{root:{expanded:!0,text:"Options",children:a}}),c=Ext.create("Ext.tree.Panel",{title:"Detailed information",bodyPadding:10,flex:1,border:!1,store:b,useArrows:!0,rootVisible:!1,listeners:{scope:this,itemclick:function(a,b){this.optionClick(b.data)}}});return c},InfoWidget.prototype.doGrid=function(a,b,c,d){for(var e=Ext.create("Ext.grid.feature.Grouping",{groupHeaderTpl:'{[values.name]} ({rows.length} Item{[values.rows.length > 1 ? "s" : ""]})',startCollapsed:!0}),f=[],g=0;g<b.length;g++)f.push({type:"string",dataIndex:b[g]});var f={ftype:"filters",local:!0,filters:f};Ext.define(c,{extend:"Ext.data.Model",fields:b});var h=Ext.create("Ext.data.Store",{groupField:d,model:c}),i=Ext.create("Ext.grid.Panel",{id:this.id+c,store:h,title:c,border:!1,cls:"ocb-border-left-lightgrey",flex:3,features:[e,f],viewConfig:{enableTextSelection:!0},columns:a,bbar:["->",{text:"Clear Grouping",handler:function(){e.disable()}}]});return i},InfoWidget.prototype.checkDataTypes=function(a){for(var b=0;b<a.length;b++)null!=a[b].children?(a[b].iconCls="icon-box",a[b].expanded=!0,this.checkDataTypes(a[b].children)):(a[b].iconCls="icon-blue-box",a[b].leaf=!0)},InfoWidget.prototype.getdataTypes=function(){return[]},InfoWidget.prototype.optionClick=function(){},InfoWidget.prototype.getData=function(){},InfoWidget.prototype.getGeneTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{name}</span> &nbsp; <span class="emph s120"> {id} </span></span>',' &nbsp; <a target="_blank" href="http://www.ensembl.org/'+this.ensemblSpecie+'/Location/View?g={id}">Ensembl</a>',' &nbsp; <a target="_blank" href="http://wikipathways.org//index.php?query={externalName}&species='+this.wikipathwaysSpecie+'&title=Special%3ASearchPathways&doSearch=1">Wikipathways</a>',"</div><br>",'<div><span class="w75 infokey s90">Location: </span> <span class="">{chromosome}:{start}-{end} </span><span style="margin-left:50px" class=" infokey s90">Strand: </span> {strand}</div>','<div><span class="w75 infokey s90">Biotype: </span> {biotype}</div>','<div><span class="w75 infokey s90">Description: </span> <span><tpl if="description == &quot;&quot;">No description available</tpl>{description}</span></div>','<div><span class="w75 infokey s90">Source: </span> <span class="s110">{source}</span></div>','<div><span class="w75 infokey s90">Status: </span> {status}</div>')},InfoWidget.prototype.getTranscriptTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{name}</span> &nbsp; <span class="emph s120"> {id} </span></span>',' &nbsp; <a target="_blank" href="http://www.ensembl.org/'+this.ensemblSpecie+'/Transcript/Transcript?t={id}">Ensembl</a>',' &nbsp; <a target="_blank" href="http://wikipathways.org//index.php?query={externalName}&species='+this.wikipathwaysSpecie+'&title=Special%3ASearchPathways&doSearch=1">Wikipathways</a>',"</div><br>",'<div><span class="w100 infokey s90">Location: </span> <span class="">{chromosome}:{start}-{end} </span><span style="margin-left:50px" class=" infokey s90">Strand: </span> {strand}</div>','<div><span class="w100 infokey s90">Biotype: </span> {biotype}</div>','<div><span class="w100 infokey s90">Description: </span> <span><tpl if="description == &quot;&quot;">No description available</tpl>{description}</span></div>',"",'<div><span class="w100 infokey s90">CDS &nbsp; (start-end): </span> {genomicCodingStart}-{genomicCodingEnd} <span style="margin-left:50px" class="w100 infokey s90">CDNA (start-end): </span> {cdnaCodingStart}-{cdnaCodingEnd}</div>','<div><span class="w100 infokey s90">Protein: </span> {proteinID}</div>','<div><span class="w100 infokey s90">External DB: </span> {externalDb}</div>','<div><span class="w100 infokey s90">Status: </span> {status}</div><br>')},InfoWidget.prototype.getSnpTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{id}</span></span>',' &nbsp; <a target="_blank" href="http://www.ensembl.org/'+this.ensemblSpecie+'/Variation/Summary?v={id}">Ensembl</a>',"</div><br>",'<div><span class="w140 infokey s90">Location: </span> <span class="">{chromosome}:{start}-{end} </span><span style="margin-left:50px" class=" infokey s90">Strand: </span> {strand}</div>','<div><span class="w140 infokey s90">Source: </span> <span class="s110">{source}</span></div>','<div><span class="w140 infokey s90">Type: </span> <span class="s110">{type}</span></div>','<div><span class="w140 infokey s90">Allele string: </span> {alleleString}</div>','<div><span class="w140 infokey s90">Ancestral allele: </span> {ancestralAllele}</div>','<div><span class="w140 infokey s90">Display SO consequence type: </span> {displayConsequenceType}</div>','<div><span class="w140 infokey s90">SO consequence types: </span> {consequenceTypes}</div>')},InfoWidget.prototype.getExonTemplate=function(){return new Ext.XTemplate('<span><span class="panel-border-bottom"><span class="ssel s110">{id}</span></span></span><br><br>','<span><span class="infokey s90"> Location: </span> <span class="">{chromosome}:{start}-{end} </span></span><br>','<span><span class="infokey s90"> Genomic coding (start-end) : </span> <span class="">{genomicCodingStart}-{genomicCodingEnd} </span></span><br>','<span><span class="infokey s90"> cDNA (start-end) : </span> <span class="">{cdnaCodingStart}-{cdnaCodingEnd} </span></span><br>','<span><span class="infokey s90"> CDS (start-end) : </span> <span class="">{cdsStart}-{cdsEnd} </span></span><br>','<span><span class="infokey s90"> Phase: </span> {phase}</span><br>')},InfoWidget.prototype.getProteinTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{name}</span> &nbsp; <span class="emph s120"> {primaryAccession} </span></span></div>',"<br>",'<div><span class="w100 infokey s90">Full name: </span> <span class="">{fullName}</span></div>','<div><span class="w100 infokey s90">Gene name: </span> <span class="">{geneName}</span></div>','<div><span class="w100 infokey s90">Organism: </span> <span class="">{organism}</span></div>')},InfoWidget.prototype.getVCFVariantTemplate=function(){return new Ext.XTemplate('<div><span><span class="panel-border-bottom"><span class="ssel s130">{chromosome}:{start}-{alternate}</span> &nbsp; <span class="emph s120"> {id} </span></span></span></div><br>','<div><span class="w75 infokey s90">Alt: </span> {alternate}</div>','<div><span class="w75 infokey s90">Ref: </span> {reference}</div>','<div><span class="w75 infokey s90">Quality: </span> {quality}</div>','<div><span class="w75 infokey s90">Format: </span> {format}</div>','<div><span class="w75 infokey s90">Samples: </span> {samples}</div>','<div><span class="w75 infokey s90">Info: <br></span> {info}</div>')},InfoWidget.prototype.getPWMTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{accession}</span> &nbsp; <span class="emph s120"> {tfName} </span></span></div>',"<br>",'<div><span class="w100 infokey s90">Type: </span> <span class="">{source}</span></div>','<div><span class="w100 infokey s90">Source: </span> <span class="">{type}</span></div>','<div><span class="w100 infokey s90">Description: </span> <span class="">{description}</span></div>','<div><span class="w100 infokey s90">Length: </span> <span class="">{length}</span></div>','<div><span class="w100 infokey s90">Frequencies: </span> <span class="">{[this.parseFrequencies(values.frequencies)]}</span></div>',{parseFrequencies:function(a){return"<div>"+a.replace(/,/gi,"<br>")+"</div>"}})},InfoWidget.prototype.getProteinXrefTemplate=function(){return new Ext.XTemplate('<div><span class="w75 emph s100">{[values.source.toUpperCase()]}</span> &nbsp; <span class="emph w125 s100"> {[this.generateLink(values)]} <span class="info">&raquo;</span> </span></div>',{generateLink:function(a){if(null==a.source)return"";switch(a.source.toUpperCase()){case"GO":return'<a TARGET="_blank" href="http://amigo.geneontology.org/cgi-bin/amigo/term_details?term='+a.name+'">'+a.name+"</a>";case"REACTOME":return'<a TARGET="_blank" href="http://www.reactome.org/cgi-bin/eventbrowser_st_id?ST_ID='+a.name+'">'+a.name+"</a>";case"KEGG":return'<a TARGET="_blank" href="http://www.genome.jp/dbget-bin/www_bget?'+a.name+'">'+a.name+"</a>";case"INTACT":return'<a TARGET="_blank" href="http://www.ebi.ac.uk/intact/pages/interactions/interactions.xhtml?query='+a.name+'">'+a.name+"</a>";case"MINT":return'<a TARGET="_blank" href="http://mint.bio.uniroma2.it/mint/search/search.do?queryType=protein&interactorAc='+a.name+'">'+a.name+"</a>";case"DIP":return'<a TARGET="_blank" href="http://dip.doe-mbi.ucla.edu/dip/Browse.cgi?ID='+a.name+'">'+a.name+"</a>";case"STRING":return'<a TARGET="_blank" href="http://string-db.org/newstring_cgi/show_network_section.pl?identifier=P51587">'+a.name+"</a>";case"MIM":return'<a TARGET="_blank" href="http://www.omim.org/entry/'+a.name+'">'+a.name+"</a>";case"PHARMGKB":return'<a TARGET="_blank" href="http://www.pharmgkb.org/do/serve?objId='+a.name+'&objCls=Gene">'+a.name+"</a>";case"ORPHANET":return'<a TARGET="_blank" href="http://www.orpha.net/consor/cgi-bin/OC_Exp.php?lng=EN&Expert='+a.name+'">'+a.name+"</a>"}}})},InfoWidget.prototype.getSnpTranscriptTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{[this.getStableId(values)]}</span></span>',' &nbsp; <a target="_blank" href="http://www.ensembl.org/'+this.ensemblSpecie+'/Transcript/Transcript?t={[this.getStableId(values)]}">Ensembl</a>',"</div><br>",'<div><span class="w140 infokey s90">CDS &nbsp; (start - end): </span> {cdsStart} - {cdsEnd} <span style="margin-left:50px" class="w100 infokey s90">cDNA (start - end): </span> {cdnaStart} - {cdnaEnd}</div>','<div><span class="w140 infokey s90">Translation (start - end): </span> {translationStart} - {translationEnd}</div>','<div><span class="w140 infokey s90">Peptide allele: </span> {peptideAlleleString}</div>','<div><span class="w140 infokey s90">Codon: </span> {codonAlleleString}</div>','<div><span class="w140 infokey s90">HGVS Genomic: </span> {hgvsGenomic}','<div><span class="w140 infokey s90">HGVS Protein: </span> {hgvsProtein}','<div><span class="w140 infokey s90">HGVS Transcript: </span> {hgvsTranscript}','<div><span class="w140 infokey s90">Polyphen prediction: </span> {polyphenPrediction}','<span style="margin-left:50px" class="w140 infokey s90">Polyphen score: </span> {polyphenScore}</div>','<div><span class="w140 infokey s90">Sift prediction: </span> {siftPrediction}','<span style="margin-left:50px" class="w140 infokey s90">Sift score: </span> {siftScore}</div>','<div><span class="w140 infokey s90">SO consequence types: </span> {consequenceTypes}</div><br>',{getStableId:function(a){return""!=a.transcriptId?a.transcriptId:"Intergenic SNP"}})},InfoWidget.prototype.getConsequenceTypeTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{transcriptId}</span> &nbsp; </span></div><br>','<div><span class="w140 infokey s90">SO consequence types: </span> {consequenceTypes}</div><br>')},InfoWidget.prototype.getPhenotypeTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{phenotypeDescription}</span> &nbsp; <span class="emph s120"> {source} </span></span></div><br>','<div><span class="w150 infokey s90">PValue: </span>{PValue}</div>','<div><span class="w150 infokey s90">Assoc. gene name: </span>{associatedGeneName}</div>','<div><span class="w150 infokey s90">Assoc. variant risk allele: </span>{associatedVariantRiskAllele}</div>','<div><span class="w150 infokey s90">Phenotype description: </span>{phenotypeDescription}</div>','<div><span class="w150 infokey s90">Phenotype name: </span>{phenotypeName}</div>','<div><span class="w150 infokey s90">Risk allele freq in controls: </span>{riskAlleleFrequencyInControls}</div>','<div><span class="w150 infokey s90">Source: </span>{source}</div>','<div><span class="w150 infokey s90">Study name: </span>{studyName}</div>','<div><span class="w150 infokey s90">Study type: </span>{studyType}</div>','<div><span class="w150 infokey s90">Study URL: </span>{studyUrl}</div>','<div><span class="w150 infokey s90">Study description: </span>{studyDescription}</div>')},InfoWidget.prototype.getPopulationTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{population}</span> &nbsp; <span class="emph s120"> {source} </span></span></div><br>','<div><span class="w140 infokey s90">Ref allele:  </span>{refAllele} ({refAlleleFrequency})</div>','<div><span class="w140 infokey s90">Other allele:  </span>{otherAllele} ({otherAlleleFrequency})</div>','<div><span class="w140 infokey s90">Ref allele homozygote:  </span>{refAlleleHomozygote} ({refAlleleHomozygoteFrequency})</div>','<div><span class="w140 infokey s90">Allele heterozygote:  </span>{alleleHeterozygote} ({alleleHeterozygoteFrequency})</div>','<div><span class="w140 infokey s90">Other allele homozygote:  </span>{otherAlleleHomozygote} ({otherAlleleHeterozygoteFrequency})</div>','<div><span class="w140 infokey s90">Source:  </span>{source}</div>','<div><span class="w140 infokey s90">Population:  </span>{population}</div>')},InfoWidget.prototype.getVariantEffectTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{consequenceTypeObo}</span> &nbsp; <span class="emph s120"> {featureBiotype} </span></span></div><br>')},GeneInfoWidget.prototype.draw=InfoWidget.prototype.draw,GeneInfoWidget.prototype.render=InfoWidget.prototype.render,GeneInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,GeneInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,GeneInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,GeneInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,GeneInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,GeneInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Transcripts"},{text:"Xrefs"}]},{text:"Functional information",children:[{text:"GO"},{text:"Reactome"},{text:"Interpro"}]},{text:"Regulatory",children:[{text:"TFBS"}]},{text:"Protein",children:[{text:"Features"},{text:"3D structure"}]}]},GeneInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getGenePanel(this.data).show());break;case"Transcripts":this.panel.add(this.getTranscriptPanel(this.data.transcripts).show());break;case"Xrefs":this.panel.add(this.getXrefGrid(this.data.transcripts,"Xref","transcript").show());break;case"GO":this.panel.add(this.getXrefGrid(this.data.transcripts,"GO","transcript").show());break;case"Interpro":this.panel.add(this.getXrefGrid(this.data.transcripts,"Interpro","transcript").show());break;case"Reactome":this.panel.add(this.getXrefGrid(this.data.transcripts,"Reactome","transcript").show());break;case"TFBS":this.panel.add(this.getTfbsGrid(this.data.transcripts).show());break;case"miRNA targets":this.panel.add(this.getMirnaTargetGrid(this.data.mirnaTargets).show());break;case"Features":this.panel.add(this.getProteinFeaturesGrid(this.data.proteinFeatures).show());break;case"3D structure":this.panel.add(this.get3Dprotein(this.data.snps).show())}},GeneInfoWidget.prototype.getGenePanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.genePanel){var b=this.getGeneTemplate();this.genePanel=Ext.create("Ext.panel.Panel",{title:"Gene information",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:10,data:a,tpl:b})}return this.genePanel},GeneInfoWidget.prototype.getTranscriptPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.transcriptGrid){for(var b=this.getTranscriptTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.transcriptGrid=Ext.create("Ext.panel.Panel",{title:"Transcripts ("+d+")",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.transcriptGrid},GeneInfoWidget.prototype.getXrefGrid=function(a,b,c){for(var d=[],e=0;e<a.length;e++)for(var f=0;f<a[e].xrefs.length;f++){var g=a[e].xrefs[f];if("Xref"==b){var h=g.dbNameShort.toLowerCase();"go"!=h&&"interpro"!=h&&"reactome"!=h&&(g.transcript=a[e].id,d.push(g))}else g.dbNameShort.toLowerCase()==b.toLowerCase()&&(g.transcript=a[e].id,d.push(g))}if(d.length<=0)return this.notFoundPanel;if(null==this[b+"Grid"]){var c=c,i=b,j=["description","id","dbName","transcript"],k=[{header:"Display Id",dataIndex:"id",flex:1},{header:"DB name",dataIndex:"dbName",flex:1},{header:"Description",dataIndex:"description",flex:3}];this[b+"Grid"]=this.doGrid(k,j,i,c),this[b+"Grid"].store.loadData(d)}return this[b+"Grid"]},GeneInfoWidget.prototype.getTfbsGrid=function(a){if(a.length<=0)return this.notFoundPanel;var b="";if(null!=a[0].id){var c=[];b="transcriptId";for(var d=0;d<a.length;d++)if(transcript=a[d],null!=transcript.tfbs){for(var e=0;e<transcript.tfbs.length;e++)transcript.tfbs[e].transcriptId=transcript.id;c=c.concat(transcript.tfbs)}a=c}if(null==this.tfbsGrid){var b=b,f="TFBS",g=["chromosome","start","end","strand","tfName","relativeStart","relativeEnd","targetGeneName","score","sequence","transcriptId"],h=[{header:"Name",dataIndex:"tfName",flex:1},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2.5},{header:"Relative (start-end)",xtype:"templatecolumn",tpl:"{relativeStart}-{relativeEnd}",flex:1.5},{header:"Target gene",dataIndex:"targetGeneName",flex:1},{header:"Score",dataIndex:"score",flex:1},{header:"Sequence",dataIndex:"sequence",flex:1}];this.tfbsGrid=this.doGrid(h,g,f,b),this.tfbsGrid.store.loadData(a)}return this.tfbsGrid},GeneInfoWidget.prototype.getMirnaTargetGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.mirnaTargetGrid){var b="",c="miRNA targets",d=["chromosome","start","end","strand","mirbaseId","score","experimentalMethod","source"],e=[{header:"Id",dataIndex:"mirbaseId",flex:1},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2},{header:"Score",dataIndex:"score",flex:1},{header:"Exp. Method",dataIndex:"experimentalMethod",flex:1},{header:"source",dataIndex:"source",flex:1}];this.mirnaTargetGrid=this.doGrid(e,d,c,b),this.mirnaTargetGrid.store.loadData(a)}return this.mirnaTargetGrid},GeneInfoWidget.prototype.getProteinFeaturesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.proteinFeaturesGrid){var b="",c="Protein features",d=["identifier","start","end","original","type","description"],e=[{header:"Identifier",dataIndex:"identifier",flex:1},{header:"Location: (start-end)",xtype:"templatecolumn",tpl:"{start}-{end}",flex:1.2},{header:"Original",dataIndex:"original",flex:1},{header:"Type",dataIndex:"type",flex:1},{header:"Description",dataIndex:"description",flex:1.5}];this.proteinFeaturesGrid=this.doGrid(e,d,c,b),this.proteinFeaturesGrid.store.loadData(a)}return this.proteinFeaturesGrid},GeneInfoWidget.prototype.getProteinFeaturesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.proteinFeaturesGrid){var b="",c="Protein features",d=["identifier","start","end","original","type","description"],e=[{header:"Identifier",dataIndex:"identifier",flex:1},{header:"Location: (start-end)",xtype:"templatecolumn",tpl:"{start}-{end}",flex:1.2},{header:"Original",dataIndex:"original",flex:1},{header:"Type",dataIndex:"type",flex:1},{header:"Description",dataIndex:"description",flex:1.5}];this.proteinFeaturesGrid=this.doGrid(e,d,c,b),this.proteinFeaturesGrid.store.loadData(a)}return this.proteinFeaturesGrid},GeneInfoWidget.prototype.get3Dprotein=function(){var a=this;if(null==this.p3dProtein){this.p3dProtein=Ext.create("Ext.tab.Panel",{title:"3D Protein Viewer",border:!1,cls:"ocb-border-left-lightgrey",flex:3,autoScroll:!0});var b=[];$.ajax({url:(new CellBaseManager).host+"/v3/"+a.species+"/feature/id/"+this.query+"/xref?dbname=pdb&of=json",async:!1,success:function(c){if(""!=c){b=c[0];for(var d=0;d<b.length;d++){var e=b[d].id,f=Ext.create("Ext.panel.Panel",{title:e,bodyCls:"background-black",html:'<canvas class="ChemDoodleWebComponent" id="pdb_canvas_'+e+'" width="600" height="600" style="width: 600px; height: 600px; ">This browser does not support HTML5/Canvas.</canvas>',listeners:{afterrender:function(a){var b=a.title;ChemDoodle.default_backgroundColor="#000000";var c=new ChemDoodle.TransformCanvas3D("pdb_canvas_"+b,300,300);c.gl?(c.specs.set3DRepresentation("Ball and Stick"),c.specs.proteins_ribbonCartoonize=!0,c.handle=null,c.timeout=15,c.startAnimation=ChemDoodle._AnimatorCanvas.prototype.startAnimation,c.stopAnimation=ChemDoodle._AnimatorCanvas.prototype.stopAnimation,c.isRunning=ChemDoodle._AnimatorCanvas.prototype.isRunning,c.dblclick=ChemDoodle.RotatorCanvas.prototype.dblclick,c.nextFrame=function(a){var b=[];mat4.identity(b);var c=a/1e3,d=Math.PI/15;mat4.rotate(b,d*c,[1,0,0]),mat4.rotate(b,d*c,[0,1,0]),mat4.rotate(b,d*c,[0,0,1]),mat4.multiply(this.rotationMatrix,b)},$.get("http://www.rcsb.org/pdb/files/"+b+".pdb",function(a){var b=ChemDoodle.readPDB(a);c.loadMolecule(b),c.startAnimation()})):(c.emptyMessage="Your browser does not support WebGL",c.displayMessage())}}});a.p3dProtein.add(f)}}else a.p3dProtein.setTitle("No proteins found")}})}return this.p3dProtein},GeneInfoWidget.prototype.getEnsembleId=function(){},GeneInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information..."),CellBaseManager.get({species:this.species,category:"feature",subCategory:"gene",query:this.query,resource:"info",success:function(b){a.dataReceived(b.response[0].result[0])}})},GeneInfoWidget.prototype.dataReceived=function(a){this.data=a,console.log(this.data),this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},GeneOrangeInfoWidget.prototype.draw=InfoWidget.prototype.draw,GeneOrangeInfoWidget.prototype.render=InfoWidget.prototype.render,GeneOrangeInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,GeneOrangeInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,GeneOrangeInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,GeneOrangeInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,GeneOrangeInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,GeneOrangeInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Transcripts"}]},{text:"Functional information",children:[{text:"GO"},{text:"KEGG"},{text:"Interpro"}]}]},GeneOrangeInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getGenePanel(this.data).show());break;case"Transcripts":this.panel.add(this.getTranscriptPanel(this.data.transcripts).show());break;case"GO":this.panel.add(this.getXrefGrid(this.data.go,"GO").show());break;case"Interpro":this.panel.add(this.getXrefGrid(this.data.interpro,"Interpro").show());break;case"KEGG":this.panel.add(this.getXrefGrid(this.data.kegg,"KEGG").show())}},GeneOrangeInfoWidget.prototype.getGenePanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.genePanel){var b=this.getGeneTemplate();this.genePanel=Ext.create("Ext.panel.Panel",{title:"Gene information",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,data:a,tpl:b})}return this.genePanel},GeneOrangeInfoWidget.prototype.getTranscriptPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.transcriptGrid){for(var b=this.getTranscriptTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.transcriptGrid=Ext.create("Ext.panel.Panel",{title:"Transcripts ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.transcriptGrid},GeneOrangeInfoWidget.prototype.getXrefGrid=function(a,b){if(a.length<=0)return this.notFoundPanel;if(null==this[b+"Grid"]){var c="",d=b,e=["description","displayId"],f=[{header:"Display Id",dataIndex:"displayId",flex:1},{header:"Description",dataIndex:"description",flex:3}];this[b+"Grid"]=this.doGrid(f,e,d,c),this[b+"Grid"].store.loadData(a)}return this[b+"Grid"]},GeneOrangeInfoWidget.prototype.getTfbsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.tfbsGrid){var b="",c="TFBS",d=["chromosome","start","end","strand","tfName","relativeStart","relativeEnd","targetGeneName","score","sequence"],e=[{header:"Name",dataIndex:"tfName",flex:1},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2.5},{header:"Relative (start-end)",xtype:"templatecolumn",tpl:"{relativeStart}-{relativeEnd}",flex:1.5},{header:"Target gene",dataIndex:"targetGeneName",flex:1},{header:"Score",dataIndex:"score",flex:1},{header:"Sequence",dataIndex:"sequence",flex:1}];this.tfbsGrid=this.doGrid(e,d,c,b),this.tfbsGrid.store.loadData(a)}return this.tfbsGrid},GeneOrangeInfoWidget.prototype.getMirnaTargetGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.mirnaTargetGrid){var b="",c="miRNA targets",d=["chromosome","start","end","strand","mirbaseId","score","experimentalMethod","source"],e=[{header:"Id",dataIndex:"mirbaseId",flex:1},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2},{header:"Score",dataIndex:"score",flex:1},{header:"Exp. Method",dataIndex:"experimentalMethod",flex:1},{header:"source",dataIndex:"source",flex:1}];this.mirnaTargetGrid=this.doGrid(e,d,c,b),this.mirnaTargetGrid.store.loadData(a)}return this.mirnaTargetGrid},GeneOrangeInfoWidget.prototype.getProteinFeaturesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.proteinFeaturesGrid){var b="",c="Protein features",d=["identifier","start","end","original","type","description"],e=[{header:"Identifier",dataIndex:"identifier",flex:1},{header:"Location: (start-end)",xtype:"templatecolumn",tpl:"{start}-{end}",flex:1.2},{header:"Original",dataIndex:"original",flex:1},{header:"Type",dataIndex:"type",flex:1},{header:"Description",dataIndex:"description",flex:1.5}];
this.proteinFeaturesGrid=this.doGrid(e,d,c,b),this.proteinFeaturesGrid.store.loadData(a)}return this.proteinFeaturesGrid},GeneOrangeInfoWidget.prototype.getProteinFeaturesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.proteinFeaturesGrid){var b="",c="Protein features",d=["identifier","start","end","original","type","description"],e=[{header:"Identifier",dataIndex:"identifier",flex:1},{header:"Location: (start-end)",xtype:"templatecolumn",tpl:"{start}-{end}",flex:1.2},{header:"Original",dataIndex:"original",flex:1},{header:"Type",dataIndex:"type",flex:1},{header:"Description",dataIndex:"description",flex:1.5}];this.proteinFeaturesGrid=this.doGrid(e,d,c,b),this.proteinFeaturesGrid.store.loadData(a)}return this.proteinFeaturesGrid},GeneOrangeInfoWidget.prototype.get3Dprotein=function(){var a=this;if(null==this.p3dProtein){this.p3dProtein=Ext.create("Ext.tab.Panel",{title:"3D Protein Viewer",border:!1,cls:"panel-border-left",flex:3,autoScroll:!0});var b=[];$.ajax({url:"http://ws.bioinfo.cipf.es/cellbase/rest/v1/hsa/feature/id/"+this.query+"/xref?dbname=pdb",async:!1,success:function(c){if(""!=c){b=c.trim().split("\n");for(var d=0;d<b.length;d++){var e=b[d].trim(),f=Ext.create("Ext.panel.Panel",{title:e,bodyCls:"background-black",html:'<canvas class="ChemDoodleWebComponent" id="pdb_canvas_'+e+'" width="600" height="600" style="width: 600px; height: 600px; ">This browser does not support HTML5/Canvas.</canvas>',listeners:{afterrender:function(a){var b=a.title;ChemDoodle.default_backgroundColor="#000000";var c=new ChemDoodle.TransformCanvas3D("pdb_canvas_"+b,300,300);c.gl?(c.specs.set3DRepresentation("Ball and Stick"),c.specs.proteins_ribbonCartoonize=!0,c.handle=null,c.timeout=15,c.startAnimation=ChemDoodle._AnimatorCanvas.prototype.startAnimation,c.stopAnimation=ChemDoodle._AnimatorCanvas.prototype.stopAnimation,c.isRunning=ChemDoodle._AnimatorCanvas.prototype.isRunning,c.dblclick=ChemDoodle.RotatorCanvas.prototype.dblclick,c.nextFrame=function(a){var b=[];mat4.identity(b);var c=a/1e3,d=Math.PI/15;mat4.rotate(b,d*c,[1,0,0]),mat4.rotate(b,d*c,[0,1,0]),mat4.rotate(b,d*c,[0,0,1]),mat4.multiply(this.rotationMatrix,b)},$.get("http://www.rcsb.org/pdb/files/"+b+".pdb",function(a){var b=ChemDoodle.readPDB(a);c.loadMolecule(b),c.startAnimation()})):(c.emptyMessage="Your browser does not support WebGL",c.displayMessage())}}});a.p3dProtein.add(f)}}else a.p3dProtein.setTitle("No proteins found")}})}return this.p3dProtein},GeneOrangeInfoWidget.prototype.getEnsembleId=function(){},GeneOrangeInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseManager(this.species);b.success.addEventListener(function(b,c){a.dataReceived(JSON.parse(c.result))}),b.get("feature","gene",this.query,"fullinfo")},GeneOrangeInfoWidget.prototype.dataReceived=function(a){this.data=a[0][0],console.log(this.data),this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},MirnaInfoWidget.prototype.draw=InfoWidget.prototype.draw,MirnaInfoWidget.prototype.render=InfoWidget.prototype.render,MirnaInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,MirnaInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,MirnaInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,MirnaInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,MirnaInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,MirnaInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Information",children:[{text:"miRNA"},{text:"Transcript"},{text:"Gene"}]},{text:"Regulatory",children:[{text:"Target Genes"}]},{text:"Disease",children:[{text:"Related Diseases"}]}]},MirnaInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"miRNA":this.panel.add(this.getMirnaPanel(this.data.mirna).show());break;case"Transcript":this.panel.add(this.getTranscriptPanel(this.data.transcripts).show());break;case"Gene":this.panel.add(this.getGenePanel(this.data.genes).show());break;case"Target Genes":this.panel.add(this.getTargetGenesGrid(this.data.targetGenes).show());break;case"Related Diseases":this.panel.add(this.getMirnaDiseasesGrid(this.data.mirnaDiseases).show())}},MirnaInfoWidget.prototype.getMirnaPanel=function(a){if(a.mirnaMature.length<=0&&a.mirnaGenes.length<=0)return this.notFoundPanel;if(null==this.mirnaPanel){for(var b=this.getMirnaMatureTemplate(),c=this.getMirnaGeneTemplate(),d=[],e=0;e<a.mirnaMature.length;e++){var f=Ext.create("Ext.container.Container",{padding:5,data:a.mirnaMature[e],tpl:b});d.push(f)}for(var e=0;e<a.mirnaGenes.length;e++){var g=Ext.create("Ext.container.Container",{padding:5,data:a.mirnaGenes[e],tpl:c});d.push(g)}this.mirnaPanel=Ext.create("Ext.panel.Panel",{title:"miRNA",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:d})}return this.mirnaPanel},MirnaInfoWidget.prototype.getTranscriptPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.transcriptGrid){for(var b=this.getTranscriptTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.transcriptGrid=Ext.create("Ext.panel.Panel",{title:"Transcripts ("+d+")",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.transcriptGrid},MirnaInfoWidget.prototype.getGenePanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.genePanel){for(var b=this.getGeneTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.genePanel=Ext.create("Ext.panel.Panel",{title:"Genes ("+d+")",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.genePanel},MirnaInfoWidget.prototype.getTargetGenesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.targetGenesGrid){var b="",c="targetGenes",d=["externalName","stableId","biotype","chromosome","start","end","strand","description"],e=[{header:"Name",dataIndex:"externalName",flex:1},{header:"Stable Id",dataIndex:"stableId",flex:2},{header:"Biotype",dataIndex:"biotype",flex:1.5},{header:"Chr",dataIndex:"chromosome",flex:.5},{header:"Start",dataIndex:"start",flex:1},{header:"End",dataIndex:"end",flex:1},{header:"Strand",dataIndex:"strand",flex:.5},{header:"Description",dataIndex:"description",flex:1}];this.targetGenesGrid=this.doGrid(e,d,c,b),this.targetGenesGrid.store.loadData(a)}return this.targetGenesGrid},MirnaInfoWidget.prototype.getMirnaDiseasesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.mirnaDiseasesGrid){var b="",c="mirnaDiseases",d=["mirnaDiseaseId","mirnaGene","mirbaseId","diseaseName","pubmedId","description"],e=[{header:"Name",dataIndex:"mirbaseId",flex:1.5},{header:"Disease",dataIndex:"diseaseName",flex:1.5},{header:"PubMed id",dataIndex:"pubmedId",flex:1},{header:"Description",dataIndex:"description",flex:3}];this.mirnaDiseasesGrid=this.doGrid(e,d,c,b),this.mirnaDiseasesGrid.store.loadData(a)}return this.mirnaDiseasesGrid},MirnaInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseDataAdapter(this.species);b.successed.addEventListener(function(){a.dataReceived(b.toJSON())}),b.fill("regulatory","mirna_mature",this.feature.getName(),"fullinfo"),console.log(this.feature.getName())},MirnaInfoWidget.prototype.dataReceived=function(a){var b=JSON.parse(a);this.data=b[0],console.log(this.data),this.optionClick({text:"miRNA",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},MirnaInfoWidget.prototype.getMirnaMatureTemplate=function(){return new Ext.XTemplate('<p><span class="panel-border-bottom"><span class="ssel s130">miRNA mature</span> &nbsp; <span class="emph s120"> {mirbaseId} </span></span></p>',"<br>",'<p><span class="w140 dis s90">miRBase Accession: </span> <span class="">{mirbaseAcc}</span></p>','<span class="w140 dis s90">Sequence: </span> <span class="">{sequence}</span>')},MirnaInfoWidget.prototype.getMirnaGeneTemplate=function(){return new Ext.XTemplate('<p><span class="panel-border-bottom"><span class="ssel s130">miRNA gene</span> &nbsp; <span class="emph s120"> {mirbaseId} </span></span></p>',"<br>",'<p><span class="w140 dis s90">miRBase Accession: </span> <span class="">{mirbaseAcc}</span></p>','<span class="w140 dis s90">Sequence: </span> <span class="">{sequence}</span>','<p><span class="w140 dis s90">Status: </span> <span class="">{status}</span></p>')},ProteinInfoWidget.prototype.draw=InfoWidget.prototype.draw,ProteinInfoWidget.prototype.render=InfoWidget.prototype.render,ProteinInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,ProteinInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,ProteinInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,ProteinInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Sumary",children:[{text:"Long"},{text:"Seq"}]},{text:"Functional information",children:[{text:"GO"},{text:"Reactome"},{text:"Interpro"}]},{text:"Interactions"},{text:"Variations"}]},ProteinInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"":break;case"":break;case"Reactome":break;case"Interpro":break;case"":break;case"":break;case"":}},SnpInfoWidget.prototype.draw=InfoWidget.prototype.draw,SnpInfoWidget.prototype.render=InfoWidget.prototype.render,SnpInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,SnpInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,SnpInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,SnpInfoWidget.prototype.getSnpTemplate=InfoWidget.prototype.getSnpTemplate,SnpInfoWidget.prototype.getSnpTranscriptTemplate=InfoWidget.prototype.getSnpTranscriptTemplate,SnpInfoWidget.prototype.getConsequenceTypeTemplate=InfoWidget.prototype.getConsequenceTypeTemplate,SnpInfoWidget.prototype.getPhenotypeTemplate=InfoWidget.prototype.getPhenotypeTemplate,SnpInfoWidget.prototype.getPopulationTemplate=InfoWidget.prototype.getPopulationTemplate,SnpInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Transcripts"}]},{text:"Consequence type"},{text:"Annotated phenotype"}]},SnpInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getInfoPanel(this.data).show());break;case"Transcripts":this.panel.add(this.getSnpTranscriptPanel(this.data.transcriptVariations).show());break;case"Consequence type":this.panel.add(this.getConsequenceTypePanel(this.data.transcriptVariations).show());break;case"Annotated phenotype":this.panel.add(this.getPhenotypePanel(this.data.phenotype).show())}},SnpInfoWidget.prototype.getInfoPanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.infoPanel){var b=this.getSnpTemplate();this.infoPanel=Ext.create("Ext.panel.Panel",{title:"Information",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:10,data:a,tpl:b})}return this.infoPanel},SnpInfoWidget.prototype.getSnpTranscriptPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.snpTranscriptGrid){for(var b=this.getSnpTranscriptTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.snpTranscriptGrid=Ext.create("Ext.panel.Panel",{title:"Transcripts ("+d+")",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.snpTranscriptGrid},SnpInfoWidget.prototype.getConsequenceTypePanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.consequencePanel){this.getConsequenceTypeTemplate();for(var b=[],c=0;c<a.length;c++)for(var d=0;d<a[c].consequenceTypes.length;d++){var e=a[c].consequenceTypes[d];a[c].consequenceType=e,b.push(a[c])}var f="consequenceType",g="transcriptVariation",h=["transcriptId","consequenceType"],i=[{header:"Transcript id",dataIndex:"transcriptId",flex:1},{header:"Consequence type",dataIndex:"consequenceType",flex:1}];this.consequencePanel=this.doGrid(i,h,g,f),this.consequencePanel.store.loadData(b)}return this.consequencePanel},SnpInfoWidget.prototype.getPhenotypePanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.phenotypePanel){for(var b=this.getPhenotypeTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.phenotypePanel=Ext.create("Ext.panel.Panel",{title:"Phenotype ("+d+")",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.phenotypePanel},SnpInfoWidget.prototype.getPopulationPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.populationPanel){for(var b=this.getPopulationTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.populationPanel=Ext.create("Ext.panel.Panel",{title:"Population ("+d+")",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.populationPanel},SnpInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information..."),CellBaseManager.get({species:this.species,category:"feature",subCategory:"snp",query:this.query,resource:"info",success:function(b){a.dataReceived(b.response[0].result[0])}})},SnpInfoWidget.prototype.dataReceived=function(a){this.data=a,console.log(this.data),this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},TFInfoWidget.prototype.draw=InfoWidget.prototype.draw,TFInfoWidget.prototype.render=InfoWidget.prototype.render,TFInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,TFInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,TFInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,TFInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,TFInfoWidget.prototype.getProteinTemplate=InfoWidget.prototype.getProteinTemplate,TFInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,TFInfoWidget.prototype.getPWMTemplate=InfoWidget.prototype.getPWMTemplate,TFInfoWidget.prototype.getProteinXrefTemplate=InfoWidget.prototype.getProteinXrefTemplate,TFInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Information",children:[{text:"Protein"},{text:"Transcript"},{text:"Gene"}]},{text:"Regulatory",children:[{text:"PWM"},{text:"Target Genes"}]},{text:"Protein Features",children:[{text:"Protein profile"},{text:"Mutation sites"},{text:"Pathways"},{text:"Protein interactions"},{text:"Related Diseases"}]}]},TFInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Protein":this.panel.add(this.getProteinPanel(this.data.proteins).show());break;case"Transcript":this.panel.add(this.getTranscriptPanel(this.data.transcripts).show());break;case"Gene":this.panel.add(this.getGenePanel(this.data.gene).show());break;case"PWM":this.panel.add(this.getPWMPanel(this.data.pwm).show());break;case"Target Genes":this.panel.add(this.getTargetGenesGrid(this.data.targetGenes).show());break;case"Protein profile":this.panel.add(this.getProteinFeatureGrid(this.data.protein_feature,"Protein profile").show());break;case"Mutation sites":this.panel.add(this.getProteinFeatureGrid(this.data.protein_feature,"Mutation sites").show());break;case"Pathways":this.panel.add(this.getProteinXrefPanel(this.data.protein_xref,"Pathway").show());break;case"Protein interactions":this.panel.add(this.getProteinXrefPanel(this.data.protein_xref,"Interaction").show());break;case"Related Diseases":this.panel.add(this.getProteinXrefPanel(this.data.protein_xref,"Disease").show())}},TFInfoWidget.prototype.getProteinPanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.proteinPanel){var b=this.getProteinTemplate();this.proteinPanel=Ext.create("Ext.panel.Panel",{title:"Protein",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:10,data:a[0],tpl:b})}return this.proteinPanel},TFInfoWidget.prototype.getTranscriptPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.transcriptGrid){for(var b=this.getTranscriptTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.transcriptGrid=Ext.create("Ext.panel.Panel",{title:"Transcripts ("+d+")",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.transcriptGrid},TFInfoWidget.prototype.getGenePanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.genePanel){var b=this.getGeneTemplate();this.genePanel=Ext.create("Ext.panel.Panel",{title:"Gene information",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:10,data:a,tpl:b})}return this.genePanel},TFInfoWidget.prototype.getPWMPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.pwmPanel){for(var b=this.getPWMTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.pwmPanel=Ext.create("Ext.panel.Panel",{title:"PWM ("+d+")",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.pwmPanel},TFInfoWidget.prototype.getTargetGenesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.targetGenesGrid){var b="",c="targetGenes",d=["externalName","stableId","biotype","chromosome","start","end","strand","description"],e=[{header:"Name",dataIndex:"externalName",flex:1},{header:"Stable Id",dataIndex:"stableId",flex:2},{header:"Biotype",dataIndex:"biotype",flex:1.5},{header:"Chr",dataIndex:"chromosome",flex:.5},{header:"Start",dataIndex:"start",flex:1},{header:"End",dataIndex:"end",flex:1},{header:"Strand",dataIndex:"strand",flex:.5},{header:"Description",dataIndex:"description",flex:1}];this.targetGenesGrid=this.doGrid(e,d,c,b),this.targetGenesGrid.store.loadData(a)}return this.targetGenesGrid},TFInfoWidget.prototype.getProteinFeatureGrid=function(a,b){if(null==this[b+"Grid"]){for(var c=new Array,d=new Array,e=0;e<a.length;e++)"mutagenesis site"==a[e].type?d.push(a[e]):c.push(a[e]);if(null!=b){if("Protein profile"==b)var a=c;if("Mutation sites"==b)var a=d}if(a.length<=0)return this.notFoundPanel;var f="",g=b,h=["type","start","end","original","variation","description"],i=[{header:"Type",dataIndex:"type",flex:1.5},{header:"Start",dataIndex:"start",flex:.5},{header:"End",dataIndex:"end",flex:.5},{header:"Original",dataIndex:"original",flex:.7},{header:"Variation",dataIndex:"variation",flex:.7},{header:"Description",dataIndex:"description",flex:3}];this[b+"Grid"]=this.doGrid(i,h,g,f),this[b+"Grid"].store.loadData(a)}return this[b+"Grid"]},TFInfoWidget.prototype.getProteinXrefPanel=function(a,b){if(a.length<=0)return this.notFoundPanel;if(null==this[b+"panel"]){for(var c=this.getProteinXrefTemplate(),d=new Array,e=new Array,f=new Array,g=0;g<a.length;g++){var h=a[g].source;("Go"==h||"Reactome"==h||"KEGG"==h)&&d.push(a[g]),("IntAct"==h||"MINT"==h||"DIP"==h||"String"==h)&&e.push(a[g]),("MIN"==h||"PharmGKB"==h||"Orphanet"==h)&&f.push(a[g])}if(null!=b)switch(b){case"Pathway":a=d;break;case"Interaction":a=e;break;case"Disease":a=f}for(var i=[],g=0;g<a.length;g++){var j=Ext.create("Ext.panel.Panel",{border:!1,bodyPadding:5,data:a[g],tpl:c});i.push(j)}this[b+"panel"]=Ext.create("Ext.panel.Panel",{title:b+" ("+g+")",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:i})}return this[b+"panel"]},TFInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseDataAdapter(this.species);b.successed.addEventListener(function(){a.dataReceived(b.toJSON())}),b.fill("regulatory","tf",this.feature.getName(),"fullinfo"),console.log(this.feature.getName())},TFInfoWidget.prototype.dataReceived=function(a){var b=JSON.parse(a);this.data=b[0],console.log(this.data),this.optionClick({text:"Protein",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},TranscriptInfoWidget.prototype.draw=InfoWidget.prototype.draw,TranscriptInfoWidget.prototype.render=InfoWidget.prototype.render,TranscriptInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,TranscriptInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,TranscriptInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,TranscriptInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,TranscriptInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,TranscriptInfoWidget.prototype.getExonTemplate=InfoWidget.prototype.getExonTemplate,TranscriptInfoWidget.prototype.get3Dprotein=GeneInfoWidget.prototype.get3Dprotein,TranscriptInfoWidget.prototype.getGenePanel=GeneInfoWidget.prototype.getGenePanel,TranscriptInfoWidget.prototype.getXrefGrid=GeneInfoWidget.prototype.getXrefGrid,TranscriptInfoWidget.prototype.getTfbsGrid=GeneInfoWidget.prototype.getTfbsGrid,TranscriptInfoWidget.prototype.getMirnaTargetGrid=GeneInfoWidget.prototype.getMirnaTargetGrid,TranscriptInfoWidget.prototype.getProteinFeaturesGrid=GeneInfoWidget.prototype.getProteinFeaturesGrid,TranscriptInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Gene"},{text:"Exons"},{text:"Xrefs"}]},{text:"Functional information",children:[{text:"GO"},{text:"Reactome"},{text:"Interpro"}]},{text:"Variation",children:[{text:"SNPs"},{text:"Mutations"}]},{text:"Regulatory",children:[{text:"TFBS"},{text:"miRNA targets"}]},{text:"Protein",children:[{text:"Features"},{text:"3D structure"}]}]},TranscriptInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getInfoPanel(this.data).show());break;case"Gene":this.panel.add(this.getGenePanel(this.data.gene).show());break;case"Exons":this.panel.add(this.getExonsGrid(this.data.exons).show());break;case"Xrefs":this.panel.add(this.getXrefGrid([this.data],"Xref","dbName").show());break;case"GO":this.panel.add(this.getXrefGrid([this.data],"GO").show());break;case"Interpro":this.panel.add(this.getXrefGrid([this.data],"Interpro").show());break;case"Reactome":this.panel.add(this.getXrefGrid([this.data],"Reactome").show());break;case"SNPs":this.panel.add(this.getSnpsGrid(this.data.snps).show());break;case"Mutations":this.panel.add(this.getMutationsGrid(this.data.mutations).show());break;case"TFBS":this.panel.add(this.getTfbsGrid(this.data.tfbs).show());break;case"miRNA targets":this.panel.add(this.getMirnaTargetGrid(this.data.mirnaTargets).show());break;case"Features":this.panel.add(this.getProteinFeaturesGrid(this.data.proteinFeatures).show());break;case"3D structure":this.panel.add(this.get3Dprotein(this.data.snps).show())}},TranscriptInfoWidget.prototype.getInfoPanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.infoPanel){var b=this.getTranscriptTemplate();this.infoPanel=Ext.create("Ext.panel.Panel",{title:"Information",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:10,autoScroll:!0,data:a,tpl:b})}return this.infoPanel},TranscriptInfoWidget.prototype.getExonsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.exonsGrid){for(var b=this.getExonTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.exonsGrid=Ext.create("Ext.panel.Panel",{title:"Exons ("+d+")",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.exonsGrid},TranscriptInfoWidget.prototype.getSnpsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.snpsGrid){var b="",c="SNPs",d=["chromosome","start","end","name","strand","alleleString","displaySoConsequence"],e=[{header:"Name",dataIndex:"name",flex:2},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2},{header:"Alleles",dataIndex:"alleleString",flex:.7},{header:"Most severe SO term",dataIndex:"displaySoConsequence",flex:2}];this.snpsGrid=this.doGrid(e,d,c,b),this.snpsGrid.store.loadData(a)}return this.snpsGrid},TranscriptInfoWidget.prototype.getMutationsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.mutationsGrid){var b="",c="Mutations",d=["chromosome","start","end","mutationAa","mutationCds","primaryHistology","source"],e=[{header:"Mutation AA",dataIndex:"mutationAa",flex:1},{header:"Mutation CDS",dataIndex:"mutationCds",flex:1.5},{header:"Location: chr:start-end",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end}",flex:1.7},{header:"Primary histology",dataIndex:"primaryHistology",flex:1},{header:"Source",dataIndex:"source",flex:1}];this.mutationsGrid=this.doGrid(e,d,c,b),this.mutationsGrid.store.loadData(a)}return this.mutationsGrid},TranscriptInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information..."),CellBaseManager.get({species:this.species,category:"feature",subCategory:"transcript",query:this.query,resource:"info",success:function(b){a.dataReceived(b.response[0].result[0].transcripts)}})},TranscriptInfoWidget.prototype.dataReceived=function(a){this.data=a,console.log(this.data),this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},TranscriptOrangeInfoWidget.prototype.draw=InfoWidget.prototype.draw,TranscriptOrangeInfoWidget.prototype.render=InfoWidget.prototype.render,TranscriptOrangeInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,TranscriptOrangeInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,TranscriptOrangeInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,TranscriptOrangeInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,TranscriptOrangeInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,TranscriptOrangeInfoWidget.prototype.getExonTemplate=InfoWidget.prototype.getExonTemplate,TranscriptOrangeInfoWidget.prototype.getGenePanel=GeneOrangeInfoWidget.prototype.getGenePanel,TranscriptOrangeInfoWidget.prototype.getXrefGrid=GeneOrangeInfoWidget.prototype.getXrefGrid,TranscriptOrangeInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Gene"},{text:"Exons"}]},{text:"Functional information",children:[{text:"GO"},{text:"KEGG"},{text:"Interpro"}]}]},TranscriptOrangeInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getInfoPanel(this.data).show());break;case"Gene":this.panel.add(this.getGenePanel(this.data.gene).show());break;case"Exons":this.panel.add(this.getExonsGrid(this.data.exons).show());break;case"GO":this.panel.add(this.getXrefGrid(this.data.go,"GO").show());break;case"Interpro":this.panel.add(this.getXrefGrid(this.data.interpro,"Interpro").show());break;case"KEGG":this.panel.add(this.getXrefGrid(this.data.kegg,"KEGG").show())}},TranscriptOrangeInfoWidget.prototype.getInfoPanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.infoPanel){var b=this.getTranscriptTemplate();this.infoPanel=Ext.create("Ext.panel.Panel",{title:"Information",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,autoScroll:!0,data:a,tpl:b})}return this.infoPanel},TranscriptOrangeInfoWidget.prototype.getExonsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.exonsGrid){for(var b=this.getExonTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.exonsGrid=Ext.create("Ext.panel.Panel",{title:"Exons ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.exonsGrid},TranscriptOrangeInfoWidget.prototype.getSnpsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.snpsGrid){var b="",c="SNPs",d=["chromosome","start","end","name","strand","alleleString","displaySoConsequence"],e=[{header:"Name",dataIndex:"name",flex:2},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2},{header:"Alleles",dataIndex:"alleleString",flex:.7},{header:"Most severe SO term",dataIndex:"displaySoConsequence",flex:2}];this.snpsGrid=this.doGrid(e,d,c,b),this.snpsGrid.store.loadData(a)}return this.snpsGrid},TranscriptOrangeInfoWidget.prototype.getMutationsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.mutationsGrid){var b="",c="Mutations",d=["chromosome","start","end","mutationAa","mutationCds","primaryHistology","source"],e=[{header:"Mutation AA",dataIndex:"mutationAa",flex:1},{header:"Mutation CDS",dataIndex:"mutationCds",flex:1.5},{header:"Location: chr:start-end",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end}",flex:1.7},{header:"Primary histology",dataIndex:"primaryHistology",flex:1},{header:"Source",dataIndex:"source",flex:1}];this.mutationsGrid=this.doGrid(e,d,c,b),this.mutationsGrid.store.loadData(a)}return this.mutationsGrid},TranscriptOrangeInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseManager(this.species);b.success.addEventListener(function(b,c){a.dataReceived(JSON.parse(c.result))}),b.get("feature","transcript",this.query,"fullinfo")},TranscriptOrangeInfoWidget.prototype.dataReceived=function(a){this.data=a[0],console.log(this.data),this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},VCFVariantInfoWidget.prototype.draw=InfoWidget.prototype.draw,VCFVariantInfoWidget.prototype.render=InfoWidget.prototype.render,VCFVariantInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,VCFVariantInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,VCFVariantInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,VCFVariantInfoWidget.prototype.getVCFVariantTemplate=InfoWidget.prototype.getVCFVariantTemplate,VCFVariantInfoWidget.prototype.getVariantEffectTemplate=InfoWidget.prototype.getVariantEffectTemplate,VCFVariantInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Variant effect"},{text:"Header"},{text:"Samples"}]}]},VCFVariantInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getInfoPanel(this.data.feature).show());break;case"Variant effect":this.panel.add(this.getEffectPanel(this.data.consequenceType).show());break;case"Header":this.panel.add(this.getHeaderPanel(this.data.header).show());break;case"Samples":this.panel.add(this.getSamplesGrid(this.data.feature.sampleData,this.data.samples,this.data.feature.format).show());break;case"Population":}},VCFVariantInfoWidget.prototype.getInfoPanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.infoPanel){var b=this.getVCFVariantTemplate();this.infoPanel=Ext.create("Ext.panel.Panel",{title:"Information",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:10,data:a,tpl:b})}return this.infoPanel},VCFVariantInfoWidget.prototype.getEffectPanel=function(a){if(a.length<=0)return this.notFoundPanel;for(var b=0;b<a.length;b++)a[b].consequence=a[b].consequenceType+" - "+a[b].consequenceTypeObo,""==a[b].featureName&&(a[b].featureName="-"),""==a[b].geneId&&(a[b].geneId="-"),""==a[b].transcriptId&&(a[b].transcriptId="-"),""==a[b].featureBiotype&&(a[b].featureBiotype="-"),""==a[b].aaPosition&&(a[b].aaPosition="-"),""==a[b].aminoacidChange&&(a[b].aminoacidChange="-");
if(null==this.effectGrid){var c="consequence",d="effectGridModel",e=["featureName","geneId","transcriptId","featureBiotype","aaPosition","aminoacidChange","consequence"],f=[{header:"Feature",dataIndex:"featureName",flex:1},{header:"Gene Id",dataIndex:"geneId",flex:1.5},{header:"Transcript Id",dataIndex:"transcriptId",flex:1.5},{header:"Feat.Biotype",dataIndex:"featureBiotype",flex:1},{header:"aa Position",dataIndex:"aaPosition",flex:1},{header:"aa Change",dataIndex:"aminoacidChange",flex:1}];this.effectGrid=this.doGrid(f,e,d,c),this.effectGrid.store.loadData(a)}return this.effectGrid},VCFVariantInfoWidget.prototype.getHeaderPanel=function(a){return""==a?this.notFoundPanel:(null==this.headerPanel&&(this.headerPanel=Ext.create("Ext.panel.Panel",{title:"Information",border:!1,cls:"ocb-border-left-lightgrey",flex:3,bodyPadding:10,html:a})),this.headerPanel)},VCFVariantInfoWidget.prototype.getSamplesGrid=function(a,b,c){var d=a.split("	").slice(9);if(d.length<=0)return this.notFoundPanel;for(var e=new Array(b.length),f=0,g=e.length;g>f;f++)e[f]={id:b[f],info:d[f]};if(null==this.samplesGrid){var h="",i="VCF samples",j=["id","info"],k=[{header:"Identifier",dataIndex:"id",flex:1},{header:c,dataIndex:"info",flex:5}];this.samplesGrid=this.doGrid(k,j,i,h),this.samplesGrid.store.loadData(e)}return this.samplesGrid},VCFVariantInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=this.feature.chromosome+":"+this.feature.start+":"+this.feature.reference+":"+this.feature.alternate;CellBaseManager.get({host:"http://ws-beta.bioinfo.cipf.es/cellbase/rest",version:"v2",species:Utils.getSpeciesCode(this.species.text).substring(0,3),category:"genomic",subCategory:"variant",query:b,resource:"consequence_type",success:function(b){a.dataReceived(b)}})},VCFVariantInfoWidget.prototype.dataReceived=function(a){this.data=new Object,this.data.header=this.adapter.header,this.data.samples=this.adapter.samples,this.data.feature=this.feature,this.data.consequenceType=a,this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},NavigationBar.prototype={render:function(a){var b=this;if(this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1)return console.log("targetId not found in DOM"),void 0;var c='<div class="btn-toolbar" role="toolbar">   <div class="btn-group btn-group-xs">       <button id="restoreDefaultRegionButton" class="btn btn-default" type="button"><span class="glyphicon glyphicon-repeat"></span></button>   </div>   <div class="btn-group btn-group-xs">       <button id="regionHistoryButton" class="btn btn-default dropdown-toggle" data-toggle="dropdown"  type="button" ><span class="glyphicon glyphicon-time"></span> <span class="caret"></button>       <ul id="regionHistoryMenu" class="dropdown-menu" role="menu">       </ul>   </div>   <div class="btn-group btn-group-xs">       <button id="speciesButton" class="btn btn-default dropdown-toggle" data-toggle="dropdown"  type="button" >           <span id="speciesText"></span>&nbsp;<span class="caret"></span>       </button>       <ul id="speciesMenu" class="dropdown-menu" role="menu">       </ul>   </div>   <div class="btn-group btn-group-xs">       <button id="chromosomesButton" class="btn btn-default dropdown-toggle" data-toggle="dropdown"  type="button" >           <span id="chromosomesText"></span>&nbsp;<span class="caret"></span>       </button>       <ul id="chromosomesMenu" class="dropdown-menu" role="menu">       </ul>   </div>   <div class="btn-group btn-group-xs" data-toggle="buttons">       <label id="karyotypeButton" class="btn btn-default"><input type="checkbox"><span class="ocb-icon ocb-icon-karyotype"></span></label>       <label id="chromosomeButton" class="btn btn-default"><input type="checkbox"><span class="ocb-icon ocb-icon-chromosome"></span></label>       <label id="regionButton" class="btn btn-default"><input type="checkbox"><span class="ocb-icon ocb-icon-region"></span></label>   </div>   <div class="btn-group btn-group-xs" style="margin:0px 0px 0px 15px;">       <button id="zoomOutButton" class="btn btn-default btn-xs" type="button"><span class="glyphicon glyphicon-minus"></span></button>       <div id="progressBarCont" class="progress pull-left" style="width:150px;height:10px;margin:5px 2px 0px 2px;background-color: #d5d5d5">           <div id="progressBar" class="progress-bar" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 100%">           </div>       </div>       <button id="zoomInButton" class="btn btn-default btn-xs" type="button"><span class="glyphicon glyphicon-plus"></span></button>   </div>   <div class="btn-group btn-group-xs" style="margin:0px 0px 0px 10px;">       <div class="pull-left" style="height:22px;line-height: 22px;font-size:14px;">Window size:&nbsp;</div>       <input id="windowSizeField" type="text" class="form-control pull-left" placeholder="Window size" style="padding:0px 4px;height:22px;width:75px">   </div>   <div class="btn-group" style="margin:0px 0px 0px 10px;">       <div class="pull-left" style="height:22px;line-height: 22px;font-size:14px;">Position:&nbsp;</div>       <div class="input-group pull-left">           <input id="regionField" type="text" class="form-control" placeholder="region..." style="padding:0px 4px;width:180px;height:22px">       </div>       <button id="goButton" class="btn btn-default btn-xs" type="button">Go!</button>   </div>   <div class="btn-group btn-group-xs">       <button id="moveFurtherLeftButton" class="btn btn-default" type="button"><span class="ocb-icon ocb-icon-arrow-w-bold"></span></button>       <button id="moveLeftButton" class="btn btn-default" type="button"><span class="ocb-icon ocb-icon-arrow-w"></span></button>       <button id="moveRightButton" class="btn btn-default" type="button"><span class="ocb-icon ocb-icon-arrow-e"></span></button>       <button id="moveFurtherRightButton" class="btn btn-default" type="button"><span class="ocb-icon ocb-icon-arrow-e-bold"></span></button>   </div>   <div class="btn-group btn-group-xs">       <button id="autoheightButton" class="btn btn-default" type="button"><span class="ocb-icon ocb-icon-track-autoheight"></span></button>   </div>    <div class="btn-group btn-group-xs">       <button id="compactButton" class="btn btn-default" type="button"><span class="ocb-icon glyphicon glyphicon-compressed"></span></button>   </div>   <div class="btn-group pull-right">       <div class="pull-left" style="height:22px;line-height: 22px;font-size:14px;">Search:&nbsp;</div>       <div class="input-group pull-left">           <input id="searchField" list="searchDataList" type="text" class="form-control" placeholder="gene, snp..." style="padding:0px 4px;height:22px;width:100px">           <datalist id="searchDataList">           </datalist>       </div>       <button id="quickSearchButton" class="btn btn-default btn-xs" type="button"><span class="glyphicon glyphicon-search"></span></button>   </div></div>';this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="navigation-bar" class="gv-navigation-bar unselectable">'+c+"</div>")[0],$(this.targetDiv).append(this.div),this.restoreDefaultRegionButton=$(this.div).find("#restoreDefaultRegionButton")[0],this.regionHistoryButton=$(this.div).find("#regionHistoryButton")[0],this.regionHistoryMenu=$(this.div).find("#regionHistoryMenu")[0],this.speciesButton=$(this.div).find("#speciesButton")[0],this.speciesText=$(this.div).find("#speciesText")[0],this.speciesMenu=$(this.div).find("#speciesMenu")[0],this.chromosomesButton=$(this.div).find("#chromosomesButton")[0],this.chromosomesText=$(this.div).find("#chromosomesText")[0],this.chromosomesMenu=$(this.div).find("#chromosomesMenu")[0],this.karyotypeButton=$(this.div).find("#karyotypeButton")[0],this.chromosomeButton=$(this.div).find("#chromosomeButton")[0],this.regionButton=$(this.div).find("#regionButton")[0],this.progressBar=$(this.div).find("#progressBar")[0],this.progressBarCont=$(this.div).find("#progressBarCont")[0],this.zoomOutButton=$(this.div).find("#zoomOutButton")[0],this.zoomInButton=$(this.div).find("#zoomInButton")[0],this.regionField=$(this.div).find("#regionField")[0],this.goButton=$(this.div).find("#goButton")[0],this.moveFurtherLeftButton=$(this.div).find("#moveFurtherLeftButton"),this.moveFurtherRightButton=$(this.div).find("#moveFurtherRightButton"),this.moveLeftButton=$(this.div).find("#moveLeftButton"),this.moveRightButton=$(this.div).find("#moveRightButton"),this.autoheightButton=$(this.div).find("#autoheightButton"),this.compactButton=$(this.div).find("#compactButton"),this.searchField=$(this.div).find("#searchField")[0],this.searchDataList=$(this.div).find("#searchDataList")[0],this.quickSearchButton=$(this.div).find("#quickSearchButton")[0],this.windowSizeField=$(this.div).find("#windowSizeField")[0],$(this.restoreDefaultRegionButton).click(function(a){b.trigger("restoreDefaultRegion:click",{clickEvent:a,sender:{}})}),this._addRegionHistoryMenuItem(this.region),this._setChromosomeMenu(),this._setSpeciesMenu(),$(this.chromosomesText).text(this.region.chromosome),$(this.speciesText).text(this.species.text),$(this.karyotypeButton).click(function(){b.trigger("karyotype-button:change",{selected:$(this).hasClass("active"),sender:b})}),$(this.chromosomeButton).click(function(){b.trigger("chromosome-button:change",{selected:$(this).hasClass("active"),sender:b})}),$(this.regionButton).click(function(){b.trigger("region-button:change",{selected:$(this).hasClass("active"),sender:b})}),$(this.zoomOutButton).click(function(){b._handleZoomOutButton()}),$(this.zoomInButton).click(function(){b._handleZoomInButton()}),$(this.progressBarCont).click(function(a){var c=a.clientX-$(this).offset().left;console.log("offsetX "+c),console.log("e.offsetX "+a.offsetX);var d=100/$(this).width()*c;b.zoomChanging||($(b.progressBar).width(c),b.zoomChanging=!0,setTimeout(function(){b._handleZoomSlider(d),b.zoomChanging=!1},500))}),$(this.regionField).val(this.region.toString()),$(this.goButton).click(function(){b._goRegion($(b.regionField).val())}),$(this.moveFurtherLeftButton).click(function(){b._handleMoveRegion(10)}),$(this.moveFurtherRightButton).click(function(){b._handleMoveRegion(-10)}),$(this.moveLeftButton).click(function(){b._handleMoveRegion(1)}),$(this.moveRightButton).click(function(){b._handleMoveRegion(-1)}),$(this.autoheightButton).click(function(a){b.trigger("autoHeight-button:click",{clickEvent:a,sender:b})}),$(this.compactButton).click(function(){$(".ocb-compactable").toggle()});var d="";$(this.searchField).bind("keyup",function(a){var c=$(this).val();if(c.length>3&&d!==c&&13!==a.which&&(b._setQuickSearchMenu(c),d=c),13===a.which){var e=b.quickSearchDataset[c];b.trigger("quickSearch:select",{item:e,sender:b})}}),$(this.quickSearchButton).click(function(){var a=$(this.searchField).val(),c=b.quickSearchDataset[a];b.trigger("quickSearch:go",{item:c,sender:b})}),$(this.windowSizeField).val(this.region.length()),$(this.windowSizeField).bind("keyup",function(a){var c=$(this).val(),d=/^([0-9])+$/;if(13===a.which&&d.test(c)){var e=parseInt(c),f=Math.floor(e/2),g=b.region.center()-f,h=b.region.center()+f;b.region.start=g,b.region.end=h,b.trigger("region:change",{region:b.region})}}),this.rendered=!0},_addRegionHistoryMenuItem:function(a){var b=this,c=$('<li role="presentation"><a tabindex="-1" role="menuitem">'+a.toString()+"</a></li>")[0];$(this.regionHistoryMenu).append(c),$(c).click(function(){b.region.parse($(this).text()),$(b.chromosomesText).text(b.region.chromosome),$(b.regionField).val(b.region.toString()),b.trigger("region:change",{region:b.region,sender:b}),console.log($(this).text())})},_setQuickSearchMenu:function(a){if("function"==typeof this.quickSearchResultFn){$(this.searchDataList).empty(),this.quickSearchDataset={};for(var b=this.quickSearchResultFn(a),c=0;c<b.length;c++){var d=b[c],e=d;"string"===$.type(this.quickSearchDisplayKey)&&(e=d[this.quickSearchDisplayKey]),this.quickSearchDataset[e]=d;var f=$('<option value="'+e+'">')[0];$(this.searchDataList).append(f)}}else console.log("the quickSearchResultFn function is not valid")},_setChromosomeMenu:function(){var a=this;$(this.chromosomesMenu).empty();var b=[];for(var c in this.availableSpecies.items)for(var d in this.availableSpecies.items[c].items){var e=this.availableSpecies.items[c].items[d];if(e.text===this.species.text){b=e.chromosomes;break}}this.currentChromosomeList=b;for(var c in b){var f=$('<li role="presentation"><a tabindex="-1" role="menuitem">'+b[c]+"</a></li>")[0];$(this.chromosomesMenu).append(f),$(f).click(function(){a.region.chromosome=$(this).text(),$(a.chromosomesText).text($(this).text()),$(a.regionField).val(a.region.toString()),a._addRegionHistoryMenuItem(a.region),a.trigger("region:change",{region:a.region,sender:a}),console.log($(this).text())})}},_setSpeciesMenu:function(){var a=this,b=function(b){var c=$('<li role="presentation"><a tabindex="-1" role="menuitem">'+b.text+"</a></li>")[0];$(a.speciesMenu).append(c),$(c).click(function(){a.species=b,$(a.speciesText).text($(this).text()),a._setChromosomeMenu(),a.trigger("species:change",{species:b,sender:a})})};for(var c in this.availableSpecies.items)for(var d in this.availableSpecies.items[c].items){var e=this.availableSpecies.items[c].items[d];b(e)}},_goRegion:function(a){var b=new Region;!b.parse(a)||b.start<0||b.end<0||-1==_.indexOf(this.currentChromosomeList,b.chromosome)?($(this.regionField).css({opacity:0}),$(this.regionField).animate({opacity:1},700)):(this.region.load(b),$(this.windowSizeField).val(this.region.length()),$(this.chromosomesText).text(this.region.chromosome),this._addRegionHistoryMenuItem(this.region),this.trigger("region:change",{region:this.region,sender:this}))},_handleZoomOutButton:function(){this._handleZoomSlider(Math.max(0,this.zoom-1))},_handleZoomSlider:function(a){this.zoom=a,this.trigger("zoom:change",{zoom:this.zoom,sender:this})},_handleZoomInButton:function(){this._handleZoomSlider(Math.min(100,this.zoom+1))},_handleMoveRegion:function(a){var b=(this.width-this.svgCanvasWidthOffset)/this.region.length(),c=Math.round(10*a/b);this.region.start-=c,this.region.end-=c,$(this.regionField).val(this.region.toString()),this.trigger("region:move",{region:this.region,disp:c,sender:this})},setVisible:function(a){for(key in a){var b=$(this.div).find("#"+key);a[key]?b.show():b.hide()}},setRegion:function(a){this.region.load(a),$(this.chromosomesText).text(this.region.chromosome),$(this.regionField).val(this.region.toString()),$(this.windowSizeField).val(this.region.length()),this._addRegionHistoryMenuItem(a)},moveRegion:function(a){this.region.load(a),$(this.chromosomesText).text(this.region.chromosome),$(this.regionField).val(this.region.toString())},setWidth:function(a){this.width=a},setZoom:function(a){this.zoom=a,$(this.progressBar).css("width",this.zoom+"%")},draw:function(){return this.rendered?void 0:(console.info(this.id+" is not rendered yet"),void 0)}},ChromosomePanel.prototype={show:function(){$(this.div).css({display:"block"})},hide:function(){$(this.div).css({display:"none"})},showContent:function(){$(this.svg).css({display:"inline"}),this.collapsed=!1,$(this.collapseDiv).removeClass("active"),$(this.collapseDiv).children().first().removeClass("glyphicon-plus"),$(this.collapseDiv).children().first().addClass("glyphicon-minus")},hideContent:function(){$(this.svg).css({display:"none"}),this.collapsed=!0,$(this.collapseDiv).addClass("active"),$(this.collapseDiv).children().first().removeClass("glyphicon-minus"),$(this.collapseDiv).children().first().addClass("glyphicon-plus")},setVisible:function(a){a?$(this.div).css({display:"block"}):$(this.div).css({display:"none"})},setTitle:function(a){"titleDiv"in this&&$(this.titleDiv).first().html(a)},setWidth:function(a){this.width=a,this.svg.setAttribute("width",a),this.clean(),this._drawSvg(this.data)},render:function(a){var b=this;return this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1?(console.log("targetId not found in DOM"),void 0):(this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="chromosome-panel"></div>')[0],$(this.targetDiv).append(this.div),"title"in this&&""!==this.title&&(this.titleDiv=$('<div id="tl-title" class="gv-panel-title unselectable"><span style="line-height: 24px;margin-left: 5px;">'+this.title+"</span></div>")[0],$(this.div).append(this.titleDiv),1==this.collapsible&&(this.collapseDiv=$('<div type="button" class="btn btn-default btn-xs" style="margin-left:10px;height:20px"><span class="glyphicon glyphicon-minus"></span></div>'),$(this.titleDiv).dblclick(function(){b.collapsed?b.showContent():b.hideContent()}),$(this.collapseDiv).click(function(){b.collapsed?b.showContent():b.hideContent()}),$(this.titleDiv).append(this.collapseDiv))),this.svg=SVG.init(this.div,{width:this.width,height:this.height}),$(this.div).addClass("unselectable"),this.colors={gneg:"#eeeeee",stalk:"#666666",gvar:"#CCCCCC",gpos25:"silver",gpos33:"lightgrey",gpos50:"gray",gpos66:"dimgray",gpos75:"darkgray",gpos100:"black",gpos:"gray",acen:"blue",clementina:"#ffc967"},this.rendered=!0,void 0)},setSpecies:function(a){this.species=a},clean:function(){$(this.svg).empty()},draw:function(){if(!this.rendered)return console.info(this.id+" is not rendered yet"),void 0;var a=this;this.clean(),CellBaseManager.get({species:this.species,category:"genomic",subCategory:"chromosome",query:this.region.chromosome,resource:"info",success:function(b){a.data=b.response[0].result.chromosomes,a.data.cytobands.sort(function(a,b){return a.start-b.start}),a._drawSvg(a.data)}}),this.lastChromosome=this.region.chromosome,this.collapsed&&a.hideContent()},_drawSvg:function(a){var b=this,c=20,d=SVG.addChild(b.svg,"g",{cursor:"pointer"});this.chromosomeLength=a.size,this.pixelBase=(this.width-40)/this.chromosomeLength,SVG.addChild(d,"rect",{x:c,y:4,width:this.width-40+1,height:22,fill:"#555555"});for(var e={},f=c,g=0;g<a.cytobands.length;g++){var h=a.cytobands[g];h.pixelStart=h.start*this.pixelBase,h.pixelEnd=h.end*this.pixelBase,h.pixelSize=h.pixelEnd-h.pixelStart,"undefined"==typeof e[h.stain]&&(e[h.stain]=[]),e[h.stain].push(h);var i=f+h.pixelSize/2,j=28,k=SVG.addChild(d,"text",{x:i,y:j,"font-size":10,transform:"rotate(90, "+i+", "+j+")",fill:"black"});k.textContent=h.name,f+=h.pixelSize}for(var l in e){var m="";if("acen"!=l){for(var n=0;n<e[l].length;n++){var h=e[l][n];m+="M"+(h.pixelStart+c+1)+",15"+" L"+(h.pixelEnd+c)+",15 "}SVG.addChild(d,"path",{d:m,stroke:this.colors[l],"stroke-width":20,fill:"none"})}}if("undefined"!=typeof e.acen){var o=e.acen[0],p=e.acen[1];SVG.addChild(d,"rect",{x:o.pixelStart+c+1,y:4,width:p.pixelEnd+c-(o.pixelStart+c+1),height:22,fill:"white"});var q=o.pixelStart+c+1,r=o.pixelEnd+c,s=p.pixelStart+c+1,t=p.pixelEnd+c;SVG.addChild(d,"path",{d:"M"+q+",4"+" L"+(r-5)+",4 "+" L"+r+",15 "+" L "+(r-5)+",26 "+" L "+q+",26 z",fill:this.colors.acen}),SVG.addChild(d,"path",{d:"M"+s+",15"+" L"+(s+5)+",4 "+" L"+t+",4 "+" L "+t+",26 "+" L "+(s+5)+",26 z",fill:this.colors.acen})}var u="",v=b.region.center(),w=v*b.pixelBase+c;$(this.svg).on("mousedown",function(){u="setRegion"});var x=SVG.addChild(this.svg,"rect",{x:0,y:2,"stroke-width":"2",stroke:"deepskyblue",opacity:"0.5",fill:"honeydew"}),y=b.region.length()*b.pixelBase,z=SVG.addChild(d,"g");this.positionBox=SVG.addChild(z,"rect",{x:w-y/2,y:2,width:y,height:b.height-3,stroke:"orangered","stroke-width":2,opacity:.5,fill:"navajowhite",cursor:"move"}),$(this.positionBox).on("mousedown",function(){u="movePositionBox"});var A=SVG.addChild(z,"rect",{x:w-y/2,y:2,width:5,height:b.height-3,opacity:.5,fill:"orangered",visibility:"hidden"});$(A).on("mousedown",function(){u="resizePositionBoxLeft"});var B=SVG.addChild(z,"rect",{x:y-5,y:2,width:5,height:b.height-3,opacity:.5,fill:"orangered",visibility:"hidden"});$(B).on("mousedown",function(){u="resizePositionBoxRight"}),$(this.positionBox).off("mouseenter"),$(this.positionBox).off("mouseleave");var C=function(){var a=parseInt(b.positionBox.getAttribute("x")),c=parseInt(b.positionBox.getAttribute("width"));A.setAttribute("x",a-5),B.setAttribute("x",a+c),$(A).css({cursor:"ew-resize"}),$(B).css({cursor:"ew-resize"})},D=function(){A.setAttribute("visibility","hidden"),B.setAttribute("visibility","hidden")},E=function(){A.setAttribute("visibility","visible"),B.setAttribute("visibility","visible")},F=function(){var a=b.region.length(),c=a*b.pixelBase,d=b.region.start*b.pixelBase+20;b.positionBox.setAttribute("x",d),b.positionBox.setAttribute("width",c)},G=function(a){return a.start=a.start<1?1:a.start,a.end=a.end>b.chromosomeLength?b.chromosomeLength:a.end,a};$(z).mouseenter(function(){C(),E()}),$(z).mouseleave(function(){D()}),$(this.svg).off("contextmenu"),$(this.svg).off("mousedown"),$(this.svg).off("mouseup"),$(this.svg).off("mousemove"),$(this.svg).off("mouseleave"),$(this.svg).contextmenu(function(a){a.preventDefault()});var H,I,J;$(this.svg).mousedown(function(a){H=a.clientX-$(this).parent().offset().left,x.setAttribute("x",H),J=b.positionBox.getAttribute("x"),""==u&&(u="setRegion"),D(),$(this).mousemove(function(a){switch(I=a.clientX-$(this).parent().offset().left,D(),u){case"resizePositionBoxLeft":var c=I-H,d=parseInt(b.positionBox.getAttribute("width"))-c;d>0&&(b.positionBox.setAttribute("x",parseInt(b.positionBox.getAttribute("x"))+c),b.positionBox.setAttribute("width",d)),H=I;break;case"resizePositionBoxRight":var c=I-H,d=parseInt(b.positionBox.getAttribute("width"))+c;d>0&&b.positionBox.setAttribute("width",d),H=I;break;case"movePositionBox":var c=I-H;b.positionBox.setAttribute("x",parseInt(b.positionBox.getAttribute("x"))+c),H=I;break;case"setRegion":case"selectingRegion":u="selectingRegion",H>I&&x.setAttribute("x",I),x.setAttribute("width",Math.abs(I-H)),x.setAttribute("height",b.height-3)}})}),$(this.svg).mouseup(function(){if($(this).off("mousemove"),null!=H){switch(u){case"resizePositionBoxLeft":case"resizePositionBoxRight":case"movePositionBox":if(null!=I){var a=parseInt(b.positionBox.getAttribute("width")),d=parseInt(b.positionBox.getAttribute("x")),e=d,f=d+a,g=(e-c)/b.pixelBase,h=(f-c)/b.pixelBase,i=G({start:g,end:h});b.region.start=Math.round(i.start),b.region.end=Math.round(i.end),F(),C(),E(),b.trigger("region:change",{region:b.region,sender:b}),C(),E()}break;case"setRegion":if(H>c&&H<b.width-c){var a=b.positionBox.getAttribute("width");b.positionBox.setAttribute("x",H-a/2);var e=H-a/2,f=H+a/2,g=(e-c)/b.pixelBase,h=(f-c)/b.pixelBase,i=G({start:g,end:h});b.region.start=Math.round(i.start),b.region.end=Math.round(i.end),F(),b.trigger("region:change",{region:b.region,sender:b})}break;case"selectingRegion":var g=(H-c)/b.pixelBase,h=(I-c)/b.pixelBase,j=Math.min(g,h),k=Math.max(g,h),i=G({start:j,end:k});b.region.start=parseInt(i.start),b.region.end=parseInt(i.end),F(),b.trigger("region:change",{region:b.region,sender:b})}u=""}x.setAttribute("width",0),x.setAttribute("height",0),H=null,I=null,J=b.positionBox.getAttribute("x")}),$(this.svg).mouseleave(function(){$(this).off("mousemove"),null!=J&&b.positionBox.setAttribute("x",J),x.setAttribute("width",0),x.setAttribute("height",0),H=null,I=null,J=null,overPositionBox=!1,movingPositionBox=!1,selectingRegion=!1})},setRegion:function(a){this.region.load(a);var b=!1;this.lastChromosome!=this.region.chromosome&&(b=!0);var c=this.region.length(),d=c*this.pixelBase,e=this.region.start*this.pixelBase+20;this.positionBox.setAttribute("x",e),this.positionBox.setAttribute("width",d),b&&this.draw()}},KaryotypePanel.prototype={show:function(){$(this.div).css({display:"block"})},hide:function(){$(this.div).css({display:"none"})},showContent:function(){$(this.svg).css({display:"inline"}),this.collapsed=!1,$(this.collapseDiv).removeClass("active"),$(this.collapseDiv).children().first().removeClass("glyphicon-plus"),$(this.collapseDiv).children().first().addClass("glyphicon-minus")},hideContent:function(){$(this.svg).css({display:"none"}),this.collapsed=!0,$(this.collapseDiv).addClass("active"),$(this.collapseDiv).children().first().removeClass("glyphicon-minus"),$(this.collapseDiv).children().first().addClass("glyphicon-plus")},setVisible:function(a){a?$(this.div).css({display:"block"}):$(this.div).css({display:"none"})},setTitle:function(a){"titleDiv"in this&&$(this.titleDiv).children().first().html(a)},setWidth:function(a){this.width=a,this.svg.setAttribute("width",a),this.clean(),this._drawSvg(this.chromosomeList,this.data2)},render:function(a){var b=this;return this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1?(console.log("targetId not found in DOM"),void 0):(this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="karyotype-panel"></div>')[0],$(this.targetDiv).append(this.div),"title"in this&&""!==this.title&&(this.titleDiv=$('<div id="tl-title" class="gv-panel-title unselectable"><span style="line-height: 24px;margin-left: 5px;">'+this.title+"</span></div>")[0],$(this.div).append(this.titleDiv),1==this.collapsible&&(this.collapseDiv=$('<div type="button" class="btn btn-default btn-xs" style="margin-left:10px;height:20px"><span class="glyphicon glyphicon-minus"></span></div>'),$(this.titleDiv).dblclick(function(){b.collapsed?b.showContent():b.hideContent()}),$(this.collapseDiv).click(function(){b.collapsed?b.showContent():b.hideContent()}),$(this.titleDiv).append(this.collapseDiv))),this.svg=SVG.init(this.div,{width:this.width,height:this.height}),this.markGroup=SVG.addChild(this.svg,"g",{cursor:"pointer"}),$(this.div).addClass("unselectable"),this.colors={gneg:"white",stalk:"#666666",gvar:"#CCCCCC",gpos25:"silver",gpos33:"lightgrey",gpos50:"gray",gpos66:"dimgray",gpos75:"darkgray",gpos100:"black",gpos:"gray",acen:"blue"},this.rendered=!0,void 0)},setSpecies:function(a){this.lastSpecies=this.species,this.species=a},clean:function(){$(this.svg).empty()},draw:function(){if(!this.rendered)return console.info(this.id+" is not rendered yet"),void 0;var a=this;this.clean();var b=function(a,b){for(var c=!0,d=0;d<a.name.length&&1==c;d++)isNaN(a.name[d])&&(c=!1);return c?a.name-b.name:1};CellBaseManager.get({species:this.species,category:"genomic",subCategory:"chromosome",resource:"all",success:function(c){a.chromosomeList=c.response.result.chromosomes,a.chromosomeList.sort(b),a._drawSvg(a.chromosomeList)}}),this.collapsed&&a.hideContent()},_drawSvg:function(a){for(var b=this,c=20,d=b.width/a.length,e=2,f=0,g=0,h=a.length;h>g;g++){var i=a[g].size;i>f&&(f=i)}b.pixelBase=(b.height-10)/f,b.chrOffsetY={},b.chrOffsetX={};for(var g=0,h=a.length;h>g;g++){var j=a[g],k=j.size*b.pixelBase,l=e+f*b.pixelBase-k;b.chrOffsetY[j.name]=l;var m=!0,n=b.region.center(),o=n*b.pixelBase,p=SVG.addChild(b.svg,"g",{cursor:"pointer",chr:j.name});$(p).click(function(a){var c=this.getAttribute("chr"),d=a.pageY-$(b.svg).offset().top;b.positionBox.setAttribute("x1",b.chrOffsetX[c]-10),b.positionBox.setAttribute("x2",b.chrOffsetX[c]+23),b.positionBox.setAttribute("y1",d),b.positionBox.setAttribute("y2",d);var e=parseInt((d-b.chrOffsetY[c])/b.pixelBase);b.region.chromosome=c,b.region.start=e,b.region.end=e,b.trigger("region:change",{region:b.region,sender:b})});for(var q=0,r=j.cytobands.length;r>q;q++){var s=j.cytobands[q],t=b.pixelBase*(s.end-s.start),u=13,v=b.colors[s.stain];if(null==v&&(v="purple"),"acen"==s.stain){var w="",x=c+u/2,y=l+t/2,z=c+u,A=l+t;m?(w=c+","+l+" "+z+","+l+" "+z+","+y+" "+x+","+A+" "+c+","+y,m=!1):w=c+","+A+" "+c+","+y+" "+x+","+l+" "+z+","+y+" "+z+","+A,SVG.addChild(p,"polyline",{points:w,stroke:"black",opacity:.8,fill:v})}else SVG.addChild(p,"rect",{x:c,y:l,width:u,height:t,stroke:"grey",opacity:.8,fill:v});l+=t}var B=SVG.addChild(b.svg,"text",{x:c+1,y:b.height,"font-size":9,fill:"black"});B.textContent=j.name,b.chrOffsetX[j.name]=c,c+=d}b.positionBox=SVG.addChild(b.svg,"line",{x1:b.chrOffsetX[b.region.chromosome]-10,y1:o+b.chrOffsetY[b.region.chromosome],x2:b.chrOffsetX[b.region.chromosome]+23,y2:o+b.chrOffsetY[b.region.chromosome],stroke:"orangered","stroke-width":2,opacity:.5}),b.rendered=!0,b.trigger("after:render",{sender:b})},setRegion:function(a){this.region.load(a);var b=!1;this.lastSpecies!=this.species&&(b=!0,this.lastSpecies=this.species);var c=this.region.center(),d=c*this.pixelBase+this.chrOffsetY[this.region.chromosome];this.positionBox.setAttribute("x1",this.chrOffsetX[this.region.chromosome]-10),this.positionBox.setAttribute("x2",this.chrOffsetX[this.region.chromosome]+23),this.positionBox.setAttribute("y1",d),this.positionBox.setAttribute("y2",d),b&&this.draw()},updatePositionBox:function(){this.positionBox.setAttribute("x1",this.chrOffsetX[this.region.chromosome]-10),this.positionBox.setAttribute("x2",this.chrOffsetX[this.region.chromosome]+23);var a=Utils.centerPosition(this.region),b=a*this.pixelBase+this.chrOffsetY[this.region.chromosome];this.positionBox.setAttribute("y1",b),this.positionBox.setAttribute("y2",b)},addMark:function(){var a=this,b=function(){if(null!=a.region.chromosome&&null!=a.region.start&&null!=a.chrOffsetX[a.region.chromosome]){var b=a.chrOffsetX[a.region.chromosome]-10,c=a.chrOffsetX[a.region.chromosome],d=a.region.start*a.pixelBase+a.chrOffsetY[a.region.chromosome]-4,e=a.region.start*a.pixelBase+a.chrOffsetY[a.region.chromosome],f=a.region.start*a.pixelBase+a.chrOffsetY[a.region.chromosome]+4,g=b+","+d+" "+c+","+e+" "+b+","+f+" "+b+","+d;SVG.addChild(a.markGroup,"polyline",{points:g,stroke:"black",opacity:.8,fill:"#33FF33"})}};this.rendered?b():a.on("after:render",function(){b()})},unmark:function(){$(this.markGroup).empty()}},StatusBar.prototype={render:function(a){return this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1?(console.log("targetId not found in DOM"),void 0):(this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="'+this.id+'" class="gv-status-bar" align="right"></div>')[0],$(this.targetDiv).append(this.div),this.mousePositionDiv=$('<div id="'+this.id+'position" style="display: inline">&nbsp;</div>')[0],$(this.mousePositionDiv).css({"margin-left":"5px","margin-right":"5px","font-size":"12px"}),this.versionDiv=$('<div id="'+this.id+'version" style="display: inline">'+this.version+"</div>")[0],$(this.versionDiv).css({"margin-left":"5px","margin-right":"5px"}),$(this.div).append(this.mousePositionDiv),$(this.div).append(this.versionDiv),this.rendered=!0,void 0)},setRegion:function(a){this.region.load(a.region),$(this.mousePositionDiv).html(Utils.formatNumber(a.region.center()))},setMousePosition:function(a){$(this.mousePositionDiv).html(a.baseHtml+" "+this.region.chromosome+":"+Utils.formatNumber(a.mousePos))}},DataSource.prototype.fetch=function(){},FileDataSource.prototype.fetch=DataSource.prototype.fetch,FileDataSource.prototype.error=function(){alert("File is too big. Max file size is "+this.maxSize+" bytes")},FileDataSource.prototype.fetch=function(a){var b=this;if(this.file.size<=this.maxSize){if(!a){var c=new FileReaderSync;return c.readAsText(this.file,"UTF-8")}var c=new FileReader;c.onload=function(a){b.trigger("success",a.target.result)},c.readAsText(this.file,"UTF-8")}else b.error(),b.trigger("error",{sender:this})},StringDataSource.prototype.fetch=DataSource.prototype.fetch,StringDataSource.prototype.fetch=function(a){return a?(this.trigger("success",this.str),void 0):this.str},UrlDataSource.prototype.fetch=DataSource.prototype.fetch,UrlDataSource.prototype.fetch=function(a){var b=this,c=null;return this.url?($.ajax({type:"GET",url:this.url,async:a,success:function(d){a?b.success.notify(d):c=d},error:function(a,c,d){console.log("URL Data source: Ajax call returned : "+d+"	"+c+"	"+a.statusText+" END"),b.error.notify()}}),c):void 0},CellBaseAdapter.prototype={getData:function(a){var b=this,c=a.region;if(!(c.start>3e8||c.end<1)){c.start=c.start<1?1:c.start,c.end=c.end>3e8?3e8:c.end;var d={};_.extend(d,this.params),_.extend(d,a.params);var e=a.dataType;_.isUndefined(e)&&console.log("dataType must be provided!!!");var f;if("histogram"==e){var g=e+"_"+d.interval;_.isUndefined(this.cache[g])&&(this.cache[g]=new FeatureChunkCache({chunkSize:d.interval})),f=this.cache[g].chunkSize;
var h=this.cache[g].getAdjustedRegions(c);if(h.length>0)CellBaseManager.get({host:this.host,species:this.species,category:this.category,subCategory:this.subCategory,query:h,resource:this.resource,params:d,success:function(a){b._cellbaseHistogramSuccess(a,e,g)}});else{var i=this.cache[g].getCachedByRegion(c),j=this.cache[g].getByRegions(i.cached);this.trigger("data:ready",{items:j,dataType:e,chunkSize:f,sender:this})}}else{_.isUndefined(this.cache[e])&&(this.cache[e]=new FeatureChunkCache(this.cacheConfig)),f=this.cache[e].chunkSize;var i=this.cache[e].getCachedByRegion(c);if(i.notCached.length>0)for(var k=_.map(i.notCached,function(a){return new Region(a).toString()}),l=50,m=_.groupBy(k,function(a,b){return Math.floor(b/l)}),n=_.toArray(m),o=0;o<n.length;o++)CellBaseManager.get({host:this.host,species:this.species,category:this.category,subCategory:this.subCategory,query:n[o],resource:this.resource,params:d,success:function(a){b._cellbaseSuccess(a,e)}});if(i.cached.length>0){var j=this.cache[e].getByRegions(i.cached);this.trigger("data:ready",{items:j,dataType:e,chunkSize:f,sender:this})}}}},_cellbaseSuccess:function(a,b){var c=this.resource+" save "+Utils.randomString(4);console.time(c);for(var d=this.cache[b].chunkSize,e=[],f=0;f<a.response.length;f++){var g=a.response[f],h=new Region(g.id),i=g.result,j=this.cache[b].putByRegion(h,i);e.push(j)}console.timeEnd(c),e.length>0&&this.trigger("data:ready",{items:e,dataType:b,chunkSize:d,sender:this})},_cellbaseHistogramSuccess:function(a,b,c){var d=Utils.randomString(4);console.time(this.resource+" save "+d);for(var e=this.cache[c].chunkSize,f=[],g=0;g<a.response.length;g++)for(var h=a.response[g],i=0;i<h.result.length;i++){var j=h.result[i],k=new Region(h.id);k.load(j),f.push(this.cache[c].putByRegion(k,j))}this.trigger("data:ready",{items:f,dataType:b,chunkSize:e,sender:this}),console.timeEnd(this.resource+" get and save "+d)}},SequenceAdapter.prototype.clearData=function(){this.sequence={},this.start={},this.end={}},SequenceAdapter.prototype.getData=function(a){var b=this;this.sender=a.sender;var c=a.region,d=c.chromosome;c.start=c.start<1?1:c.start,c.end=c.end>3e8?3e8:c.end,(c.start<this.start[d]-5e3||c.end>this.end[d]+5e3)&&this.clearData();var e={};_.extend(e,this.params);var f=this._getSequenceQuery(c);""!=f?CellBaseManager.get({host:this.host,species:this.species,category:this.category,subCategory:this.subCategory,query:f,resource:this.resource,params:e,success:function(a){b._processSequenceQuery(a,!0)}}):"move"!=this.sender&&(this.trigger("data:ready",{items:{sequence:this.sequence[d],start:this.start[d],end:this.end[d]},params:e}),this.trigger("data:ready",{items:{sequence:this.sequence[d],start:this.start[d],end:this.end[d]},params:e,sender:this}))},SequenceAdapter.prototype._getSequenceQuery=function(a){var b,c,d,e=this,f=a.chromosome,g=[];return null==e.start[f]&&null==e.end[f]?(e.start[f]=a.start,e.end[f]=a.end,b=a.start,c=a.end,d=f+":"+b+"-"+c,g.push(d)):(a.start<=e.start[f]&&(b=a.start,c=e.start[f]-1,c=1>c?a.end=1:c,e.start[f]=b,d=a.chromosome+":"+b+"-"+c,g.push(d)),a.end>=e.end[f]&&(c=a.end,b=e.end[f]+1,e.end[f]=c,d=a.chromosome+":"+b+"-"+c,g.push(d))),g.toString()},SequenceAdapter.prototype._processSequenceQuery=function(a,b){for(var c=a.params,d=0;d<a.response.length;d++){var e=a.response[d],f=e.id.split(":"),g=f[1].split("-"),h=parseInt(g[0]),i=parseInt(g[1]);e.id;var j=e.result,k=j.chromosome;this.sequence[k]=null==this.sequence[k]?j.sequence:h==this.start[k]?j.sequence+this.sequence[k]:this.sequence[k]+j.sequence,"move"==this.sender&&1==b&&this.trigger("data:ready",{items:{sequence:j.sequence,start:h,end:i},params:c,sender:this})}"move"!=this.sender&&1==b&&this.trigger("data:ready",{items:{sequence:this.sequence[k],start:this.start[k],end:this.end[k]},params:c,sender:this})},SequenceAdapter.prototype.getNucleotidByPosition=function(a){var b=this;if(a.start>0&&a.end>0){var c=this._getSequenceQuery(a),d=a.chromosome;if(""!=c){var e=CellBaseManager.get({host:this.host,species:this.species,category:this.category,subCategory:this.subCategory,query:c,resource:this.resource,params:this.params,async:!1});b._processSequenceQuery(e)}if(null!=this.sequence[d]){var f=this.sequence[d].substr(a.start-this.start[d],1);return f}return console.log("SequenceRender: this.sequence[chromosome] is undefined"),""}},BamAdapter.prototype={host:null,gzip:!0,params:{}},BamAdapter.prototype.clearData=function(){this.featureCache.clear()},BamAdapter.prototype.setFilters=function(a){this.clearData(),this.filters=a;for(filter in a){var b=a[filter].toString();delete this.params[filter],""!=b&&(this.params[filter]=b)}},BamAdapter.prototype.setOption=function(a,b){a.fetch&&this.clearData(),this.options[a.name]=b;for(option in this.options)null!=this.options[a.name]?this.params[a.name]=this.options[a.name]:delete this.params[a.name]},BamAdapter.prototype.getData=function(a){var b=this;this.params.histogram=a.histogram,this.params.histogramLogarithm=a.histogramLogarithm,this.params.histogramMax=a.histogramMax,this.params.interval=a.interval,this.params.transcript=a.transcript,this.params.chromosome=a.chromosome,this.params.resource=this.resource.id,this.params.category=this.category,this.params.species=Utils.getSpeciesCode(this.species.text),a.start<1&&(a.start=1),a.end>3e8&&(a.end=3e8);var c="data";a.histogram&&(c="histogram"+a.interval),this.params.dataType=c;for(var d=this.featureCache._getChunk(a.start),e=this.featureCache._getChunk(a.end),f=[],g=[],h=d;e>=h;h++){var i=a.chromosome+":"+h;if(null==this.featureCache.cache[i]||null==this.featureCache.cache[i][c])f.push(h);else{var j=this.featureCache.getFeatureChunk(i);g.push(j)}}var k=function(a){var c=a.query.split(":"),d=c[1].split("-"),e={chromosome:c[0],start:d[0],end:d[1]},f="data";a.params.histogram?(f="histogram"+a.params.interval,b.featureCache.putHistogramFeaturesByRegion(a.result,e,a.resource,f)):b.featureCache.putFeaturesByRegion(a.result,e,a.resource,f);var h=b.featureCache.getFeatureChunksByRegion(e,f);g=g.concat(h),g.length>0&&b.trigger("data:ready",{items:g,params:b.params,cached:!1,sender:b})},l=[],m=!0,n=!0;if(f.length>0){for(var h=0;h<f.length;h++){if(m){var o=parseInt(f[h]*this.featureCache.chunkSize);m=!1}if(n){var p=parseInt(f[h]*this.featureCache.chunkSize+this.featureCache.chunkSize-1);n=!1}if(null!=f[h+1])if(f[h]+1==f[h+1])n=!0;else{var q=a.chromosome+":"+o+"-"+p;l.push(q),m=!0,n=!0}else{var q=a.chromosome+":"+o+"-"+p;l.push(q),m=!0,n=!0}}for(var h=0,r=l.length;r>h;h++){console.time("dqs");var s=$.cookie("bioinfo_sid");s=""!=s&&null!=s?s:"dummycookie",OpencgaManager.region({accountId:this.resource.account,sessionId:s,bucketId:this.resource.bucketId,objectId:this.resource.oid,region:l[h],queryParams:this.params,success:k})}}else g.length>0&&b.trigger("data:ready",{items:g,params:this.params,cached:!1,sender:this})},OpencgaAdapter.prototype={getData:function(a){var b=this,c=a.region;if(!(c.start>3e8||c.end<1)){c.start=c.start<1?1:c.start,c.end=c.end>3e8?3e8:c.end;var d={species:Utils.getSpeciesCode(this.species.text)};_.extend(d,this.params),_.extend(d,a.params);var e=a.dataType;_.isUndefined(e)&&console.log("dataType must be provided!!!");var f;if("histogram"==e);else{_.isUndefined(this.cache[e])&&(this.cache[e]=new FeatureChunkCache(this.cacheConfig)),f=this.cache[e].chunkSize;var g=this.cache[e].getCachedByRegion(c);if(g.notCached.length>0)for(var h=_.map(g.notCached,function(a){return new Region(a).toString()}),i=50,j=_.groupBy(h,function(a,b){return Math.floor(b/i)}),k=_.toArray(j),l=0;l<k.length;l++){var m=$.cookie("bioinfo_sid");m=""!=m&&null!=m?m:"dummycookie",OpencgaManager.region({accountId:this.resource.account,sessionId:m,bucketId:this.resource.bucketId,objectId:this.resource.oid,region:k[l],queryParams:d,success:function(a){b._opencgaSuccess(a,e)}})}if(g.cached.length>0){var n=this.cache[e].getByRegions(g.cached);this.trigger("data:ready",{items:n,dataType:e,chunkSize:f,sender:this})}}}},_opencgaSuccess:function(a,b){var c=this.resource+" save "+Utils.randomString(4);console.time(c);for(var d=this.cache[b].chunkSize,e=[],f=0;f<a.response.length;f++){var g=a.response[f],h=new Region(g.id),i=g.result,j=this.cache[b].putByRegion(h,i);e.push(j)}console.timeEnd(c),e.length>0&&this.trigger("data:ready",{items:e,dataType:b,chunkSize:d,sender:this})}},OpencgaAdapter.prototype.getDataOld=function(a){var b=this;this.params.histogram=a.histogram,this.params.histogramLogarithm=a.histogramLogarithm,this.params.histogramMax=a.histogramMax,this.params.interval=a.interval,this.params.transcript=a.transcript,a.start<1&&(a.start=1),a.end>3e8&&(a.end=3e8);var c="data";a.histogram&&(c="histogram"+a.interval);for(var d=this.featureCache._getChunk(a.start),e=this.featureCache._getChunk(a.end),f=[],g=[],h=d;e>=h;h++){var i=a.chromosome+":"+h;if(null==this.featureCache.cache[i]||null==this.featureCache.cache[i][c])f.push(h);else{var j=this.featureCache.getFeatureChunk(i,c);g=g.concat(j)}}var k=0,l=[];regionSuccess=function(a){console.timeEnd("dqs"),console.time("dqs-cache");var c="data";a.params.histogram&&(c="histogram"+a.params.interval),b.params.dataType=c;var d=a.query.split(":"),e=d[1].split("-"),f={chromosome:d[0],start:e[0],end:e[1]};if(null!=a.result[0]&&null!=a.result[0].position)for(var h=0;h<a.result.length;h++)a.result[h].start=a.result[h].position,a.result[h].end=a.result[h].position;b.featureCache.putFeaturesByRegion(a.result,f,b.category,c);var i=b.featureCache.getFeatureChunksByRegion(f,c);console.timeEnd("dqs-cache"),null!=i&&(g=g.concat(i)),k==l.length&&b.trigger("data:ready",{items:g,params:b.params,cached:!1,sender:b})};var m=!0,n=!0;if(f.length>0){for(var h=0;h<f.length;h++){if(m){var o=parseInt(f[h]*this.featureCache.chunkSize);m=!1}if(n){var p=parseInt(f[h]*this.featureCache.chunkSize+this.featureCache.chunkSize-1);n=!1}if(null!=f[h+1])if(f[h]+1==f[h+1])n=!0;else{var q=a.chromosome+":"+o+"-"+p;l.push(q),m=!0,n=!0}else{var q=a.chromosome+":"+o+"-"+p;l.push(q),m=!0,n=!0}}for(var h=0,r=l.length;r>h;h++){console.time("dqs"),k++;var s=$.cookie("bioinfo_sid");s=""!=s&&null!=s?s:"dummycookie",OpencgaManager.region({accountId:this.resource.account,sessionId:s,bucketId:this.resource.bucketId,objectId:this.resource.oid,region:l[h],queryParams:this.params,success:regionSuccess})}}else g.length>0&&this.trigger("data:ready",{items:g,params:this.params,cached:!1,sender:this})},FeatureDataAdapter.prototype.getData=function(a){console.log("TODO comprobar histograma"),console.log(a.region),this.params.dataType="data",this.params.chromosome=a.region.chromosome,1!=this.chromosomesLoaded[a.region.chromosome]&&(this._fetchData(a.region),this.chromosomesLoaded[a.region.chromosome]=!0);var b=this.featureCache.getFeatureChunksByRegion(a.region);null!=b&&this.trigger("data:ready",{items:b,params:this.params,chunkSize:this.featureCache.chunkSize,cached:!0,sender:this})},FeatureDataAdapter.prototype._fetchData=function(a){var b=this;if(null!=this.dataSource)if(this.async)this.dataSource.on("success",function(c){b.parse(c,a),b.trigger("file:load",{sender:b});var d=b.featureCache.getFeatureChunksByRegion(a);null!=d&&b.trigger("data:ready",{items:d,params:b.params,chunkSize:b.featureCache.chunkSize,cached:!0,sender:b})}),this.dataSource.fetch(this.async);else{var c=this.dataSource.fetch(this.async);this.parse(c,a)}},FeatureDataAdapter.prototype.addFeatures=function(a){this.featureCache.putFeatures(a,"data")},BEDDataAdapter.prototype.getData=FeatureDataAdapter.prototype.getData,BEDDataAdapter.prototype._fetchData=FeatureDataAdapter.prototype._fetchData,BEDDataAdapter.prototype.parse=function(a,b){for(var c="value",d=a.split("\n"),e=0;e<d.length;e++){var f=d[e].replace(/^\s+|\s+$/g,"");if(null!=f&&f.length>0){var g=f.split("	"),h=g[0].replace("chr","");if(h==b.chromosome){var i={label:g[3],chromosome:h,start:parseFloat(g[1]),end:parseFloat(g[2]),score:g[4],strand:g[5],thickStart:g[6],thickEnd:g[7],itemRgb:g[8],blockCount:g[9],blockSizes:g[10],blockStarts:g[11],featureType:"bed"};this.featureCache.putFeatures(i,c),null==this.featuresByChromosome[h]&&(this.featuresByChromosome[h]=0),this.featuresByChromosome[h]++,this.featuresCount++}}}},GFF2DataAdapter.prototype.getData=FeatureDataAdapter.prototype.getData,GFF2DataAdapter.prototype._fetchData=FeatureDataAdapter.prototype._fetchData,GFF2DataAdapter.prototype.parse=function(a,b){for(var c="value",d=a.split("\n"),e=0;e<d.length;e++){var f=d[e].replace(/^\s+|\s+$/g,"");if(null!=f&&f.length>0){var g=f.split("	"),h=g[0].replace("chr","");if(h==b.chromosome){var i={chromosome:h,label:g[2],start:parseInt(g[3]),end:parseInt(g[4]),score:g[5],strand:g[6],frame:g[7],group:g[8],featureType:"gff2"};this.featureCache.putFeatures(i,c),null==this.featuresByChromosome[h]&&(this.featuresByChromosome[h]=0),this.featuresByChromosome[h]++,this.featuresCount++}}}},GFF3DataAdapter.prototype.getData=FeatureDataAdapter.prototype.getData,GFF3DataAdapter.prototype._fetchData=FeatureDataAdapter.prototype._fetchData,GFF3DataAdapter.prototype.parse=function(a,b){for(var c=function(a){var b={};if("undefined"!=typeof a)for(var c=a.replace(/ /g,"").split(";"),d=0,e=c.length;e>d;d++){var f=c[d].split("=");b[f[0]]=f[1]}return b},d="value",e=a.split("\n"),f=0;f<e.length;f++){var g=e[f].replace(/^\s+|\s+$/g,"");if(null!=g&&g.length>0){var h=g.split("	"),i=h[0].replace("chr","");if(i==b.chromosome){var j={chromosome:i,label:h[2],start:parseInt(h[3]),end:parseInt(h[4]),score:h[5],strand:h[6],frame:h[7],attributes:c(h[8]),featureType:"gff3"};this.featureCache.putFeatures(j,d),null==this.featuresByChromosome[i]&&(this.featuresByChromosome[i]=0),this.featuresByChromosome[i]++,this.featuresCount++}}}},GTFDataAdapter.prototype.getData=FeatureDataAdapter.prototype.getData,GTFDataAdapter.prototype._fetchData=FeatureDataAdapter.prototype._fetchData,GTFDataAdapter.prototype.parse=function(a,b){for(var c=function(a){for(var b=a.split(";"),c={},d=0,e=b.length;e>d;d++){var f=b[d].split("=");c[f[0]]=f[1]}return c},d="value",e=a.split("\n"),f=0;f<e.length;f++){var g=e[f].replace(/^\s+|\s+$/g,"");if(null!=g&&g.length>0){var h=g.split("	"),i=h[0].replace("chr","");if(i==b.chromosome){var j={chromosome:i,label:h[2],start:parseInt(h[3]),end:parseInt(h[4]),score:h[5],strand:h[6],frame:h[7],attributes:c(h[8]),featureType:"gtf"};this.featureCache.putFeatures(j,d),null==this.featuresByChromosome[i]&&(this.featuresByChromosome[i]=0),this.featuresByChromosome[i]++,this.featuresCount++}}}},VCFDataAdapter.prototype.getData=FeatureDataAdapter.prototype.getData,VCFDataAdapter.prototype._fetchData=FeatureDataAdapter.prototype._fetchData,VCFDataAdapter.prototype.parse=function(a,b){for(var c="value",d=a.split("\n"),e=0;e<d.length;e++){var f=d[e].replace(/^\s+|\s+$/g,"");if(null!=f&&f.length>0){var g=f.split("	");if(g[0]==b.chromosome)if("#"===f.substr(0,1))"#"===f.substr(1,1)?this.header+=f.replace(/</gi,"&#60;").replace(/>/gi,"&#62;")+"<br>":this.samples=g.slice(9);else{var h={chromosome:g[0],position:parseInt(g[1]),start:parseInt(g[1]),end:parseInt(g[1]),id:g[2],reference:g[3],alternate:g[4],quality:g[5],filter:g[6],info:g[7].replace(/;/gi,"<br>"),format:g[8],sampleData:f,featureType:"vcf"};this.featureCache.putFeatures(h,c),null==this.featuresByChromosome[g[0]]&&(this.featuresByChromosome[g[0]]=0),this.featuresByChromosome[g[0]]++,this.featuresCount++}}}},MemoryStore.prototype={add:function(a,b){"undefined"==typeof this.store&&(this.store={});var c={key:a,value:b};this.store[a]=c,this.tail?(this.tail.newer=c,c.older=this.tail):this.head=c,this.tail=c,this.size++},shift:function(){var a=this.head;a&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,a.newer=a.older=void 0,delete this.store[a.key])},get:function(a){var b=this.store[a];if(void 0!==b)return b===this.tail?b.value:(b.newer&&(b===this.head&&(this.head=b.newer),b.newer.older=b.older),b.older&&(b.older.newer=b.newer),b.newer=void 0,b.older=this.tail,this.tail&&(this.tail.newer=b),this.tail=b,b.value)},init:function(){this.size=0,this.store={},this.head=void 0,this.tail=void 0},clear:function(){this.store=null,this.init()}},FeatureChunkCache.prototype={getChunk:function(a){return this.store.get(a)},getAdjustedRegion:function(a){var b=this.getChunkId(a.start)*this.chunkSize,c=this.getChunkId(a.end)*this.chunkSize+this.chunkSize-1;return new Region({chromosome:a.chromosome,start:b,end:c})},getAdjustedRegions:function(a){for(var b,c,d=this.getChunkId(a.start),e=this.getChunkId(a.end),f=[],g=!0,h=!0,i=d;e>=i;i++){var j=this.getChunkKey(a.chromosome,i),k=this.getChunkKey(a.chromosome,i+1),l=this.getChunk(j),m=this.getChunk(k);if(g&&(b=parseInt(i*this.chunkSize),g=!1),h&&(c=parseInt(i*this.chunkSize+this.chunkSize-1),h=!1),l)g=!0,h=!0;else{if(h=!0,m&&e>i){var n=new Region({chromosome:a.chromosome,start:b,end:c});f.push(n),g=!0}if(i==e){var n=new Region({chromosome:a.chromosome,start:b,end:c});f.push(n)}}}return f},getByRegions:function(a){var b=[];for(var c in a){var d=this.getChunkId(a[c].start),e=this.getChunkKey(a[c].chromosome,d);b.push(this.getChunk(e))}return b},getCachedByRegion:function(a){for(var b={cached:[],notCached:[]},c=this.getChunkId(a.start),d=this.getChunkId(a.end),e=c;d>=e;e++){var f=this.getChunkKey(a.chromosome,e),g=this.getChunk(f),h=parseInt(e*this.chunkSize)||1,i=parseInt(e*this.chunkSize+this.chunkSize-1),j=new Region({chromosome:a.chromosome,start:h,end:i});_.isUndefined(g)?b.notCached.push(j):b.cached.push(j),this.verbose&&console.log(b)}return b},putChunk:function(a,b){var b={value:b,chunkKey:a};return this.store.add(a,b),b},putByRegion:function(a,b){var c=this.getChunkId(a.start),d=this.getChunkKey(a.chromosome,c);return this.putChunk(d,b)},getChunkKey:function(a,b){return a+":"+b},getChunkId:function(a){return Math.floor(a/this.chunkSize)},getChunkSize:function(){return this.chunkSize}},FeatureCache.prototype._getChunk=function(a){return Math.floor(a/this.chunkSize)},FeatureCache.prototype.getChunkRegion=function(a){return start=this._getChunk(a.start)*this.chunkSize,end=this._getChunk(a.end)*this.chunkSize+this.chunkSize-1,{start:start,end:end}},FeatureCache.prototype.getFirstFeature=function(){var a;return a=this.gzip?JSON.parse(RawDeflate.inflate(this.cache[Object.keys(this.cache)[0]].data[0])):this.cache[Object.keys(this.cache)[0]].data[0]},FeatureCache.prototype.getFeatureChunk=function(a){return null!=this.cache[a]?this.cache[a]:null},FeatureCache.prototype.getFeatureChunkByDataType=function(a,b){return null!=this.cache[a]&&null!=this.cache[a][b]?this.cache[a][b]:null},FeatureCache.prototype.getFeatureChunksByRegion=function(a){var b,c,d,e=[];b=this._getChunk(a.start),c=this._getChunk(a.end);for(var f=b;c>=f;f++)d=a.chromosome+":"+f,null!=this.cache[d]&&e.push(this.cache[d]);return e},FeatureCache.prototype.putFeaturesByRegion=function(a,b,c,d){var e,f,g,h,i,j,k;f=this._getChunk(b.start),g=this._getChunk(b.end);for(var l=f;g>=l;l++)e=b.chromosome+":"+l,null==this.cache[e]&&(this.cache[e]={},this.cache[e].key=e),null==this.cache[e][d]&&(this.cache[e][d]=[]);a.constructor!=Array&&(a=[a]);for(var m=0,n=a.length;n>m;m++){j=a[m],j.featureType=c,h=this._getChunk(j.start),i=this._getChunk(j.end),k=this.gzip?RawDeflate.deflate(JSON.stringify(j)):j;for(var l=h;i>=l;l++)l>=f&&g>=l&&(e=b.chromosome+":"+l,this.cache[e][d].push(k))}},FeatureCache.prototype.putFeatures=function(a,b){var c,d,e,f;a.constructor!=Array&&(a=[a]);for(var g=0,h=a.length;h>g;g++){c=a[g],e=this._getChunk(c.start),f=this._getChunk(c.end);for(var i=e;f>=i;i++)d=c.chromosome+":"+i,null==this.cache[d]&&(this.cache[d]=[],this.cache[d].key=d),null==this.cache[d][b]&&(this.cache[d][b]=[]),this.gzip?this.cache[d][b].push(RawDeflate.deflate(JSON.stringify(c))):this.cache[d][b].push(c)}},FeatureCache.prototype.putChunk=function(a,b){this.cache[a]=b},FeatureCache.prototype.getChunk=function(a){return this.cache[a]},FeatureCache.prototype.putCustom=function(a){a(this)},FeatureCache.prototype.getCustom=function(a){a(this)},FeatureCache.prototype.remove=function(a){for(var b=this._getChunk(a.start),c=this._getChunk(a.end),d=b;c>=d;d++){var e=a.chromosome+":"+d;this.cache[e]=null}},FeatureCache.prototype.clear=function(){this.size=0,this.cache={}},BamCache.prototype.putHistogramFeaturesByRegion=FeatureCache.prototype.putFeaturesByRegion,BamCache.prototype._getChunk=function(a){return Math.floor(a/this.chunkSize)},BamCache.prototype.getFeatureChunk=function(a){return null!=this.cache[a]?this.cache[a]:null},BamCache.prototype.getFeatureChunksByRegion=function(a){var b,c,d,e=[];b=this._getChunk(a.start),c=this._getChunk(a.end);for(var f=b;c>=f;f++)d=a.chromosome+":"+f,null!=this.cache[d]&&e.push(this.cache[d]);return e},BamCache.prototype.putFeaturesByRegion=function(a,b,c,d){var e,f,g,h,i,j,k,l=a.reads,m=a.coverage;h=this._getChunk(b.start),i=this._getChunk(b.end);var n=0;console.time("BamCache.prototype.putFeaturesByRegion1");for(var o=h,p=0;i>=o;o++,p++){if(e=b.chromosome+":"+o,(null==this.cache[e]||null==this.cache[e][d])&&(this.cache[e]={},this.cache[e][d]=[],this.cache[e].key=e,this.cache[e].start=parseInt(b.start)+p*this.chunkSize,this.cache[e].end=parseInt(b.start)+(p+1)*this.chunkSize-1),"data"===d)var q=m.all.slice(n,n+this.chunkSize),r=m.a.slice(n,n+this.chunkSize),s=m.c.slice(n,n+this.chunkSize),t=m.g.slice(n,n+this.chunkSize),u=m.t.slice(n,n+this.chunkSize),v={all:q,a:r,c:s,g:t,t:u};this.cache[e].coverage=this.gzip?RawDeflate.deflate(JSON.stringify(v)):v,n+=this.chunkSize}console.timeEnd("BamCache.prototype.putFeaturesByRegion1"),console.time("BamCache.prototype.putFeaturesByRegion");var w=0;if("data"===d)for(var x=0,y=l.length;y>x;x++){j=l[x],j.featureType="bam",f=this._getChunk(j.start),g=this._getChunk(0==j.end?j.end=-1:j.end),k=this.gzip?RawDeflate.deflate(JSON.stringify(j)):j;for(var o=f,p=0;g>=o;o++,p++)o>=h&&i>=o&&(e=j.chromosome+":"+o,this.cache[e][d].push(k))}console.timeEnd("BamCache.prototype.putFeaturesByRegion"),console.log("BamCache.prototype.putFeaturesByRegion"+w)},BamCache.prototype.clear=function(){this.size=0,this.cache={},console.log("bamCache cleared")},TrackListPanel.prototype={show:function(){$(this.div).css({display:"block"})},hide:function(){$(this.div).css({display:"none"})},setVisible:function(a){a?$(this.div).css({display:"block"}):$(this.div).css({display:"none"})},setTitle:function(a){"titleDiv"in this&&$(this.titleDiv).html(a)},showContent:function(){$(this.tlHeaderDiv).css({display:"inline"}),$(this.panelDiv).css({display:"inline"}),this.collapsed=!1,$(this.collapseDiv).removeClass("active"),$(this.collapseDiv).children().first().removeClass("glyphicon-plus"),$(this.collapseDiv).children().first().addClass("glyphicon-minus")},hideContent:function(){$(this.tlHeaderDiv).css({display:"none"}),$(this.panelDiv).css({display:"none"}),this.collapsed=!0,$(this.collapseDiv).addClass("active"),$(this.collapseDiv).children().first().removeClass("glyphicon-minus"),$(this.collapseDiv).children().first().addClass("glyphicon-plus")},render:function(a){if(this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1)return console.log("targetId not found in DOM"),void 0;var b=this;if(this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="tracklist-panel" style="height:100%;position: relative;"></div>')[0],$(this.targetDiv).append(this.div),"title"in this&&""!==this.title){var c=$('<div id="tl-title" class="gv-panel-title unselectable"><span style="line-height: 24px;margin-left: 5px;">'+this.title+"</span></div>")[0];$(this.div).append(c),1==this.collapsible&&(this.collapseDiv=$('<div type="button" class="btn btn-default btn-xs" style="margin-left:10px;height:20px"><span class="glyphicon glyphicon-minus"></span></div>'),$(c).dblclick(function(){b.collapsed?b.showContent():b.hideContent()}),$(this.collapseDiv).click(function(){b.collapsed?b.showContent():b.hideContent()}),$(c).append(this.collapseDiv))}var d=$('<div id="tl-header" class="unselectable"></div>')[0],e=$('<div id="tl-panel"></div>')[0];$(e).css({position:"relative",width:"100%"}),this.tlTracksDiv=$('<div id="tl-tracks"></div>')[0],$(this.tlTracksDiv).css({position:"relative","z-index":3}),$(this.div).append(d),$(this.div).append(e),$(e).append(this.tlTracksDiv),this.svgTop=SVG.init(d,{width:this.width,height:25});var f=this.width/2;this.positionText=SVG.addChild(this.svgTop,"text",{x:f-30,y:24,fill:"steelblue","class":this.fontClass}),this.nucleotidText=SVG.addChild(this.svgTop,"text",{x:f+35,y:24,"class":this.fontClass}),this.firstPositionText=SVG.addChild(this.svgTop,"text",{x:0,y:24,fill:"steelblue","class":this.fontClass}),this.lastPositionText=SVG.addChild(this.svgTop,"text",{x:this.width-70,y:24,fill:"steelblue","class":this.fontClass}),this.windowSize="Window size: "+Utils.formatNumber(this.region.length())+" nts",this.viewNtsText=SVG.addChild(this.svgTop,"text",{x:f-7*this.windowSize.length/2,y:11,fill:"black","class":this.fontClass}),this.viewNtsText.textContent=this.windowSize,this._setTextPosition(),this.centerLine=$('<div id="'+this.id+'centerLine"></div>')[0],$(e).append(this.centerLine),$(this.centerLine).css({"z-index":2,position:"absolute",left:f-1,top:0,width:this.pixelBase,height:"calc(100% - 8px)",opacity:.5,border:"1px solid orangered","background-color":"orange"}),this.mouseLine=$('<div id="'+this.id+'mouseLine"></div>')[0],$(e).append(this.mouseLine),$(this.mouseLine).css({"z-index":1,position:"absolute",left:-20,top:0,width:this.pixelBase,height:"calc(100% - 8px)",border:"1px solid lightgray",opacity:.7,visibility:"hidden","background-color":"gainsboro"});var g=$('<div id="'+this.id+'selBox"></div>')[0];if($(e).append(g),$(g).css({"z-index":0,position:"absolute",left:0,top:0,height:"100%",border:"2px solid deepskyblue",opacity:.5,visibility:"hidden","background-color":"honeydew"}),this.showRegionOverviewBox){var h=$('<div id="'+this.id+'regionOverviewBoxLeft"></div>')[0],i=$('<div id="'+this.id+'regionOverviewBoxRight"></div>')[0];$(e).append(h),$(e).append(i);var j=this.region.length()*this.pixelBase,k=(this.width-j)/2;$(h).css({"z-index":0,position:"absolute",left:1,top:0,width:k,height:"calc(100% - 8px)",border:"1px solid gray",opacity:.5,"background-color":"lightgray"}),$(i).css({"z-index":0,position:"absolute",left:k+j,top:0,width:k,height:"calc(100% - 8px)",border:"1px solid gray",opacity:.5,"background-color":"lightgray"})}$(this.div).mousemove(function(a){var c=b.region.center(),d=b.width/2,e=b.pixelBase/2,f=a.clientX-$(b.tlTracksDiv).offset().left,g=f-e,h=0|g/b.pixelBase,i=h*b.pixelBase+d%b.pixelBase-1;$(b.mouseLine).css({left:i});var j=0|d/b.pixelBase;b.mousePosition=c+h-j,b.trigger("mousePosition:change",{mousePos:b.mousePosition,baseHtml:b.getMousePosition(b.mousePosition)})}),$(this.tlTracksDiv).dblclick(function(){var a=b.region.length()/2,c=new Region({chromosome:b.region.chromosome,start:b.mousePosition-a,end:b.mousePosition+a});b.trigger("region:change",{region:c,sender:b})});var l,m;$(this.tlTracksDiv).mousedown(function(a){$("html").addClass("unselectable"),$(b.mouseLine).css({visibility:"hidden"});var c=a.which;switch(a.ctrlKey&&(c="ctrlKey"+a.which),c){case 1:$(this).css({cursor:"move"}),l=a.clientX;var d=0;$(this).mousemove(function(a){var c=0|(l-a.clientX)/b.pixelBase;if(c!=d){var e=d-c,f=b.region.center(),g=f-e;g>0&&(b.region.start-=e,b.region.end-=e,b._setTextPosition(),b.trigger("region:move",{region:b.region,disp:e,sender:b}),b.trigger("trackRegion:move",{region:b.region,disp:e,sender:b}),d=c,b.setNucleotidPosition(g))}});break;case 2:case"ctrlKey1":$(g).css({visibility:"visible"}),$(g).css({width:0}),l=a.pageX-$(b.tlTracksDiv).offset().left,$(g).css({left:l}),$(this).mousemove(function(a){m=a.pageX-$(b.tlTracksDiv).offset().left,l>m&&$(g).css({left:m}),$(g).css({width:Math.abs(m-l)})});break;case 3:}}),$(this.tlTracksDiv).mouseup(function(a){$("html").removeClass("unselectable"),$(this).css({cursor:"default"}),$(b.mouseLine).css({visibility:"visible"}),$(this).off("mousemove");var c=a.which;switch(a.ctrlKey&&(c="ctrlKey"+a.which),c){case 1:break;case 2:case"ctrlKey1":if($(g).css({visibility:"hidden"}),$(this).off("mousemove"),null!=l&&null!=m){var d=l/b.pixelBase,e=m/b.pixelBase;d+=b.visualRegion.start,e+=b.visualRegion.start,b.region.start=parseInt(Math.min(d,e)),b.region.end=parseInt(Math.max(d,e)),b.trigger("region:change",{region:b.region,sender:b}),m=null}else if(null!=l&&null==m){var f=new Region({chromosome:b.region.chromosome,start:b.mousePosition,end:b.mousePosition});b.trigger("region:change",{region:f,sender:b})}break;case 3:}}),$(this.tlTracksDiv).mouseleave(function(){$(this).css({cursor:"default"}),$(b.mouseLine).css({visibility:"hidden"}),$(this).off("mousemove"),$("body").off("keydown.genomeViewer"),$(g).css({visibility:"hidden"}),l=null,m=null}),$(this.tlTracksDiv).mouseenter(function(){$(b.mouseLine).css({visibility:"visible"}),$("body").off("keydown.genomeViewer"),n()});var n=function(){$("body").bind("keydown.genomeViewer",function(a){var c=0;switch(a.keyCode){case 37:c=a.ctrlKey?Math.round(100/b.pixelBase):Math.round(10/b.pixelBase);break;case 39:c=a.ctrlKey?Math.round(-100/b.pixelBase):Math.round(-10/b.pixelBase);break;case 109:a.shiftKey&&console.log("zoom out");break;case 107:a.shiftKey&&console.log("zoom in")}0!=c&&(b.region.start-=c,b.region.end-=c,b._setTextPosition(),b.trigger("region:move",{region:b.region,disp:c,sender:b}),b.trigger("trackRegion:move",{region:b.region,disp:c,sender:b}))})};this.tlHeaderDiv=d,this.panelDiv=e,this.rendered=!0},setHeight:function(){},setWidth:function(a){console.log(a),this.width=a-18;var b=this.width/2;this._setPixelBase(),$(this.centerLine).css({left:b-1,width:this.pixelBase}),$(this.mouseLine).css({width:this.pixelBase}),this.svgTop.setAttribute("width",this.width),this.positionText.setAttribute("x",b-30),this.nucleotidText.setAttribute("x",b+35),this.lastPositionText.setAttribute("x",this.width-70),this.viewNtsText.setAttribute("x",b-7*this.windowSize.length/2),this.trigger("trackWidth:change",{width:this.width,sender:this}),this._setTextPosition()},highlight:function(a){this.trigger("trackFeature:highlight",a)},moveRegion:function(a){this.region.load(a.region),this.visualRegion.load(a.region),this._setTextPosition(),this.trigger("trackRegion:move",a)},setSpecies:function(a){this.species=a,this.trigger("trackSpecies:change",{species:a,sender:this})},setRegion:function(a){this.region.load(a),this.visualRegion.load(a),this._setPixelBase(),$(this.centerLine).css({width:this.pixelBase}),$(this.mouseLine).css({width:this.pixelBase}),this.viewNtsText.textContent="Window size: "+Utils.formatNumber(this.region.length())+" nts",this.windowSize=this.viewNtsText.textContent,this._setTextPosition(),this.trigger("window:size",{windowSize:this.viewNtsText.textContent}),this.trigger("trackRegion:change",{region:this.visualRegion,sender:this}),this.nucleotidText.textContent="",this.status="rendering"},draw:function(){this.trigger("track:draw",{sender:this})},checkTracksReady:function(){var a=this,b=function(b){for(i in a.trackSvgList)if(a.trackSvgList[i].status!=b)return!1;return!0};b("ready")&&(this.status="ready",a.trigger("tracks:ready",{sender:a}))},addTrack:function(a){if(_.isArray(a))for(var b in a)this._addTrack(a[b]);else this._addTrack(a)},_addTrack:function(a){if(!this.rendered)return console.info(this.id+" is not rendered yet"),void 0;var b=this,c=this.trackSvgList.push(a);this.swapHash[a.id]={index:c-1,visible:!0},a.set("pixelBase",this.pixelBase),a.set("region",this.visualRegion),a.set("width",this.width),a.rendered||a.render(this.tlTracksDiv),a.draw(),a.set("track:draw",function(){a.draw()}),a.set("trackSpecies:change",function(b){a.setSpecies(b.species)}),a.set("trackRegion:change",function(c){a.set("pixelBase",b.pixelBase),a.set("region",c.region),a.draw()}),a.set("trackRegion:move",function(c){a.set("region",c.region),a.set("pixelBase",b.pixelBase),a.move(c.disp)}),a.set("trackWidth:change",function(c){a.setWidth(c.width),a.set("pixelBase",b.pixelBase),a.draw()}),a.set("trackFeature:highlight",function(b){var c=b.attrName||"feature_id";if("attrValue"in b){b.attrValue=$.isArray(b.attrValue)?b.attrValue:[b.attrValue];
for(var d in b.attrValue){var e=c+"~="+b.attrValue[d],f=$(a.svgdiv).find("g["+e+"]");$(f).each(function(){var b=$(this).find("animate");b=0==b.length?SVG.addChild(this,"animate",{attributeName:"opacity",attributeType:"XML",begin:"indefinite",from:"0.0",to:"1",begin:"0s",dur:"0.5s",repeatCount:"5"}):b[0];var c=$(f).find("rect").attr("y");$(a.svgdiv).scrollTop(c),b.beginElement()})}}}),this.on("track:draw",a.get("track:draw")),this.on("trackSpecies:change",a.get("trackSpecies:change")),this.on("trackRegion:change",a.get("trackRegion:change")),this.on("trackRegion:move",a.get("trackRegion:move")),this.on("trackWidth:change",a.get("trackWidth:change")),this.on("trackFeature:highlight",a.get("trackFeature:highlight")),a.on("track:ready",function(){b.checkTracksReady()})},removeTrack:function(a){this._hideTrack(a);var b=this.swapHash[a].index,c=this.trackSvgList.splice(b,1)[0];delete this.swapHash[a],this.off("track:draw",c.get("track:draw")),this.off("trackSpecies:change",c.get("trackSpecies:change")),this.off("trackRegion:change",c.get("trackRegion:change")),this.off("trackRegion:move",c.get("trackRegion:move")),this.off("trackWidth:change",c.set("trackWidth:change")),this.off("trackFeature:highlight",c.get("trackFeature:highlight"));for(var b=0;b<this.trackSvgList.length;b++)this.swapHash[this.trackSvgList[b].id].index=b;return c},restoreTrack:function(a,b){this.addTrack(a),null!=b&&this.setTrackIndex(a.id,b)},enableAutoHeight:function(){for(var a=0;a<this.trackSvgList.length;a++){var b=this.trackSvgList[a];b.enableAutoHeight()}},updateHeight:function(){for(var a=0;a<this.trackSvgList.length;a++){var b=this.trackSvgList[a];b.updateHeight(!0)}},_redraw:function(){$(this.tlTracksDiv);for(var a=0;a<this.trackSvgList.length;a++){var b=this.trackSvgList[a];$(b.div).detach(),this.swapHash[b.id].visible&&$(this.tlTracksDiv).append(b.div)}},_reallocateAbove:function(a){var b=this.swapHash[a].index;if(console.log(b+" wants to move up"),b>0){var c=this.trackSvgList[b-1],d=this.trackSvgList[b],e=parseInt(c.main.getAttribute("y")),f=parseInt(d.main.getAttribute("height"));c.main.setAttribute("y",e+f),d.main.setAttribute("y",e),this.trackSvgList[b]=c,this.trackSvgList[b-1]=d,this.swapHash[c.id].index=b,this.swapHash[d.id].index=b-1}else console.log("is at top")},_reallocateUnder:function(a){var b=this.swapHash[a].index;if(console.log(b+" wants to move down"),b+1<this.trackSvgList.length){var c=this.trackSvgList[b],d=this.trackSvgList[b+1],e=parseInt(c.main.getAttribute("y")),f=parseInt(d.main.getAttribute("height"));c.main.setAttribute("y",e+f),d.main.setAttribute("y",e),this.trackSvgList[b]=d,this.trackSvgList[b+1]=c,this.swapHash[d.id].index=b,this.swapHash[c.id].index=b+1}else console.log("is at bottom")},setTrackIndex:function(a,b){var c=this.swapHash[a].index,d=this.trackSvgList.splice(c,1)[0];this.trackSvgList.splice(b,0,d);for(var e=0;e<this.trackSvgList.length;e++)this.swapHash[this.trackSvgList[e].id].index=e;this._redraw()},scrollToTrack:function(a){var b=this.swapHash[a];if(null!=b){var c=b.index,d=this.trackSvgList[c],e=$(d.div).position().top;$(this.tlTracksDiv).scrollTop(e)}},_hideTrack:function(a){this.swapHash[a].visible=!1;var b=this.swapHash[a].index,c=this.trackSvgList[b];c.hide(),this._redraw()},_showTrack:function(a){this.swapHash[a].visible=!0;var b=this.swapHash[a].index,c=this.trackSvgList[b];c.show(),this._redraw()},_setPixelBase:function(){this.pixelBase=this.width/this.region.length(),this.pixelBase=this.pixelBase/this.zoomMultiplier,this.halfVirtualBase=3*this.width/2/this.pixelBase},_setTextPosition:function(){var a=this.region.center(),b=parseInt(this.width/this.pixelBase),c=Math.ceil(b/2-1);this.visualRegion.start=Math.floor(a-c),this.visualRegion.end=Math.floor(a+c),this.positionText.textContent=Utils.formatNumber(a),this.firstPositionText.textContent=Utils.formatNumber(this.visualRegion.start),this.lastPositionText.textContent=Utils.formatNumber(this.visualRegion.end),this.viewNtsText.textContent="Window size: "+Utils.formatNumber(this.visualRegion.length())+" nts",this.windowSize=this.viewNtsText.textContent},getTrackSvgById:function(a){if(null!=this.swapHash[a]){var b=this.swapHash[a].index;return this.trackSvgList[b]}return null},getSequenceTrack:function(){for(var a=0;a<this.trackSvgList.length;a++){var b=this.trackSvgList[a];if(b instanceof SequenceTrack)return b}},getMousePosition:function(a){var b="",c="";return a>0&&(b=this.getSequenceNucleotid(a),c="color:"+SEQUENCE_COLORS[b]),'<span style="'+c+'">'+b+"</span>"},getSequenceNucleotid:function(a){var b=this.getSequenceTrack();if(null!=b&&this.visualRegion.length()<=b.visibleRegionSize){var c=b.dataAdapter.getNucleotidByPosition({start:a,end:a,chromosome:this.region.chromosome});return c}return""},setNucleotidPosition:function(a){var b=this.getSequenceNucleotid(a);this.nucleotidText.setAttribute("fill",SEQUENCE_COLORS[b]),this.nucleotidText.textContent=b}},Track.prototype={get:function(a){return this[a]},set:function(a,b){this[a]=b},hide:function(){$(this.div).css({display:"hidden"})},show:function(){$(this.div).css({display:"auto"})},hideContent:function(){$(this.svgdiv).css({display:"hidden"}),$(this.titlediv).css({display:"hidden"})},showContent:function(){$(this.svgdiv).css({display:"auto"}),$(this.titlediv).css({display:"auto"})},toggleContent:function(){$(this.svgdiv).toggle("hidden"),$(this.resizeDiv).toggle("hidden"),$(this.configBtn).toggle("hidden")},setSpecies:function(a){this.species=a,this.dataAdapter.species=this.species},setWidth:function(a){this.width=a,this.main.setAttribute("width",a)},_updateDIVHeight:function(){if(this.resizable)if(this.histogram)$(this.svgdiv).css({height:this.height+10});else{var a=this.pixelPosition,b=this.width,c=0;for(var d in this.renderedArea)this.renderedArea[d].contains({start:a,end:a+b})&&(c=d);var e=parseInt(c)+20;$(this.svgdiv).css({height:e+25})}},_updateSVGHeight:function(){if(this.resizable&&!this.histogram){var a=20*Object.keys(this.renderedArea).length;this.main.setAttribute("height",a),this.svgCanvasFeatures.setAttribute("height",a),this.hoverRect.setAttribute("height",a)}},updateHeight:function(a){this._updateSVGHeight(),(this.autoHeight||a)&&this._updateDIVHeight()},enableAutoHeight:function(){this.autoHeight=!0,this.updateHeight()},setTitle:function(a){$(this.titlediv).html(a)},setLoading:function(a){a?(this.svgLoading.setAttribute("visibility","visible"),this.status="rendering"):(this.svgLoading.setAttribute("visibility","hidden"),this.status="ready",this.trigger("track:ready",{sender:this}))},updateHistogramParams:function(){this.region.length()>this.minHistogramRegionSize?(this.histogram=!0,this.histogramLogarithm=!0,this.histogramMax=500,this.interval=Math.ceil(10/this.pixelBase)):(this.histogram=void 0,this.histogramLogarithm=void 0,this.histogramMax=void 0,this.interval=void 0)},cleanSvg:function(){for(;this.svgCanvasFeatures.firstChild;)this.svgCanvasFeatures.removeChild(this.svgCanvasFeatures.firstChild);this.chunksDisplayed={},this.renderedArea={}},initializeDom:function(a){var b=this,c=$('<div id="'+this.id+'-div"></div>')[0],d=$('<div class="btn-toolbar ocb-compactable">   <div class="btn-group btn-group-xs">   <button id="configBtn" type="button" class="btn btn-xs btn-primary"><span class="glyphicon glyphicon-cog"></span></button>   <button id="titleBtn" type="button" class="btn btn-xs btn-default" data-toggle="button"><span id="titleDiv">'+this.title+"</span></button>"+"   </div>"+"</div>")[0];_.isUndefined(this.title)&&$(d).addClass("hidden");var e=$(d).find("#titleDiv")[0],f=$(d).find("#titleBtn")[0],g=$(d).find("#configBtn")[0],h=$('<div id="'+this.id+'-svgdiv"></div>')[0],i=$('<div id="'+this.id+'-resizediv" class="ocb-track-resize"></div>')[0];$(a).addClass("unselectable"),$(a).append(c),$(c).append(d),$(c).append(h),$(c).append(i),$(d).css({padding:"4px"}).on("dblclick",function(a){a.stopPropagation()}),$(f).click(function(){b.toggleContent()}),$(h).css({"z-index":3,height:this.height,"overflow-y":this.resizable?"auto":"hidden","overflow-x":"hidden"});var j=SVG.addChild(h,"svg",{id:this.id,"class":"trackSvg",x:0,y:0,width:this.width,height:this.height});this.resizable&&($(i).mousedown(function(a){$("html").addClass("unselectable"),a.stopPropagation();var c=a.clientY;$("html").bind("mousemove.genomeViewer",function(a){var d=a.clientY-c,e=$(h).outerHeight();$(h).css({height:e+d}),c=a.clientY,b.autoHeight=!1})}),$("html").bind("mouseup.genomeViewer",function(){$("html").removeClass("unselectable"),$("html").off("mousemove.genomeViewer")}),$(h).closest(".trackListPanels").mouseup(function(){b.updateHeight()}),$(i).mouseenter(function(){$(this).css({cursor:"ns-resize"}),$(this).css({opacity:1})}),$(i).mouseleave(function(){$(this).css({cursor:"default"}),$(this).css({opacity:.3})})),this.svgGroup=SVG.addChild(j,"g",{}),this.title;var k=SVG.addChild(this.svgGroup,"rect",{x:0,y:0,width:this.width,height:this.height,opacity:"0.6",fill:"transparent"});this.svgCanvasFeatures=SVG.addChild(this.svgGroup,"svg",{"class":"features",x:-this.pixelPosition,width:this.svgCanvasWidth,height:this.height}),this.fnTitleMouseEnter=function(){k.setAttribute("opacity","0.1"),k.setAttribute("fill","lightblue")},this.fnTitleMouseLeave=function(){k.setAttribute("opacity","0.6"),k.setAttribute("fill","transparent")},$(this.svgGroup).off("mouseenter"),$(this.svgGroup).off("mouseleave"),$(this.svgGroup).mouseenter(this.fnTitleMouseEnter),$(this.svgGroup).mouseleave(this.fnTitleMouseLeave),this.invalidZoomText=SVG.addChild(this.svgGroup,"text",{x:154,y:18,opacity:"0.6",fill:"black",visibility:"hidden","class":this.fontClass}),this.invalidZoomText.textContent="Zoom in to view the sequence";var l='<?xml version="1.0" encoding="utf-8"?><svg version="1.1" width="22px" height="22px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><g id="pair"><ellipse cx="7" cy="0" rx="4" ry="1.7" style="fill:#ccc; fill-opacity:0.5;"/><ellipse cx="-7" cy="0" rx="4" ry="1.7" style="fill:#aaa; fill-opacity:1.0;"/></g></defs><g transform="translate(11,11)"><g><animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="1.5s" repeatDur="indefinite"/><use xlink:href="#pair"/><use xlink:href="#pair" transform="rotate(45)"/><use xlink:href="#pair" transform="rotate(90)"/><use xlink:href="#pair" transform="rotate(135)"/></g></g></svg>';this.svgLoading=SVG.addChildImage(j,{"xlink:href":"data:image/svg+xml,"+encodeURIComponent(l),x:10,y:0,width:22,height:22,visibility:"hidden"}),this.div=c,this.svgdiv=h,this.titlediv=e,this.resizeDiv=i,this.configBtn=g,this.main=j,this.hoverRect=k,this.rendered=!0,this.status="ready"},_drawHistogramLegend:function(){var a=this.histogramRenderer.histogramHeight,b=this.histogramRenderer.multiplier;this.histogramGroup=SVG.addChild(this.svgGroup,"g",{"class":"histogramGroup",visibility:"hidden"});var c=SVG.addChild(this.histogramGroup,"text",{x:21,y:a+4,"font-size":12,opacity:"0.9",fill:"orangered","class":this.fontClass});c.textContent="0-";var c=SVG.addChild(this.histogramGroup,"text",{x:14,y:a+4-Math.log(10)*b,"font-size":12,opacity:"0.9",fill:"orangered","class":this.fontClass});c.textContent="10-";var c=SVG.addChild(this.histogramGroup,"text",{x:7,y:a+4-Math.log(100)*b,"font-size":12,opacity:"0.9",fill:"orangered","class":this.fontClass});c.textContent="100-";var c=SVG.addChild(this.histogramGroup,"text",{x:0,y:a+4-Math.log(1e3)*b,"font-size":12,opacity:"0.9",fill:"orangered","class":this.fontClass});c.textContent="1000-"},draw:function(){},getFeaturesToRenderByChunk:function(a){for(var b,c,d,e,f=function(b){return Math.floor(b/a.chunkSize)},g=function(a,b){return a+":"+b},h=a.items,i=[],i=[],j=0,k=h.length;k>j;j++)if(1!=this.chunksDisplayed[h[j].chunkKey]){for(var l=0,m=h[j].value.length;m>l;l++){b=h[j].value[l],c=!1,d=f(b.start),e=f(b.end);for(var n=d;e>=n;n++){var o=g(b.chromosome,n);if(1==this.chunksDisplayed[o]){c=!0;break}}c||i.push(b)}this.chunksDisplayed[h[j].chunkKey]=!0}return i}},BamTrack.prototype=new Track({}),BamTrack.prototype.render=function(a){var b=this;this.initializeDom(a),this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.dataAdapter.on("data:ready",function(a){var c;"histogram"==a.dataType?(b.renderer=b.histogramRenderer,c=a.items):(b.renderer=b.defaultRenderer,c=b._removeDisplayedChunks(a)),b.renderer.render(c,{svgCanvasFeatures:b.svgCanvasFeatures,featureTypes:b.featureTypes,renderedArea:b.renderedArea,pixelBase:b.pixelBase,position:b.region.center(),region:b.region,width:b.width,regionSize:b.region.length(),maxLabelRegionSize:b.maxLabelRegionSize,pixelPosition:b.pixelPosition}),b.updateHeight(),b.setLoading(!1)})},BamTrack.prototype.draw=function(){var a=this;this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.updateHistogramParams(),this.cleanSvg(),this.dataType="features",this.histogram&&(this.dataType="histogram"),"undefined"==typeof this.visibleRegionSize||this.region.length()<this.visibleRegionSize?(this.setLoading(!0),this.dataAdapter.getData({dataType:this.dataType,region:new Region({chromosome:this.region.chromosome,start:this.region.start-2*this.svgCanvasOffset,end:this.region.end+2*this.svgCanvasOffset}),params:{histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}}),this.invalidZoomText.setAttribute("visibility","hidden")):this.invalidZoomText.setAttribute("visibility","visible"),a.updateHeight()},BamTrack.prototype.move=function(a){var b=this;this.dataType="features",this.histogram&&(this.dataType="histogram"),b.region.center();var c=a*b.pixelBase;this.pixelPosition-=c;var d=parseFloat(this.svgCanvasFeatures.getAttribute("x"))+c;this.svgCanvasFeatures.setAttribute("x",d);var e=parseInt(this.region.start-this.svgCanvasOffset),f=parseInt(this.region.end+this.svgCanvasOffset);("undefined"==typeof this.visibleRegionSize||this.region.length()<this.visibleRegionSize)&&(a>0&&e<this.svgCanvasLeftLimit&&(this.dataAdapter.getData({dataType:this.dataType,region:new Region({chromosome:b.region.chromosome,start:parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset),end:this.svgCanvasLeftLimit}),params:{histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}}),this.svgCanvasLeftLimit=parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset)),0>a&&f>this.svgCanvasRightLimit&&(this.dataAdapter.getData({dataType:this.dataType,region:new Region({chromosome:b.region.chromosome,start:this.svgCanvasRightLimit,end:parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)}),params:{histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}}),this.svgCanvasRightLimit=parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)))},BamTrack.prototype._removeDisplayedChunks=function(a){for(var b,c,d,e,f=a.items,g=a.dataType,h=[],i=[],j=0,k=f.length;k>j;j++)if(1!=this.chunksDisplayed[f[j].chunkKey]){i=[];for(var l=0,m=f[j].value.reads.length;m>l;l++){b=f[j].value.reads[l];var n=this.dataAdapter.cache[g];c=!1,d=n.getChunkId(b.start),e=n.getChunkId(b.end);for(var o=d;e>=o;o++){var p=n.getChunkKey(b.chromosome,o);if(1==this.chunksDisplayed[p]){c=!0;break}}c||i.push(b)}this.chunksDisplayed[f[j].chunkKey]=!0,f[j].value.reads=i,h.push(f[j])}return a.items=h,a},FeatureTrack.prototype=new Track({}),FeatureTrack.prototype.render=function(a){var b=this;this.initializeDom(a),this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.dataAdapter.on("data:ready",function(a){var c;"histogram"==a.dataType?(b.renderer=b.histogramRenderer,c=a.items):(b.renderer=b.defaultRenderer,c=b.getFeaturesToRenderByChunk(a)),b.renderer.render(c,{svgCanvasFeatures:b.svgCanvasFeatures,featureTypes:b.featureTypes,renderedArea:b.renderedArea,pixelBase:b.pixelBase,position:b.region.center(),regionSize:b.region.length(),maxLabelRegionSize:b.maxLabelRegionSize,width:b.width,pixelPosition:b.pixelPosition,resource:b.resource,species:b.species}),b.updateHeight(),b.setLoading(!1)})},FeatureTrack.prototype.draw=function(){var a=this;this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.updateHistogramParams(),this.cleanSvg(),this.dataType="features",this.histogram&&(this.dataType="histogram"),"undefined"==typeof this.visibleRegionSize||this.region.length()<this.visibleRegionSize?(this.setLoading(!0),this.dataAdapter.getData({dataType:this.dataType,region:new Region({chromosome:this.region.chromosome,start:this.region.start-2*this.svgCanvasOffset,end:this.region.end+2*this.svgCanvasOffset}),params:{histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}}),this.invalidZoomText.setAttribute("visibility","hidden")):this.invalidZoomText.setAttribute("visibility","visible"),a.updateHeight()},FeatureTrack.prototype.move=function(a){var b=this;this.dataType="features",this.histogram&&(this.dataType="histogram"),b.region.center();var c=a*b.pixelBase;this.pixelPosition-=c;var d=parseFloat(this.svgCanvasFeatures.getAttribute("x"))+c;this.svgCanvasFeatures.setAttribute("x",d);var e=parseInt(this.region.start-this.svgCanvasOffset),f=parseInt(this.region.end+this.svgCanvasOffset);("undefined"==typeof this.visibleRegionSize||this.region.length()<this.visibleRegionSize)&&(a>0&&e<this.svgCanvasLeftLimit&&(this.dataAdapter.getData({dataType:this.dataType,region:new Region({chromosome:b.region.chromosome,start:parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset),end:this.svgCanvasLeftLimit}),params:{histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}}),this.svgCanvasLeftLimit=parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset)),0>a&&f>this.svgCanvasRightLimit&&(this.dataAdapter.getData({dataType:this.dataType,region:new Region({chromosome:b.region.chromosome,start:this.svgCanvasRightLimit,end:parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)}),params:{histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}}),this.svgCanvasRightLimit=parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)))},GeneTrack.prototype=new Track({}),GeneTrack.prototype.render=function(a){var b=this;this.initializeDom(a),this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.dataAdapter.on("data:ready",function(a){var c;"histogram"==a.dataType?(b.renderer=b.histogramRenderer,c=a.items):(b.renderer=b.defaultRenderer,c=b.getFeaturesToRenderByChunk(a)),b.renderer.render(c,{svgCanvasFeatures:b.svgCanvasFeatures,featureTypes:b.featureTypes,renderedArea:b.renderedArea,pixelBase:b.pixelBase,position:b.region.center(),regionSize:b.region.length(),maxLabelRegionSize:b.maxLabelRegionSize,width:b.width,pixelPosition:b.pixelPosition}),b.updateHeight(),b.setLoading(!1)}),this.renderer.on("feature:click",function(a){b.showInfoWidget(a)})},GeneTrack.prototype.updateTranscriptParams=function(){this.exclude=this.region.length()<this.minTranscriptRegionSize?void 0:"transcripts"},GeneTrack.prototype.draw=function(){var a=this;this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.updateTranscriptParams(),this.updateHistogramParams(),this.cleanSvg();var b="features";_.isUndefined(this.exclude)||(b="features"+this.exclude),this.histogram&&(b="histogram"),"undefined"==typeof this.visibleRegionSize||this.region.length()<this.visibleRegionSize?(this.setLoading(!0),this.dataAdapter.getData({dataType:b,region:new Region({chromosome:this.region.chromosome,start:this.region.start-2*this.svgCanvasOffset,end:this.region.end+2*this.svgCanvasOffset}),params:{histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval,exclude:this.exclude}}),this.invalidZoomText.setAttribute("visibility","hidden")):this.invalidZoomText.setAttribute("visibility","visible"),a.updateHeight()},GeneTrack.prototype.move=function(a){var b=this;this.dataType="features",_.isUndefined(this.exclude)||(dataType="features"+this.exclude),this.histogram&&(this.dataType="histogram"),b.region.center();var c=a*b.pixelBase;this.pixelPosition-=c;var d=parseFloat(this.svgCanvasFeatures.getAttribute("x"))+c;this.svgCanvasFeatures.setAttribute("x",d);var e=parseInt(this.region.start-this.svgCanvasOffset),f=parseInt(this.region.end+this.svgCanvasOffset);("undefined"==typeof this.visibleRegionSize||this.region.length()<this.visibleRegionSize)&&(a>0&&e<this.svgCanvasLeftLimit&&(console.log("left"),this.dataAdapter.getData({dataType:this.dataType,region:new Region({chromosome:b.region.chromosome,start:parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset),end:this.svgCanvasLeftLimit}),params:{histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval,exclude:this.exclude}}),this.svgCanvasLeftLimit=parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset)),0>a&&f>this.svgCanvasRightLimit&&(console.log("right"),this.dataAdapter.getData({dataType:this.dataType,region:new Region({chromosome:b.region.chromosome,start:this.svgCanvasRightLimit,end:parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)}),params:{histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval,exclude:this.exclude}}),this.svgCanvasRightLimit=parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)))},GeneTrack.prototype.showInfoWidget=function(a){switch(a.featureType){case"gene":new GeneInfoWidget(null,this.dataAdapter.species).draw(a);break;case"transcript":new TranscriptInfoWidget(null,this.dataAdapter.species).draw(a)}},SequenceTrack.prototype=new Track({}),SequenceTrack.prototype.render=function(a){var b=this;this.initializeDom(a),this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.dataAdapter.on("data:ready",function(a){b.renderer.render(a,{svgCanvasFeatures:b.svgCanvasFeatures,pixelBase:b.pixelBase,position:b.region.center(),width:b.width,pixelPosition:b.pixelPosition}),b.setLoading(!1)})},SequenceTrack.prototype.draw=function(){this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.cleanSvg(),"undefined"==typeof this.visibleRegionSize||this.region.length()<this.visibleRegionSize?(this.setLoading(!0),this.dataAdapter.getData({region:new Region({chromosome:this.region.chromosome,start:this.region.start-2*this.svgCanvasOffset,end:this.region.end+2*this.svgCanvasOffset})}),this.invalidZoomText.setAttribute("visibility","hidden")):this.invalidZoomText.setAttribute("visibility","visible")},SequenceTrack.prototype.move=function(a){var b=this,c=a*b.pixelBase;this.pixelPosition-=c;var d=parseFloat(this.svgCanvasFeatures.getAttribute("x"))+c;this.svgCanvasFeatures.setAttribute("x",d);var e=parseInt(this.region.start-this.svgCanvasOffset),f=parseInt(this.region.end+this.svgCanvasOffset);("undefined"==typeof this.visibleRegionSize||this.region.length()<this.visibleRegionSize)&&(a>0&&e<this.svgCanvasLeftLimit&&(this.dataAdapter.getData({region:new Region({chromosome:b.region.chromosome,start:parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset),end:this.svgCanvasLeftLimit}),sender:"move"}),this.svgCanvasLeftLimit=parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset)),0>a&&f>this.svgCanvasRightLimit&&(this.dataAdapter.getData({region:new Region({chromosome:b.region.chromosome,start:this.svgCanvasRightLimit,end:parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)}),sender:"move"}),this.svgCanvasRightLimit=parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)))},Renderer.prototype={render:function(){},getFeatureX:function(a,b){var c=b.width/2,d=b.pixelPosition+c-(b.position-a.start)*b.pixelBase;return d},getDefaultConfig:function(a){return FEATURE_TYPES[a]},getLabelWidth:function(a,b){var c=SVG.create("text",{"font-weight":400,"class":this.fontClass});c.textContent=a,$(b.svgCanvasFeatures).append(c);var d=$(c).width();return $(c).remove(),d}},BamRenderer.prototype=new Renderer({}),BamRenderer.prototype.render=function(a,b){var c=this;_.isUndefined(a.params)&&(a.params={});var d=!1;null!=a.params.view_as_pairs&&(d=!0),console.log("viewAsPairs "+d);var e=0,f=0,g="orangered";null!=a.params.insert_size_interval&&(e=a.params.insert_size_interval.split(",")[0],f=a.params.insert_size_interval.split(",")[1]),console.log("insertSizeMin "+e),console.log("insertSizeMin "+f),$(b.svgCanvasFeatures).contextmenu(function(a){console.log("click derecho"),a.preventDefault()}),console.time("BamRender "+a.params.resource);var h=a.items,i=SVG.addChild(b.svgCanvasFeatures,"g",{"class":"bamCoverage",cursor:"pointer"}),j=SVG.addChild(b.svgCanvasFeatures,"g",{"class":"bamReads",cursor:"pointer"}),k=function(a){for(var d,e=a.coverage.all,f=a.coverage.a,g=a.coverage.c,h=a.coverage.g,j=a.coverage.t,k=parseInt(a.start),l=parseInt(a.end),m=(l-k+1)*b.pixelBase,n=b.width/2,o=b.pixelBase/2-.5,p=parseInt(a.start),q="",r="",s="",t="",u=200,v=50,w=0;w<e.length;w++)d=b.pixelPosition+n-(b.position-p)*b.pixelBase,xx=b.pixelPosition+n-(b.position-p)*b.pixelBase+b.pixelBase,q+=d+","+f[w]/u*v+" ",q+=xx+","+f[w]/u*v+" ",r+=d+","+(g[w]+f[w])/u*v+" ",r+=xx+","+(g[w]+f[w])/u*v+" ",s+=d+","+(h[w]+g[w]+f[w])/u*v+" ",s+=xx+","+(h[w]+g[w]+f[w])/u*v+" ",t+=d+","+(j[w]+h[w]+g[w]+f[w])/u*v+" ",t+=xx+","+(j[w]+h[w]+g[w]+f[w])/u*v+" ",p++;var x=r.split(" ").reverse().join(" ").trim(),y=s.split(" ").reverse().join(" ").trim(),z=t.split(" ").reverse().join(" ").trim(),A=b.pixelPosition+n-(b.position-parseInt(a.start))*b.pixelBase+o,B=b.pixelPosition+n-(b.position-parseInt(a.end))*b.pixelBase+o;SVG.addChild(i,"polyline",{points:A+",0 "+q+B+",0",fill:"green"}),SVG.addChild(i,"polyline",{points:q+" "+x,fill:"blue"}),SVG.addChild(i,"polyline",{points:r+" "+y,fill:"gold"}),SVG.addChild(i,"polyline",{points:s+" "+z,fill:"red"});var C=SVG.addChild(i,"rect",{x:b.pixelPosition+n-(b.position-k)*b.pixelBase,y:0,width:m,height:v,opacity:"0.5",fill:"lightgray",cursor:"pointer"});$(C).qtip({content:" ",position:{target:"mouse",adjust:{x:15,y:0},viewport:$(window),effect:!1},style:{width:!0,classes:c.toolTipfontClass+" ui-tooltip-shadow"}})},l=function(a){var d=a.unclippedStart,h=a.unclippedEnd,i=h-d+1,k=a.diff,l=_.isFunction(c.color)?c.color(a,b.region.chromosome):c.color,m=_.isFunction(c.strokeColor)?c.strokeColor(a,b.region.chromosome):c.strokeColor;_.isFunction(c.label)?c.label(a):c.label;var n=_.isFunction(c.height)?c.height(a):c.height,o=_.isFunction(c.tooltipTitle)?c.tooltipTitle(a):c.tooltipTitle,p=_.isFunction(c.tooltipText)?c.tooltipText(a):c.tooltipText,q=_.isFunction(c.strand)?c.strand(a):c.strand,r=_.isFunction(c.mateUnmappedFlag)?c.mateUnmappedFlag(a):c.mateUnmappedFlag;_.isFunction(c.infoWidgetId)?c.infoWidgetId(a):c.infoWidgetId,0==e||0==f||r||(Math.abs(a.inferredInsertSize)>f&&(l="maroon"),Math.abs(a.inferredInsertSize)<e&&(l="navy"));var s=i*b.pixelBase,t=c.getFeatureX(a,b);maxWidth=s;for(var u=12,v=70;;){null==b.renderedArea[v]&&(b.renderedArea[v]=new FeatureBinarySearchTree);var w=b.renderedArea[v].add({start:t,end:t+maxWidth-1});if(w){var x=SVG.addChild(j,"g",{feature_id:a.name}),y={Reverse:t+","+(v+n/2)+" "+(t+5)+","+v+" "+(t+s-5)+","+v+" "+(t+s-5)+","+(v+n)+" "+(t+5)+","+(v+n),Forward:t+","+v+" "+(t+s-5)+","+v+" "+(t+s)+","+(v+n/2)+" "+(t+s-5)+","+(v+n)+" "+t+","+(v+n)};SVG.addChild(x,"polygon",{points:y[q],stroke:m,"stroke-width":1,fill:l,cursor:"pointer"}),null!=k&&b.regionSize<400&&SVG.addChild(x,"path",{d:Utils.genBamVariants(k,b.pixelBase,t,v),fill:g}),$(x).qtip({content:{text:p,title:o},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:300,classes:c.toolTipfontClass+" ui-tooltip ui-tooltip-shadow"},show:"click",hide:"click mouseleave"});break}v+=u}},m=function(a,d){var h=a.unclippedStart,i=a.unclippedEnd,k=d.unclippedStart,l=d.unclippedEnd,m=a.diff,n=d.diff,o=c.types[a.featureType],p=c.types[d.featureType],q=o.getColor(a,c.region.chromosome),r=p.getColor(d,c.region.chromosome),s=o.getStrand(a),t=p.getStrand(d);0!=e&&0!=f&&(Math.abs(a.inferredInsertSize)>f&&(q="maroon",r="maroon"),Math.abs(a.inferredInsertSize)<e&&(q="navy",r="navy"));var u=h,v=l;h>=k&&(u=k),i>=l&&(v=i);for(var w=(v-u+1)*c.pixelBase,x=c.pixelPosition+middle-(c.position-u)*c.pixelBase,y=(i-h+1)*c.pixelBase,z=c.pixelPosition+middle-(c.position-h)*c.pixelBase,A=(l-k+1)*c.pixelBase,B=c.pixelPosition+middle-(c.position-k)*c.pixelBase,C=12,D=70;;){null==b.renderedArea[D]&&(b.renderedArea[D]=new FeatureBinarySearchTree);var E=b.renderedArea[D].add({start:x,end:x+w-1});if(E){var F=[],G=[],H={Reverse:z+","+(D+o.height/2)+" "+(z+5)+","+D+" "+(z+y-5)+","+D+" "+(z+y-5)+","+(D+o.height)+" "+(z+5)+","+(D+o.height),Forward:z+","+D+" "+(z+y-5)+","+D+" "+(z+y)+","+(D+o.height/2)+" "+(z+y-5)+","+(D+o.height)+" "+z+","+(D+o.height)},I=SVG.addChild(j,"polygon",{points:H[s],stroke:o.getStrokeColor(a),"stroke-width":1,fill:q,cursor:"pointer"});F.push(I);var J={Reverse:B+","+(D+p.height/2)+" "+(B+5)+","+D+" "+(B+A-5)+","+D+" "+(B+A-5)+","+(D+p.height)+" "+(B+5)+","+(D+p.height),Forward:B+","+D+" "+(B+A-5)+","+D+" "+(B+A)+","+(D+p.height/2)+" "+(B+A-5)+","+(D+p.height)+" "+B+","+(D+p.height)},K=SVG.addChild(j,"polygon",{points:J[t],stroke:p.getStrokeColor(d),"stroke-width":1,fill:r,cursor:"pointer"});if(G.push(K),SVG.addChild(j,"line",{x1:z+y,y1:D+o.height/2,x2:B,y2:D+o.height/2,"stroke-width":"1",stroke:"gray",cursor:"pointer"}),b.regionSize<400){if(null!=m){var L=SVG.addChild(j,"path",{d:Utils.genBamVariants(m,c.pixelBase,z,D),fill:g});F.push(L)}if(null!=n){var M=SVG.addChild(j,"path",{d:Utils.genBamVariants(n,c.pixelBase,B,D),fill:g});G.push(M)}}$(F).qtip({content:{text:o.getTipText(a),title:o.getTipTitle(a)},position:{target:"mouse",adjust:{x:15,y:0},viewport:$(window),effect:!1},style:{width:280,classes:c.toolTipfontClass+" ui-tooltip ui-tooltip-shadow"},show:"click",hide:"click mouseleave"}),$(F).click(function(){console.log(a),c.showInfoWidget({query:a[o.infoWidgetId],feature:a,featureType:a.featureType,adapter:c.trackData.adapter})}),$(G).qtip({content:{text:p.getTipText(d),title:p.getTipTitle(d)},position:{target:"mouse",adjust:{x:15,y:0},viewport:$(window),effect:!1},style:{width:280,classes:c.toolTipfontClass+" ui-tooltip ui-tooltip-shadow"},show:"click",hide:"click mouseleave"}),$(G).click(function(){console.log(d),c.showInfoWidget({query:d[p.infoWidgetId],feature:d,featureType:d.featureType,adapter:c.trackData.adapter})});break}D+=C}},n=function(a){k(a.value);for(var b=a.value.reads,c=0,e=b.length;e>c;c++){var f=b[c];if(d){var g=b[c+1];null!=g&&(f.name==g.name?(m(f,g),c++):l(f))}else l(f)}};if(h.length>0)for(var o=0,p=h.length;p>o;o++)n(h[o]);console.timeEnd("BamRender "+a.params.resource)},ConservedRenderer.prototype=new Renderer({}),ConservedRenderer.prototype.render=function(a,b){var c=b.width/2,d=20,e=75,f="",g=b.pixelBase,h=a[0],i=b.pixelPosition+c-(b.position-parseInt(h.start))*b.pixelBase;f=i+g/2+","+e+" ";for(var j=0,k=a.length;k>j;j++){var l=a[j];l.start=parseInt(l.start),l.end=parseInt(l.end);for(var m=0,k=l.values;k>m;m++){var n=l.values[m],o=n*d,p=start+m,i=b.pixelPosition+c-(b.position-p)*b.pixelBase;
f+=i+g/2+","+(e-o)+" "}}f+=i+g/2+","+e+" ",SVG.addChild(b.svgCanvasFeatures,"polyline",{points:f,stroke:"#000000","stroke-width":.2,fill:"salmon",cursor:"pointer"})},FeatureClusterRenderer.prototype=new Renderer({}),FeatureClusterRenderer.prototype.render=function(a,b){var c=this;b.width/2;for(var d=function(d){d.start=parseInt(d.start),d.end=parseInt(d.end);var f=d.end-d.start;f*=b.pixelBase;var g=c.getFeatureX(d,b);null==d.features_count&&(d.features_count=0!=d.absolute?Math.log(a[e].absolute):0);var h=d.features_count*c.multiplier,i=SVG.addChild(b.svgCanvasFeatures,"rect",{x:g+1,y:0,width:f-1,height:h,stroke:"smokewhite","stroke-width":1,fill:"#9493b1",cursor:"pointer"}),j=CellBaseManager.url({species:b.species,category:"genomic",subCategory:"region",query:new Region(d).toString(),resource:b.resource,params:{include:"chromosome,start,end,id",limit:20},async:!1});$(i).qtip({content:{text:"Loading...",ajax:{url:j,type:"GET",success:function(a){for(var b=a.response[0].result,c="",e=0;e<b.length;e++){var f=b[e],g=new Region(f);c+='<span class="emph">'+f.id+'</span> <span class="info">'+g.toString()+"</span><br>"}var h=Math.round(Math.exp(d.features_count));20>=h?(this.set("content.title","Count: "+b.length),this.set("content.text",c)):(this.set("content.title","Count: "+h),this.set("content.text",c+"..."))}}},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:!0,classes:c.toolTipfontClass+" ui-tooltip ui-tooltip-shadow"}})},e=0,f=a.length;f>e;e++)d(a[e].value)},FeatureRenderer.prototype=new Renderer({}),FeatureRenderer.prototype.render=function(a,b){var c=this,d=function(a,d){var e=_.isFunction(c.color)?c.color(a):c.color,f=_.isFunction(c.label)?c.label(a):c.label,h=_.isFunction(c.height)?c.height(a):c.height,i=_.isFunction(c.tooltipTitle)?c.tooltipTitle(a):c.tooltipTitle,j=_.isFunction(c.tooltipText)?c.tooltipText(a):c.tooltipText,k=_.isFunction(c.infoWidgetId)?c.infoWidgetId(a):c.infoWidgetId,l=a.start,m=a.end,n=m-l+1;n=0>n?Math.abs(n):n,n=0==n?1:n;var o=n*b.pixelBase,p=6.4*f.length,q=c.getFeatureX(a,b),r=Math.max(o,2),s=0;b.maxLabelRegionSize>b.regionSize&&(s=9,r=Math.max(o,p));for(var t=0,u=s+h,v=s+h+2;;){t in b.renderedArea||(b.renderedArea[t]=new FeatureBinarySearchTree);var w=b.renderedArea[t].add({start:q,end:q+r-1});if(w){var x=SVG.addChild(d,"g",{feature_id:a.id});if(SVG.addChild(x,"rect",{x:q,y:t,width:o,height:h,stroke:"#3B0B0B","stroke-width":1,"stroke-opacity":.7,fill:e,cursor:"pointer"}),b.maxLabelRegionSize>b.regionSize){var y=SVG.addChild(x,"text",{i:g,x:q,y:u,"font-weight":400,opacity:null,fill:"black",cursor:"pointer","class":c.fontClass});y.textContent=f}"tooltipText"in c&&$(x).qtip({content:{text:j,title:i},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:!0,classes:c.toolTipfontClass+" ui-tooltip ui-tooltip-shadow"}}),$(x).mouseover(function(b){c.trigger("feature:mouseover",{query:a[k],feature:a,featureType:a.featureType,mouseoverEvent:b})}),$(x).click(function(b){c.trigger("feature:click",{query:a[k],feature:a,featureType:a.featureType,clickEvent:b})});break}t+=v,u+=v}},e="write dom "+Utils.randomString(4);console.time(e),console.log(a.length);for(var f=SVG.create("g"),g=0,h=a.length;h>g;g++)d(a[g],f);b.svgCanvasFeatures.appendChild(f),console.timeEnd(e)},GeneRenderer.prototype=new Renderer({}),GeneRenderer.prototype.setFeatureConfig=function(a){_.extend(this,this.getDefaultConfig(a))},GeneRenderer.prototype.render=function(a,b){for(var c=this,d=(function(a){c.setFeatureConfig("gene");var d=_.isFunction(c.color)?c.color(a):c.color,e=_.isFunction(c.label)?c.label(a):c.label,f=_.isFunction(c.height)?c.height(a):c.height,g=_.isFunction(c.tooltipTitle)?c.tooltipTitle(a):c.tooltipTitle,h=_.isFunction(c.tooltipText)?c.tooltipText(a):c.tooltipText,i=_.isFunction(c.infoWidgetId)?c.infoWidgetId(a):c.infoWidgetId,j=a.start,k=a.end,l=k-j+1,m=l*b.pixelBase,n=6.4*e.length,o=c.getFeatureX(a,b),p=Math.max(m,2),q=0;b.maxLabelRegionSize>b.regionSize&&(q=9,p=Math.max(m,n));for(var r=0,s=q+f+1,t=q+f+5;;){r in b.renderedArea||(b.renderedArea[r]=new FeatureBinarySearchTree);var u,v=r,w=!0;if(_.isEmpty(a.transcripts))u=b.renderedArea[r].add({start:o,end:o+p-1});else{for(var x=0,y=a.transcripts.length+1;y>x;x++){if(v in b.renderedArea||(b.renderedArea[v]=new FeatureBinarySearchTree),b.renderedArea[v].contains({start:o,end:o+p-1})){w=!1;break}v+=t}1==w&&(u=b.renderedArea[r].add({start:o,end:o+p-1}))}if(u){var z=SVG.addChild(b.svgCanvasFeatures,"g",{feature_id:a.id});if(SVG.addChild(z,"rect",{x:o,y:r,width:m,height:f,stroke:"#3B0B0B","stroke-width":.5,fill:d,cursor:"pointer"}),b.maxLabelRegionSize>b.regionSize){var A=SVG.addChild(z,"text",{i:x,x:o,y:s,fill:"black",cursor:"pointer","class":c.fontClass});A.textContent=e}$(z).qtip({content:{text:h,title:g},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:!0,classes:c.toolTipfontClass+" ui-tooltip ui-tooltip-shadow"}}),$(z).click(function(b){c.trigger("feature:click",{query:a[i],feature:a,featureType:a.featureType,clickEvent:b})});var v=r+t,B=s+t;if(!_.isEmpty(a.transcripts))for(var x=0,y=a.transcripts.length;y>x;x++){v in b.renderedArea||(b.renderedArea[v]=new FeatureBinarySearchTree);var C=a.transcripts[x],D=c.getFeatureX(C,b),E=(C.end-C.start+1)*b.pixelBase;c.setFeatureConfig("transcript");var F=_.isFunction(c.color)?c.color(C):c.color,e=_.isFunction(c.label)?c.label(C):c.label,f=_.isFunction(c.height)?c.height(C):c.height,g=_.isFunction(c.tooltipTitle)?c.tooltipTitle(C):c.tooltipTitle,h=_.isFunction(c.tooltipText)?c.tooltipText(C):c.tooltipText,i=_.isFunction(c.infoWidgetId)?c.infoWidgetId(C):c.infoWidgetId,n=6.4*e.length,p=Math.max(m,m-(a.end-C.start)*b.pixelBase+n);b.renderedArea[v].add({start:o,end:o+p-1});var G=SVG.addChild(b.svgCanvasFeatures,"g",{widgetId:C[i]});SVG.addChild(G,"rect",{x:D,y:v+1,width:E,height:f,fill:"gray",cursor:"pointer",feature_id:C.id});var A=SVG.addChild(G,"text",{x:D,y:B,opacity:null,fill:"black",cursor:"pointer","class":c.fontClass});A.textContent=e,$(G).qtip({content:{text:h,title:g},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:!0,classes:c.toolTipfontClass+" ui-tooltip ui-tooltip-shadow"}}),$(G).click(function(a){var b=this.getAttribute("widgetId");c.trigger("feature:click",{query:b,feature:C,featureType:C.featureType,clickEvent:a})});for(var H=0,I=a.transcripts[x].exons.length;I>H;H++){var J=a.transcripts[x].exons[H],K=parseInt(J.start),L=parseInt(J.end),M=b.width/2,N=b.pixelPosition+M-(b.position-K)*b.pixelBase,O=(L-K+1)*b.pixelBase;c.setFeatureConfig("exon");var d=_.isFunction(c.color)?c.color(J):c.color,e=_.isFunction(c.label)?c.label(J):c.label,f=_.isFunction(c.height)?c.height(J):c.height,g=_.isFunction(c.tooltipTitle)?c.tooltipTitle(J):c.tooltipTitle,h=_.isFunction(c.tooltipText)?c.tooltipText(J,C):c.tooltipText,i=_.isFunction(c.infoWidgetId)?c.infoWidgetId(J):c.infoWidgetId,P=SVG.addChild(b.svgCanvasFeatures,"g");$(P).qtip({content:{text:h,title:g},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:!0,classes:c.toolTipfontClass+" ui-tooltip ui-tooltip-shadow"}}),SVG.addChild(P,"rect",{i:x,x:N,y:v-1,width:O,height:f,stroke:"gray","stroke-width":1,fill:"white",cursor:"pointer"});var Q=0,R=0;C.genomicCodingStart>K&&C.genomicCodingStart<L?(Q=parseInt(C.genomicCodingStart),R=L):C.genomicCodingEnd>K&&C.genomicCodingEnd<L?(Q=K,R=parseInt(C.genomicCodingEnd)):C.genomicCodingStart<K&&C.genomicCodingEnd>L&&(Q=K,R=L);var S=R-Q,T=b.pixelPosition+M-(b.position-Q)*b.pixelBase,U=(S+1)*b.pixelBase;if(S>0){SVG.addChild(P,"rect",{i:x,x:T,y:v-1,width:U,height:f,stroke:F,"stroke-width":1,fill:F,cursor:"pointer"});for(var V=0,W=3-J.phase;W>V&&10==Math.round(b.pixelBase)&&-1!=J.phase&&null!=J.phase;V++)SVG.addChild(P,"rect",{i:x,x:T+10*V,y:v-1,width:b.pixelBase,height:f,stroke:d,"stroke-width":1,fill:"white",cursor:"pointer"})}}v+=t,B+=t}break}r+=t,s+=t}}),e=0,f=a.length;f>e;e++)d(a[e])},HistogramRenderer.prototype=new Renderer({}),HistogramRenderer.prototype.render=function(a,b){var c=b.width/2,d="";if(a.length>0){var e=a[0].value,f=(e.end-e.start)*b.pixelBase,g=b.pixelPosition+c-(b.position-parseInt(e.start))*b.pixelBase;d=g+f/2+","+this.histogramHeight+" "}for(var h=0,i=a.length;i>h;h++){var j=a[h].value;j.start=parseInt(j.start),j.end=parseInt(j.end);var f=j.end-j.start;f*=b.pixelBase;var g=b.pixelPosition+c-(b.position-j.start)*b.pixelBase;null==j.features_count&&(j.features_count=0!=j.absolute?Math.log(a[h].absolute):0);var k=j.features_count*this.multiplier;d+=g+f/2+","+(this.histogramHeight-k)+" "}if(a.length>0){var l=a[a.length-1].value,f=(l.end-l.start)*b.pixelBase,g=b.pixelPosition+c-(b.position-parseInt(l.start))*b.pixelBase;d+=g+f/2+","+this.histogramHeight+" "}SVG.addChild(b.svgCanvasFeatures,"polyline",{points:d,stroke:"#000000","stroke-width":.2,fill:"#9493b1",cursor:"pointer"})},SequenceRenderer.prototype=new Renderer({}),SequenceRenderer.prototype.render=function(a,b){console.time("Sequence render "+a.items.sequence.length);for(var c=b.width/2,d=a.items.start,e=a.items.start,f=a.items.sequence,g=0;g<f.length;g++){var h=b.pixelPosition+c-(b.position-d)*b.pixelBase;d++;var i=SVG.addChild(b.svgCanvasFeatures,"text",{x:h+1,y:12,fill:SEQUENCE_COLORS[f.charAt(g)],"class":this.fontClass});i.textContent=f.charAt(g),$(i).qtip({content:f.charAt(g)+" "+(e+g).toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),position:{target:"mouse",adjust:{x:15,y:0},viewport:$(window),effect:!1},style:{width:!0,classes:this.toolTipfontClass+" qtip-light qtip-shadow"}})}console.timeEnd("Sequence render "+a.items.sequence.length)},VcfMultisampleRenderer.prototype=new Renderer({}),VcfMultisampleRenderer.prototype.render=function(a,b){for(var c=this,d=function(a){_.isFunction(c.color)?c.color(a):c.color;var d=_.isFunction(c.label)?c.label(a):c.label;_.isFunction(c.height)?c.height(a):c.height;var e=_.isFunction(c.tooltipTitle)?c.tooltipTitle(a):c.tooltipTitle,f=_.isFunction(c.tooltipText)?c.tooltipText(a):c.tooltipText;_.isFunction(c.infoWidgetId)?c.infoWidgetId(a):c.infoWidgetId;var g=a.start,h=a.end,i=h-g+1;i=0>i?Math.abs(i):i,i=0==i?1:i;var j=i*b.pixelBase,k=c.getLabelWidth(d,b),l=c.getFeatureX(a,b),m=Math.max(j,2),n=0;b.regionSize<b.maxLabelRegionSize&&(n=9,m=Math.max(j,k));for(var o="",p="",q="",r="",s=l,t=l+j,u=1,v=6,w=10,x=0,y=a.samples.length;y>x;x++){b.renderedArea[u]=new FeatureBinarySearchTree,b.renderedArea[u].add({start:s,end:t});var z=a.samples[x].split(":")[0];switch(z){case"0|0":case"0/0":o+="M"+s+","+u+" L"+t+","+u+" ",o+="L"+t+","+(u+v)+" L"+s+","+(u+v)+" z ";break;case".|.":case"./.":p+="M"+s+","+u+" L"+t+","+u+" ",p+="L"+t+","+(u+v)+" L"+s+","+(u+v)+" z ";break;case"1|1":case"1/1":q+="M"+s+","+u+" L"+t+","+u+" ",q+="L"+t+","+(u+v)+" L"+s+","+(u+v)+" z ";break;case"0|1":case"0/1":case"1|0":case"1/0":r+="M"+s+","+u+" L"+t+","+u+" ",r+="L"+t+","+(u+v)+" L"+s+","+(u+v)+" z "}u+=w}var A=SVG.addChild(b.svgCanvasFeatures,"g",{feature_id:a.id});SVG.addChild(A,"rect",{x:s,y:1,width:j,height:u,fill:"transparent",cursor:"pointer"}),""!=o&&SVG.addChild(A,"path",{d:o,fill:"blue",cursor:"pointer"}),""!=p&&SVG.addChild(A,"path",{d:p,fill:"black",cursor:"pointer"}),""!=q&&SVG.addChild(A,"path",{d:q,fill:"red",cursor:"pointer"}),""!=r&&SVG.addChild(A,"path",{d:r,fill:"orange",cursor:"pointer"});var B=0;$(A).qtip({content:{text:f+"<br>"+a.samples[B],title:e},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:!0,classes:c.toolTipfontClass+" ui-tooltip ui-tooltip-shadow"}}),$(A).mousemove(function(b){var c=parseInt(b.offsetY/w);c!=B&&(console.log(c),$(A).qtip("option","content.text",f+"<br>"+a.samples[c])),B=c})},e=0,f=a.length;f>e;e++){var g=a[e];d(g)}},LegendPanel.prototype.getColorItems=function(a){panelsArray=new Array;for(var b in a){var c=15,d=Ext.create("Ext.draw.Component",{width:c,height:c,items:[{type:"rect",fill:a[b],x:0,y:0,width:c,height:c}]}),e=Utils.formatText(b,"_"),f=Ext.create("Ext.panel.Panel",{height:c,border:!1,flex:1,margin:"1 0 0 1",layout:{type:"hbox",align:"stretch"},items:[d,{xtype:"tbtext",text:e,margin:"1 0 0 3"}]});panelsArray.push(f)}return panelsArray},LegendPanel.prototype.getPanel=function(a){if(null==this.panel){var b=this.getColorItems(a);this.panel=Ext.create("Ext.panel.Panel",{bodyPadding:"0 0 0 2",border:!1,layout:{type:"vbox",align:"stretch"},items:b,width:this.width,height:20*b.length})}return this.panel},LegendPanel.prototype.getButton=function(a){return null==this.button&&(this.button=Ext.create("Ext.button.Button",{text:this.title,menu:{plain:!0,items:[this.getPanel(a)]}})),this.button},LegendWidget.prototype.draw=function(a){var b=this;if(null==this.panel){var c=this.legendPanel.getPanel(a);this.panel=Ext.create("Ext.ux.Window",{title:this.title,resizable:!1,constrain:!0,closable:!0,width:c.width+10,height:c.height+70,items:[c],buttonAlign:"right",layout:{type:"hbox",align:"stretch"},buttons:[{text:"Close",handler:function(){b.panel.close()}}]})}this.panel.show()},UrlWidget.prototype.draw=function(){null==this.panel&&this.render(),this.panel.show()},UrlWidget.prototype.render=function(){var a=this;this.urlField=Ext.create("Ext.form.field.Text",{margin:"0 2 2 0",labelWidth:30,width:this.width-55,fieldLabel:"URL",emptyText:"enter a valid url",value:"http://www.ensembl.org/das/Homo_sapiens.GRCh37.gene/features",listeners:{change:{fn:function(){var b=this.value.split("/das/")[1].split("/")[0];a.trackNameField.setValue(b)}}}}),this.checkButton=Ext.create("Ext.button.Button",{text:"Check",handler:function(){a.form.setLoading();var b=new DasAdapter({url:a.urlField.getValue(),featureCache:{gzip:!1,chunkSize:1e4},handlers:{"url:check":function(b){console.log(b.data),a.contentArea.setValue(b.data),a.form.setLoading(!1)},error:function(){a.contentArea.setValue("XMLHttpRequest cannot load. This server is not allowed by Access-Control-Allow-Origin"),a.form.setLoading(!1)}}});b.checkUrl()}}),this.trackNameField=Ext.create("Ext.form.field.Text",{name:"file",allowBlank:!1,value:a.urlField.value.split("/das/")[1].split("/")[0],emptyText:"Choose a name",flex:1}),this.panelSettings=Ext.create("Ext.panel.Panel",{layout:"hbox",border:!1,title:"Track name",cls:"panel-border-top",bodyPadding:10,width:this.width-2,items:[this.trackNameField]}),this.contentArea=Ext.create("Ext.form.field.TextArea",{margin:"-1",width:this.width,height:this.height}),this.infobar=Ext.create("Ext.toolbar.Toolbar",{height:28,cls:"bio-border-false",items:[this.urlField,this.checkButton]}),this.form=Ext.create("Ext.panel.Panel",{border:!1,items:[this.infobar,this.contentArea,this.panelSettings]}),this.panel=Ext.create("Ext.ux.Window",{title:this.title,layout:"fit",resizable:!1,items:[this.form],buttons:[{text:"Add",handler:function(){a.trigger("addButton:click",{name:a.trackNameField.getValue(),url:a.urlField.getValue()}),a.panel.close()}},{text:"Cancel",handler:function(){a.panel.close()}}],listeners:{destroy:function(){delete a.panel}}})},FileWidget.prototype.getTitleName=function(){return this.trackNameField.getValue()},FileWidget.prototype.getFileFromServer=function(){},FileWidget.prototype.loadFileFromLocal=function(){},FileWidget.prototype.getFileUpload=function(){var a=this;return this.uploadField=Ext.create("Ext.form.field.File",{msgTarget:"side",flex:1,padding:1,emptyText:"Choose a file",allowBlank:!1,anchor:"100%",buttonText:"Browse local",listeners:{change:{fn:function(){a.panel.setLoading();var b=document.getElementById(a.uploadField.fileInputEl.id).files[0];a.trackNameField.setValue(b.name),a.fileNameLabel.setText('<span class="emph">'+b.name+'</span> <span class="info">(local)</span>',!1),a.loadFileFromLocal(b),a.panel.setLoading(!1)}}}}),this.uploadField},FileWidget.prototype.draw=function(){var a=this;if(null==this.openDialog){var b=Ext.create("Ext.toolbar.Toolbar");this.featureCountLabel=Ext.create("Ext.toolbar.TextItem",{text:'<span class="dis">No file loaded</span>'}),b.add([this.featureCountLabel]);var c=Ext.create("Ext.toolbar.Toolbar",{cls:"bio-border-false"});c.add(this.getFileUpload()),this.panel=Ext.create("Ext.panel.Panel",{border:!1,cls:"panel-border-top panel-border-bottom",height:230,title:"Previsualization",bbar:b}),this.trackNameField=Ext.create("Ext.form.field.Text",{name:"file",fieldLabel:"Track Name",allowBlank:!1,value:"New track from "+this.title+" file",emptyText:"Choose a name",flex:1});var d=Ext.create("Ext.panel.Panel",{border:!1,layout:"hbox",bodyPadding:10,items:[this.trackNameField]});this.wum&&(null!=$.cookie("bioinfo_sid")?this.sessionInitiated():this.sessionFinished()),this.fileNameLabel=Ext.create("Ext.toolbar.TextItem",{}),this.btnOk=Ext.create("Ext.button.Button",{text:"Ok",disabled:!0,handler:function(){a.trigger("okButton:click",{fileName:a.file.name,adapter:a.adapter}),a.openDialog.close()}}),this.openDialog=Ext.create("Ext.window.Window",{title:"Open "+this.title+" file",width:600,resizable:!1,items:[c,d],buttons:[this.btnOk,{text:"Cancel",handler:function(){a.openDialog.close()}}],listeners:{scope:this,minimize:function(){this.openDialog.hide()},destroy:function(){delete this.openDialog}}})}this.openDialog.show()},FileWidget.prototype.sessionInitiated=function(){},FileWidget.prototype.sessionFinished=function(){},BEDFileWidget.prototype.getTitleName=FileWidget.prototype.getTitleName,BEDFileWidget.prototype.getFileUpload=FileWidget.prototype.getFileUpload,BEDFileWidget.prototype.draw=FileWidget.prototype.draw,BEDFileWidget.prototype.sessionInitiated=FileWidget.prototype.sessionInitiated,BEDFileWidget.prototype.sessionFinished=FileWidget.prototype.sessionFinished,BEDFileWidget.prototype.getChartItems=FileWidget.prototype.getChartItems,BEDFileWidget.prototype._loadChartInfo=FileWidget.prototype._loadChartInfo,BEDFileWidget.prototype.loadFileFromLocal=function(a){var b=this;this.file=a,this.adapter=new BEDDataAdapter(new FileDataSource(a),{species:this.viewer.species}),this.adapter.on("file:load",function(){}),b.btnOk.enable()},BEDFileWidget.prototype.loadFileFromServer=function(a){this.file={name:a.filename},this.adapter=new BEDDataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species}),this._loadChartInfo(),this.btnOk.enable()},GFFFileWidget.prototype.getTitleName=FileWidget.prototype.getTitleName,GFFFileWidget.prototype.getFileUpload=FileWidget.prototype.getFileUpload,GFFFileWidget.prototype.draw=FileWidget.prototype.draw,GFFFileWidget.prototype.sessionInitiated=FileWidget.prototype.sessionInitiated,GFFFileWidget.prototype.sessionFinished=FileWidget.prototype.sessionFinished,GFFFileWidget.prototype.getChartItems=FileWidget.prototype.getChartItems,GFFFileWidget.prototype._loadChartInfo=FileWidget.prototype._loadChartInfo,GFFFileWidget.prototype.loadFileFromLocal=function(a){var b=this;switch(this.file=a,this.version){case"2":case 2:this.adapter=new GFF2DataAdapter(new FileDataSource(a),{species:this.viewer.species});break;case"3":case 3:this.adapter=new GFF3DataAdapter(new FileDataSource(a),{species:this.viewer.species});break;default:this.adapter=new GFF2DataAdapter(new FileDataSource(a),{species:this.viewer.species})}this.adapter.on("file:load",function(){}),b.btnOk.enable()},GFFFileWidget.prototype.loadFileFromServer=function(a){switch(this.file={name:a.filename},this.version){case"2":case 2:this.adapter=new GFF2DataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species});break;case"3":case 3:this.adapter=new GFF3DataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species});break;default:this.adapter=new GFF2DataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species})}this._loadChartInfo(),this.btnOk.enable()},GTFFileWidget.prototype.getTitleName=FileWidget.prototype.getTitleName,GTFFileWidget.prototype.getFileUpload=FileWidget.prototype.getFileUpload,GTFFileWidget.prototype.draw=FileWidget.prototype.draw,GTFFileWidget.prototype.sessionInitiated=FileWidget.prototype.sessionInitiated,GTFFileWidget.prototype.sessionFinished=FileWidget.prototype.sessionFinished,GTFFileWidget.prototype.getChartItems=FileWidget.prototype.getChartItems,GTFFileWidget.prototype._loadChartInfo=FileWidget.prototype._loadChartInfo,GTFFileWidget.prototype.loadFileFromLocal=function(a){var b=this;this.file=a,this.adapter=new GTFDataAdapter(new FileDataSource(a),{species:this.viewer.species}),this.adapter.onLoad.addEventListener(function(){console.log(b.adapter.featuresByChromosome),b._loadChartInfo()}),b.btnOk.enable()},GTFFileWidget.prototype.loadFileFromServer=function(a){this.file={name:a.filename},this.adapter=new GTFDataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species}),this._loadChartInfo(),this.btnOk.enable()},VCFFileWidget.prototype.getTitleName=FileWidget.prototype.getTitleName,VCFFileWidget.prototype.getFileUpload=FileWidget.prototype.getFileUpload,VCFFileWidget.prototype.draw=FileWidget.prototype.draw,VCFFileWidget.prototype.sessionInitiated=FileWidget.prototype.sessionInitiated,VCFFileWidget.prototype.sessionFinished=FileWidget.prototype.sessionFinished,VCFFileWidget.prototype.getChartItems=FileWidget.prototype.getChartItems,VCFFileWidget.prototype._loadChartInfo=FileWidget.prototype._loadChartInfo,VCFFileWidget.prototype.loadFileFromLocal=function(a){var b=this;this.file=a,this.adapter=new VCFDataAdapter(new FileDataSource(a),{species:this.viewer.species}),this.adapter.on("file:load",function(){console.log(b.adapter.featuresByChromosome)}),b.btnOk.enable()},VCFFileWidget.prototype.loadFileFromServer=function(a){this.file={name:a.filename},this.adapter=new VCFDataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species}),this.btnOk.enable()},GenomeViewer.prototype={render:function(a){if(this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1)return console.log("targetId not found in DOM"),void 0;this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div class="bootstrap" id="'+this.id+'" class="ocb-gv ocb-box-vertical"></div>')[0],$(this.targetDiv).append(this.div);var b=Math.max($(this.div).width(),$(this.targetDiv).width());if(0==b)return console.log("target div width is zero"),void 0;if(this.width=b,this.border){var c=_.isString(this.border)?this.border:"1px solid lightgray";$(this.div).css({border:c})}this.navigationbarDiv=$('<div id="navigation-'+this.id+'" class="ocb-gv-navigation"></div>')[0],$(this.div).append(this.navigationbarDiv),this.centerPanelDiv=$('<div id="center-'+this.id+'" class="ocb-gv-center"></div>')[0],$(this.div).append(this.centerPanelDiv),this.statusbarDiv=$('<div id="statusbar-'+this.id+'" class="ocb-gv-status"></div>'),$(this.div).append(this.statusbarDiv),this.rightSidebarDiv=$('<div id="rightsidebar-'+this.id+'" style="position:absolute; z-index:50;right:0px;"></div>')[0],this.leftSidebarDiv=$('<div id="leftsidebar-'+this.id+'" style="position:absolute; z-index:50;left:0px;"></div>')[0],$(this.centerPanelDiv).append(this.rightSidebarDiv),$(this.centerPanelDiv).append(this.leftSidebarDiv),this.karyotypeDiv=$('<div id="karyotype-'+this.id+'"></div>'),$(this.centerPanelDiv).append(this.karyotypeDiv),this.chromosomeDiv=$('<div id="chromosome-'+this.id+'"></div>'),$(this.centerPanelDiv).append(this.chromosomeDiv),this.trackListPanelsDiv=$('<div id="trackListPanels-'+this.id+'" class="trackListPanels" ></div>'),$(this.centerPanelDiv).append(this.trackListPanelsDiv),this.regionDiv=$('<div id="region-'+this.id+'" ></div>'),$(this.trackListPanelsDiv).append(this.regionDiv),this.tracksDiv=$('<div id="tracks-'+this.id+'" ></div>'),$(this.trackListPanelsDiv).append(this.tracksDiv),this.rendered=!0},draw:function(){if(!this.rendered)return console.info("Genome Viewer is not rendered yet"),void 0;var a=this;this.chromosomes=this.getChromosomes(),this._setWidth(this.width),this.setMinRegion(this.region,this.getSVGCanvasWidth()),this.zoom=this._calculateZoomByRegion(this.region),this.resizable&&$(window).resize(function(b){b.target==window&&(a.resizing||(a.resizing=!0,a._setWidth($(a.targetDiv).width()),setTimeout(function(){a.resizing=!1},400)))}),this.drawNavigationBar&&(this.navigationBar=this._createNavigationBar($(this.navigationbarDiv).attr("id")),this.navigationBar.setZoom(this.zoom)),this.drawKaryotypePanel&&(this.karyotypePanel=this._drawKaryotypePanel($(this.karyotypeDiv).attr("id"))),this.drawChromosomePanel&&(this.chromosomePanel=this._drawChromosomePanel($(this.chromosomeDiv).attr("id"))),this.drawRegionOverviewPanel&&(this.regionOverviewPanel=this._createRegionOverviewPanel($(this.regionDiv).attr("id"))),this.trackListPanel=this._createTrackListPanel($(this.tracksDiv).attr("id")),this.drawStatusBar&&(this.statusBar=this._createStatusBar($(this.statusbarDiv).attr("id"))),this.on("region:change region:move",function(b){b.sender!=a&&a._setRegion(b.region)}),this.on("species:change",function(b){a.species=b.species,a.chromosomes=a.getChromosomes()})},destroy:function(){$(this.div).remove(),this.off(),this.rendered=!1,$("html").unbind(".genomeViewer"),$("body").unbind(".genomeViewer"),delete this},getChromosomes:function(){var a,b=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d.name]=d}return b};return"undefined"!=typeof this.chromosomeList?a=b(this.chromosomeList):CellBaseManager.get({species:this.species,category:"genomic",subCategory:"chromosome",resource:"all",async:!1,success:function(c){a=b(c.response.result.chromosomes)},error:function(){console.log("Could not get chromosome list")}}),a},_createNavigationBar:function(a){var b=this;$.isFunction(this.quickSearchResultFn)||(this.quickSearchResultFn=function(a){var b=[],c=Utils.getSpeciesCode(this.species.text).substr(0,3);return CellBaseManager.get({host:"http://ws.bioinfo.cipf.es/cellbase/rest",species:c,version:"latest",category:"feature",subCategory:"id",query:a,resource:"starts_with",params:{of:"json"},async:!1,success:function(a){for(var c in a[0])b.push(a[0][c].displayId)}}),b});var c=function(a){null!=a&&("rs"==a.slice(0,"rs".length)||"AFFY_"==a.slice(0,"AFFY_".length)||"SNP_"==a.slice(0,"SNP_".length)||"VAR_"==a.slice(0,"VAR_".length)||"CRTAP_"==a.slice(0,"CRTAP_".length)||"FKBP10_"==a.slice(0,"FKBP10_".length)||"LEPRE1_"==a.slice(0,"LEPRE1_".length)||"PPIB_"==a.slice(0,"PPIB_".length)?this.openSNPListWidget(a):(console.log(a),CellBaseManager.get({species:b.species,category:"feature",subCategory:"gene",query:a,resource:"info",params:{include:"chromosome,start,end"},success:function(a){var c=a.response[0].result[0],d=c.chromosome+":"+c.start+"-"+c.end,e=new Region;e.parse(d),e=b._checkRegion(e),b.region=e,b.trigger("region:change",{region:b.region,sender:b})}})))},d=new NavigationBar({targetId:a,availableSpecies:this.availableSpecies,species:this.species,region:this.region,width:this.width,svgCanvasWidthOffset:this.trackPanelScrollWidth+this.sidePanelWidth,autoRender:!0,quickSearchResultFn:this.quickSearchResultFn,quickSearchDisplayKey:this.quickSearchDisplayKey,handlers:{"region:change":function(a){a.region=b._checkRegion(a.region),b.setMinRegion(a.region,b.getSVGCanvasWidth()),b.trigger("region:change",a)},"zoom:change":function(a){b.trigger("zoom:change",a)},"karyotype-button:change":function(a){a.selected?b.karyotypePanel.show():b.karyotypePanel.hide()},"chromosome-button:change":function(a){a.selected?b.chromosomePanel.show():b.chromosomePanel.hide()},"region-button:change":function(a){a.selected?b.regionOverviewPanel.show():b.regionOverviewPanel.hide()},"region:move":function(a){b.trigger("region:move",a)},"species:change":function(a){b.trigger("species:change",a),b.setRegion(a.species.region)},"fullscreen:click":function(){b.fullscreen?($(b.div).css({width:"auto"}),Utils.cancelFullscreen(),b.fullscreen=!1):($(b.div).css({width:screen.width}),Utils.launchFullScreen(b.div),b.fullscreen=!0)},"restoreDefaultRegion:click":function(a){a.region=b._checkRegion(a.region),b.setMinRegion(b.defaultRegion,b.getSVGCanvasWidth()),a.region=b.defaultRegion,b.trigger("region:change",a)},"autoHeight-button:click":function(){b.enableAutoHeight()},"quickSearch:select":function(a){c(a.item),b.trigger("quickSearch:select",a)},"quickSearch:go":function(a){c(a.item)}}});return this.on("region:change",function(a){b.navigationBar.setRegion(a.region),b.zoom=b._calculateZoomByRegion(a.region),b.navigationBar.setZoom(b.zoom)}),this.on("zoom:change",function(a){b.navigationBar.setZoom(a.zoom),b.region.load(b._calculateRegionByZoom(a.zoom)),a.sender!=d&&b.navigationBar.setRegion(a.region),b.setRegion(b.region)}),this.on("region:move",function(a){a.sender!=d&&b.navigationBar.moveRegion(a.region)}),this.on("width:change",function(a){b.navigationBar.setWidth(a.width)}),d.draw(),d},_drawKaryotypePanel:function(a){var b=this;return karyotypePanel=new KaryotypePanel({targetId:a,width:this.width-this.sidePanelWidth,height:125,species:this.species,title:"Karyotype",collapsed:this.karyotypePanelConfig.collapsed,collapsible:this.karyotypePanelConfig.collapsible,region:this.region,autoRender:!0,handlers:{"region:change":function(a){a.region=b._checkRegion(a.region),b.setMinRegion(a.region,b.getSVGCanvasWidth()),b.trigger("region:change",a)}}}),this.on("region:change region:move",function(a){a.sender!=karyotypePanel&&karyotypePanel.setRegion(a.region)}),this.on("width:change",function(a){karyotypePanel.setWidth(a.width-b.sidePanelWidth)}),this.on("species:change",function(a){karyotypePanel.setSpecies(a.species)}),karyotypePanel.draw(),karyotypePanel},_drawChromosomePanel:function(a){var b=this,c=new ChromosomePanel({targetId:a,autoRender:!0,width:this.width-this.sidePanelWidth,height:65,species:this.species,title:"Chromosome",collapsed:this.chromosomePanelConfig.collapsed,collapsible:this.chromosomePanelConfig.collapsible,region:this.region,handlers:{"region:change":function(a){a.region=b._checkRegion(a.region),b.trigger("region:change",a)}}});return this.on("region:change region:move",function(a){a.sender!=c&&c.setRegion(a.region)}),this.on("width:change",function(a){c.setWidth(a.width-b.sidePanelWidth)}),this.on("species:change",function(a){c.setSpecies(a.species)}),c.draw(),c},_createRegionOverviewPanel:function(a){var b=this,c=new TrackListPanel({targetId:a,autoRender:!0,width:this.width-this.sidePanelWidth,zoomMultiplier:8,title:"Region overview",showRegionOverviewBox:!0,collapsible:this.RegionPanelConfig.collapsible,region:this.region,handlers:{"region:change":function(a){a.sender={},a.region=b._checkRegion(a.region),b.setMinRegion(a.region,b.getSVGCanvasWidth()),b.trigger("region:change",a)},"region:move":function(a){b.trigger("region:move",a)},"tracks:ready":function(){b.checkTrackListReady()}}});return this.on("region:change",function(a){a.sender!=c&&c.setRegion(a.region)}),this.on("region:move",function(a){a.sender!=c&&c.moveRegion(a)}),this.on("width:change",function(a){c.setWidth(a.width-b.sidePanelWidth)}),this.on("species:change",function(a){c.setSpecies(a.species)}),c},_createTrackListPanel:function(a){var b=this,c=new TrackListPanel({targetId:a,autoRender:!0,width:this.width-this.sidePanelWidth,title:this.trackListTitle,region:this.region,handlers:{"region:change":function(a){a.sender={},a.region=b._checkRegion(a.region),b.setMinRegion(a.region,b.getSVGCanvasWidth()),b.trigger("region:change",a)},"region:move":function(a){b.trigger("region:move",a)},"tracks:ready":function(){b.checkTrackListReady()}}});return this.on("feature:highlight",function(a){c.highlight(a)}),this.on("region:change",function(a){a.sender!=c&&c.setRegion(a.region)}),this.on("region:move",function(a){a.sender!=c&&c.moveRegion(a)}),this.on("width:change",function(a){c.setWidth(a.width-b.sidePanelWidth)}),this.on("species:change",function(a){c.setSpecies(a.species)}),c},_createStatusBar:function(a){var b=new StatusBar({targetId:a,autoRender:!0,region:this.region,width:this.width,version:this.version});return this.trackListPanel.on("mousePosition:change",function(a){b.setMousePosition(a)}),this.on("region:change",function(a){b.setRegion(a)}),b},checkTrackListReady:function(){var a=this,b=function(b){return a.regionOverviewPanel&&a.regionOverviewPanel.status!=b?!1:a.trackListPanel.status!=b?!1:!0};b("ready")&&a.trigger("tracks:ready",{sender:a})},getRightSidePanelId:function(){return $(this.rightSidebarDiv).attr("id")
},getLeftSidePanelId:function(){return $(this.leftSidebarDiv).attr("id")},getNavigationPanelId:function(){return $(this.navigationbarDiv).attr("id")},getStatusPanelId:function(){return $(this.statusbarDiv).attr("id")},setNavigationBar:function(a){this.navigationBar=a;var b={availableSpecies:this.availableSpecies,species:this.species,region:this.region,width:this.width,svgCanvasWidthOffset:this.trackPanelScrollWidth+this.sidePanelWidth};_.extend(this.navigationBar,b),a.render(this.getNavigationPanelId())},_setWidth:function(a){this.width=a,this.trigger("width:change",{width:this.width,sender:this})},setWidth:function(a){$(this.div).width(a),this._setWidth(a)},getSVGCanvasWidth:function(){return this.width-this.trackPanelScrollWidth-this.sidePanelWidth},_setRegion:function(a){this.region.load(a)},setRegion:function(a){var a=this._checkRegion(a);this.region.load(a),this.setMinRegion(this.region,this.getSVGCanvasWidth()),this.trigger("region:change",{region:this.region,sender:this})},_checkRegion:function(a){var b=this.chromosomes[a.chromosome];return a.chromosome!==this.region.chromosome&&(a.start=Math.round(b.size/2),a.end=Math.round(b.size/2)),a},setMinRegion:function(a,b){var c=Math.floor(b/10);if(a.length()<c){var d=a.center(),e=Math.ceil(c/2-1);a.start=Math.floor(d-e),a.end=Math.floor(d+e)}},_calculateRegionByZoom:function(a){var b=10,c=this.chromosomes[this.region.chromosome],d=this.getSVGCanvasWidth()/b,e=Math.pow(c.size/d,.01),f=d*Math.pow(e,100-a),g=this.region.center(),h=Math.ceil(f/2-1),i=Math.floor(g-h),j=Math.floor(g+h);return{start:i,end:j}},_calculateZoomByRegion:function(a){var b=10,c=this.chromosomes[this.region.chromosome],d=this.getSVGCanvasWidth()/b,e=Math.pow(c.size/d,.01),f=a.length(),g=Math.log(f/d)/Math.log(e);return 100-g},move:function(a){this.region.start+=a,this.region.end+=a,this.trigger("region:move",{region:this.region,disp:-a,sender:this})},mark:function(a){var b=a.attrName||"feature_id",c=a.class||"feature-emph";if("attrValues"in a){a.attrValues=$.isArray(a.attrValues)?a.attrValues:[a.attrValues];for(var d in a.attrValues)$("rect["+b+"~="+a.attrValues[d]+"]").attr("class",c)}},unmark:function(a){var b=a.attrName||"feature_id";if("attrValues"in a){a.attrValues=$.isArray(a.attrValues)?a.attrValues:[a.attrValues];for(var c in a.attrValues)$("rect["+b+"~="+a.attrValues[c]+"]").attr("class","")}},highlight:function(a){this.trigger("feature:highlight",a)},enableAutoHeight:function(){this.trackListPanel.enableAutoHeight(),this.regionOverviewPanel.enableAutoHeight()},updateHeight:function(){this.trackListPanel.updateHeight(),this.regionOverviewPanel.updateHeight()},setSpeciesVisible:function(a){this.navigationBar.setSpeciesVisible(a)},setChromosomesVisible:function(a){this.navigationBar.setChromosomeMenuVisible(a)},setKaryotypePanelVisible:function(a){this.karyotypePanel.setVisible(a),this.navigationBar.setVisible({karyotype:a})},setChromosomePanelVisible:function(a){this.chromosomePanel.setVisible(a),this.navigationBar.setVisible({chromosome:a})},setRegionOverviewPanelVisible:function(a){this.regionOverviewPanel.setVisible(a),this.navigationBar.setVisible({region:a})},setRegionTextBoxVisible:function(a){this.navigationBar.setRegionTextBoxVisible(a)},setSearchVisible:function(a){this.navigationBar.setSearchVisible(a)},setFullScreenVisible:function(a){this.navigationBar.setFullScreenButtonVisible(a)},addOverviewTrack:function(a,b){this.regionOverviewPanel.addTrack(a,b)},addTrack:function(a,b){this.trackListPanel.addTrack(a,b)},getTrackSvgById:function(a){return this.trackListPanel.getTrackSvgById(a)},removeTrack:function(a){return this.trackListPanel.removeTrack(a)},restoreTrack:function(a,b){return this.trackListPanel.restoreTrack(a,b)},setTrackIndex:function(a,b){return this.trackListPanel.setTrackIndex(a,b)},scrollToTrack:function(a){return this.trackListPanel.scrollToTrack(a)},showTrack:function(a){this.trackListPanel._showTrack(a)},hideTrack:function(a){this.trackListPanel._hideTrack(a)},checkRenderedTrack:function(a){return this.trackListPanel.swapHash[a]?!0:!1}};